{"version":3,"sources":["config/constants.js","js/systems/System.js","js/PoppsEngine.js","js/Utility.js","js/app.js","js/components/Components.js","js/entities/Entity.js","js/entities/Mob.js","js/entities/Player.js","js/items/Item.js","js/levelgen/LevelGenerator.js","js/levelgen/Room.js","js/systems/AISystem.js","js/systems/ActionSystem.js","js/systems/AnimationSystem.js","js/systems/AudioSystem.js","js/systems/CombatSystem.js","js/systems/DisplaySystem.js","js/systems/EntitySystem.js","js/systems/HealthSystem.js","js/systems/InputSystem.js","js/systems/LevelSystem.js","js/systems/MovementSystem.js","js/systems/MusicSystem.js","js/systems/SprintSystem.js","js/systems/VisionSystem.js","js/world/Level.js","js/world/Square.js"],"names":[],"mappings":"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","file":"bundle.min.js","sourcesContent":["\"use strict\";\n\n//constants\nconst UP = 0, RIGHT = 1, DOWN = 2, LEFT = 3;\nconst OPEN = 0, CLOSED = 1;\nconst entity_player = 0, entity_mob = 1;\nconst physical_solid = true, physical_non_solid = false;\nconst display_opaque = true, display_transparent = false;\nconst entity_active_range = 20;\n\n//vision\nconst CENTER_SQUARE = 0, TOP_LEFT = 1, BOTTOM_RIGHT = 2, UPPER_BOUND = 3, LOWER_BOUND = 4;\nconst PERM = .5;\n\nconst xxcomp = [ 1, 0, 0, -1, -1, 0, 0, 1 ];\nconst xycomp = [ 0, 1, -1, 0, 0, -1, 1, 0 ];\nconst yxcomp = [ 0, 1, 1, 0, 0, -1, -1, 0 ];\nconst yycomp = [ 1, 0, 0, 1, -1, 0, 0, -1 ];\n\n\n\n// lights\nconst light_range = 8, light_intensity = .07, light_red = 230, light_green = 150, light_blue = 0;\nconst shadow_intensity = .08, shadow_red = 10, shadow_green = 5, shadow_blue = 25, shadow_max = .6;\nconst light_fill_string = \"rgba(\" + light_red + \",\" + light_green + \",\" + light_blue + \",\";\nconst light_level_to_shadow = [];\nlight_level_to_shadow[0] = \"rgba(\" + 10 + \", \" + 0 + \", \" + 35 + \", 0.40\";\nlight_level_to_shadow[1] = \"rgba(\" + 10 + \", \" + 2 + \", \" + 30 + \", 0.35\";\nlight_level_to_shadow[2] = \"rgba(\" + 10 + \", \" + 4 + \", \" + 25 + \", 0.30\";\nlight_level_to_shadow[3] = \"rgba(\" + 20 + \", \" + 6 + \", \" + 20 + \", 0.25\";\nlight_level_to_shadow[4] = \"rgba(\" + 30 + \", \" + 8 + \", \" + 15 + \", 0.20\";\nlight_level_to_shadow[5] = \"rgba(\" + 50 + \", \" + 10 + \", \" + 10 + \", 0.15\";\nlight_level_to_shadow[6] = \"rgba(\" + 100 + \", \" + 30 + \", \" + 5 + \", 0.10\";\nlight_level_to_shadow[7] = \"rgba(\" + 180 + \", \" + 50 + \", \" + 0 + \", 0.05\";\nlight_level_to_shadow[8] = \"rgba(\" + 255 + \", \" + 70 + \", \" + 0 + \", 0.05\";\n\n//square constants\nconst FLOOR = 0, WALL = 1, DOOR = 2, STAIR_DOWN = 3, STAIR_UP = 4, LOOT = 5; \n\n//image constants\nconst \ntexture_floor = 0,\n\ttexture_wall = 1,\n\ttexture_door_closed = 2,\n\ttexture_door_open = 3,\n\ttexture_loot_closed = 4,\n\ttexture_loot_open = 5,\n\ttexture_stair_up = 6,\n\ttexture_stair_down = 7;\n\nconst HEART = 0;\n\n//components\nconst \ncomponent_position = 0,\n\tcomponent_movement = 1,\n\tcomponent_display = 2,\n\tcomponent_animation = 3,\n\tcomponent_actions = 4,\n\tcomponent_physical = 5,\n\tcomponent_sprint = 6,\n\tcomponent_direction = 7,\n\tcomponent_map = 8,\n\tcomponent_health = 9,\n\tcomponent_light = 10,\n\tcomponent_strength = 11,\n\tcomponent_intelligence = 12,\n\tcomponent_magic = 13,\n\tcomponent_level = 14,\n\tcomponent_depth = 15,\n\tcomponent_stair = 16,\n\tcomponent_combat = 17,\n\tcomponent_ai = 18;\n\n//events\nconst \nevent_new_game = 0,\n\tevent_start_game = 1,\n\tevent_first_level_initiated = 2,\n\tevent_player_generated = 3,\n\tevent_down_level = 4,\n\tevent_up_level = 5,\n\tevent_new_level = 6,\n\tevent_window_resized = 7,\n\n\tevent_player_moved = 10,\n\tevent_entity_moved = 11,\n\tevent_player_start_sprinting = 12,\n\tevent_player_stop_sprinting = 13,\n\tevent_open_door = 14,\n\n\tevent_successful_action = 20,\n\tevent_failed_action = 21,\n\n\tevent_new_animation = 30,\n\n\tevent_begin_combat = 40,\n\tevent_end_combat = 41,\n\tevent_entity_take_damage = 42,\n\tevent_player_melee_attack = 43,\n\tevent_player_spin_attack = 44,\n\tevent_player_take_damage = 45,\n\n\tevent_entity_spawned = 50,\n\tevent_spawn_enemy_close = 51,\n\n\tevent_game_over = 1000\n;\n\n//direction\nconst direction_up = 0, direction_right = 1, direction_down = 2, direction_left = 3;\n\n//animations\nconst \nanimation_idle = 0,\n\tanimation_move_up = 1,\n\tanimation_move_right = 2,\n\tanimation_move_down = 3,\n\tanimation_move_left = 4,\n\tanimation_sprint_up = 5,\n\tanimation_sprint_right = 6,\n\tanimation_sprint_down = 7,\n\tanimation_sprint_left = 8,\n\tanimation_melee_attack_up = 9,\n\tanimation_melee_attack_right = 10,\n\tanimation_melee_attack_down = 11,\n\tanimation_melee_attack_left = 12,\n\tanimation_spin_attack = 13;\n\n//Actions\nconst \naction_none = -1,\n\taction_move = 0,\n\taction_move_up = 1,\n\taction_move_right = 2,\n\taction_move_down = 3,\n\taction_move_left = 4,\n\taction_sprint = 10,\n\taction_sprint_up = 11,\n\taction_sprint_right = 12,\n\taction_sprint_down = 13,\n\taction_sprint_left = 14,\n\taction_melee_attack = 20,\n\taction_melee_attack_up = 21,\n\taction_melee_attack_right = 22,\n\taction_melee_attack_down = 23,\n\taction_melee_attack_left = 24,\n\taction_spin_attack = 25;\n\nconst key_to_action = {\n\t\"w\": action_move_up,\n\t\"a\": action_move_left,\n\t\"s\": action_move_down,\n\t\"d\": action_move_right,\n\t\"e\": action_melee_attack,\n\t\"q\": action_spin_attack\n};\n\nconst animation_strings_to_constants = [];\nanimation_strings_to_constants[\"animation_idle\"] = animation_idle;\nanimation_strings_to_constants[\"animation_move_up\"] = animation_move_up;\nanimation_strings_to_constants[\"animation_move_right\"] = animation_move_right;\nanimation_strings_to_constants[\"animation_move_down\"] = animation_move_down;\nanimation_strings_to_constants[\"animation_move_left\"] = animation_move_left;\nanimation_strings_to_constants[\"animation_sprint_up\"] = animation_sprint_up;\nanimation_strings_to_constants[\"animation_sprint_right\"] = animation_sprint_right;\nanimation_strings_to_constants[\"animation_sprint_down\"] = animation_sprint_down;\nanimation_strings_to_constants[\"animation_sprint_left\"] = animation_sprint_left;\nanimation_strings_to_constants[\"animation_melee_attack_up\"] = animation_melee_attack_up;\nanimation_strings_to_constants[\"animation_melee_attack_right\"] = animation_melee_attack_right;\nanimation_strings_to_constants[\"animation_melee_attack_down\"] = animation_melee_attack_down;\nanimation_strings_to_constants[\"animation_melee_attack_left\"] = animation_melee_attack_left;\nanimation_strings_to_constants[\"animation_spin_attack\"] = animation_spin_attack;\n\nconst action_strings_to_constants = [];\naction_strings_to_constants[\"action_none\"] = action_none;\naction_strings_to_constants[\"action_move_up\"] = action_move_up;\naction_strings_to_constants[\"action_move_right\"] = action_move_right;\naction_strings_to_constants[\"action_move_down\"] = action_move_down;\naction_strings_to_constants[\"action_move_left\"] = action_move_left;\naction_strings_to_constants[\"action_sprint_up\"] = action_sprint_up;\naction_strings_to_constants[\"action_sprint_right\"] = action_sprint_right;\naction_strings_to_constants[\"action_sprint_down\"] = action_sprint_down;\naction_strings_to_constants[\"action_sprint_left\"] = action_sprint_left;\naction_strings_to_constants[\"action_melee_attack_up\"] = action_melee_attack_up;\naction_strings_to_constants[\"action_melee_attack_right\"] = action_melee_attack_right;\naction_strings_to_constants[\"action_melee_attack_down\"] = action_melee_attack_down;\naction_strings_to_constants[\"action_melee_attack_left\"] = action_melee_attack_left;\naction_strings_to_constants[\"action_spin_attack\"] = action_spin_attack;\n\nconst action_to_priority = [];\naction_to_priority[action_none] = 0;\n\naction_to_priority[action_move_up] = 3;\naction_to_priority[action_move_left] = 3;\naction_to_priority[action_move_down] = 3;\naction_to_priority[action_move_right] = 3;\n\naction_to_priority[action_melee_attack] = 4;\naction_to_priority[action_spin_attack] = 4;\n\nconst movement_to_sprint = [];\nmovement_to_sprint[action_move_up] = action_sprint_up;\nmovement_to_sprint[action_move_right] = action_sprint_right;\nmovement_to_sprint[action_move_down] = action_sprint_down;\nmovement_to_sprint[action_move_left] = action_sprint_left;\n\nconst sprint_to_movement = [];\nsprint_to_movement[action_sprint_up] = action_move_up;\nsprint_to_movement[action_sprint_right] = action_move_right;\nsprint_to_movement[action_sprint_down] = action_move_down;\nsprint_to_movement[action_sprint_left] = action_move_left;\n\nconst action_to_length = [];\naction_to_length[action_move_up] = 100;\naction_to_length[action_move_right] = 100;\naction_to_length[action_move_down] = 100;\naction_to_length[action_move_left] = 100;\n\naction_to_length[action_sprint] = 60;\n\naction_to_length[action_melee_attack_up] = 200;\naction_to_length[action_melee_attack_right] = 200;\naction_to_length[action_melee_attack_down] = 200;\naction_to_length[action_melee_attack_left] = 200;\n\naction_to_length[action_spin_attack] = 250;\n\nconst action_to_direction = [];\naction_to_direction[action_move_up] = direction_up;\naction_to_direction[action_move_right] = direction_right;\naction_to_direction[action_move_down] = direction_down;\naction_to_direction[action_move_left] = direction_left;\naction_to_direction[action_sprint_up] = direction_up;\naction_to_direction[action_sprint_right] = direction_right;\naction_to_direction[action_sprint_down] = direction_down;\naction_to_direction[action_sprint_left] = direction_left;\n\nconst direction_to_attack = [];\ndirection_to_attack[direction_up] = action_melee_attack_up;\ndirection_to_attack[direction_right] = action_melee_attack_right;\ndirection_to_attack[direction_down] = action_melee_attack_down;\ndirection_to_attack[direction_left] = action_melee_attack_left;\n\nconst direction_to_movement = [];\ndirection_to_movement[direction_up] = action_move_up;\ndirection_to_movement[direction_right] = action_move_right;\ndirection_to_movement[direction_down] = action_move_down;\ndirection_to_movement[direction_left] = action_move_left;\n\nconst direction_to_action = [];\ndirection_to_action[action_move + direction_up] = action_move_up;\ndirection_to_action[action_move + direction_right] = action_move_right;\ndirection_to_action[action_move + direction_down] = action_move_down;\ndirection_to_action[action_move + direction_left] = action_move_left;\n\nconst action_to_animation = [];\naction_to_animation[action_none] = animation_idle;\naction_to_animation[action_move_up] = animation_move_up;\naction_to_animation[action_move_right] = animation_move_right;\naction_to_animation[action_move_down] = animation_move_down;\naction_to_animation[action_move_left] = animation_move_left;\naction_to_animation[action_sprint_up] = animation_sprint_up;\naction_to_animation[action_sprint_right] = animation_sprint_right;\naction_to_animation[action_sprint_down] = animation_sprint_down;\naction_to_animation[action_sprint_left] = animation_sprint_left;\naction_to_animation[action_melee_attack_up] = animation_melee_attack_up;\naction_to_animation[action_melee_attack_right] = animation_melee_attack_right;\naction_to_animation[action_melee_attack_down] = animation_melee_attack_down;\naction_to_animation[action_melee_attack_left] = animation_melee_attack_left;\naction_to_animation[action_spin_attack] = animation_spin_attack;\n","class System {\n\n\tconstructor(componentRequirements) {\n\t\tthis.objects = [];\n\t\tthis.componentRequirements = componentRequirements;\n\t}\n\n\taddObject(object) {\n\t\tif(this.componentRequirements.length == 0) return;\n\t\telse if(Utility.checkComponents(object, this.componentRequirements)) {\n\t\t\tthis.objects.push(object);\n\t\t}\n\t}\n\n\tremoveObject(object) {\n\t\tif(this.objects.indexOf(object) !== -1) {\n\t\t\tthis.objects.splice(this.objects.indexOf(object), 1);\n\t\t}\n\t}\n\n\tclearObjects() {\n\t\tthis.objects = [];\n\t}\n\n\thandleEvent(engine, eventID, data) {}\n\n}\n","class PoppsEngine {\n\n\tconstructor(data) {\n\t\t// const TICKRATE = floor(1000/60);\n\t\tthis.init(data);\n\t}\n\n\tinit(data) {\n\t\tconst config = data.config;\n\t\tconst ROOM_POOL = data.room_pool;\n\t\tconst STAIR_ROOM_POOL = data.stair_room_pool;\n\t\tconst IMAGES = data.images;\n\t\tconst PLAYER_DATA = data.player_data;\n\t\tconst ENTITY_DATA = data.entity_data;\n\n\t\tthis.systems = [];\n\t\tlet tickInterval = undefined;\n\t\tthis.systems.push(new InputSystem());\n\t\tthis.systems.push(new DisplaySystem(config.display, IMAGES));\n\t\tthis.systems.push(new VisionSystem(config.vision));\n\t\tthis.systems.push(new ActionSystem());\n\t\tthis.systems.push(new MovementSystem());\n\t\tthis.systems.push(new LevelSystem(config.level, ROOM_POOL, STAIR_ROOM_POOL));\n\t\tthis.systems.push(new EntitySystem(PLAYER_DATA, ENTITY_DATA));\n\t\tthis.systems.push(new AnimationSystem(config.animation));\n\t\tthis.systems.push(new CombatSystem());\n\t\tthis.systems.push(new HealthSystem(config.health));\n\t\tthis.systems.push(new AISystem());\n\t\tthis.systems.push(new SprintSystem());\n\n\t\t// $(window).resize(this.sendEvent.bind(this, event_window_resized));\n\n\t\tthis.sendEvent(event_new_game);\n\t\tthis.sendEvent(event_start_game);\n\n\t\twindow.requestAnimationFrame(this.tick.bind(this));\n\t};\n\n\ttick() {\n\t\tfor(let s of this.systems) {\n\t\t\ts.run(this);\n\t\t}\n\t\twindow.requestAnimationFrame(this.tick.bind(this));\n\t}\n\n\tsendEvent(e, data) {\n\t\tif(e == event_game_over) {\n\t\t\tclearInterval(tickInterval);\n\t\t}\n\t\tfor(let s of this.systems) {\n\t\t\ts.handleEvent(this, e, data);\n\t\t}\n\t}\n\n\taddObject(object) {\n\t\tfor(let s of this.systems) {\n\t\t\ts.addObject(object);\n\t\t}\n\t}\n\n\tremoveObject(object) {\n\t\tfor(let s of this.systems) {\n\t\t\ts.removeObject(object);\n\t\t}\n\t}\n\n\tclearObjects() {\n\t\tfor(let s of this.systems) {\n\t\t\ts.clearObjects();\n\t\t}\n\t}\n}\n","class Utility {\n\n\tstatic collision(o1, o2) {\n\t\treturn !(o1.top >= o2.bottom || o1.right <= o2.left || o1.bottom <= o2.top || o1.left >= o2.right);\n\t}\n\n\tstatic checkComponents(object, requirements) {\n\t\tfor(var i = 0; i < requirements.length; i++){\n\t\t\tif(object.components.indexOf(requirements[i]) === -1)\n\t\t\t\treturn false;\n\t\t}\n\t\treturn true;\n\t}\n\n\tstatic entityActionSuccessful(entity) {\n\t\tentity.actions.busy = action_length[entity.actions.currentAction];\n\n\t\tentity.animation.newAnimation = true;\n\t\tentity.animation.animation = action_to_animation[entity.actions.currentAction];\n\n\t\tentity.actions.failedAction = action_none;\n\t\tentity.actions.lastAction = entity.actions.currentAction;\n\t\tentity.actions.currentAction = action_none;\n\t}\n\n\tstatic entityActionFailed(entity) {\n\t\tentity.actions.lastAction = action_none;\n\t\tentity.actions.failedAction = entity.actions.currentAction;\n\t\tentity.actions.currentAction = action_none;\n\t}\n\n\tstatic entityWithinRange(e1, e2, dist) {\n\t\treturn abs(e1.position.x - e2.position.x) < dist && abs(e1.position.y - e2.position.y) < dist;\n\t}\n\n\tstatic entityDistance(e1, e2) {\n\t\treturn abs((e1.position.x > e2.position.x) ? e1.collision.left - e2.collision.right : e1.collision.right - e2.collision.left) + abs((e1.position.y > e2.position.y) ? e1.collision.top - e2.collision.bottom : e1.collision.bottom - e2.collision.top);\n\t}\n\n\tstatic getDirectionToEntity(e1, e2) {\n\t\tif(e1.position.y > e2.position.y){ return direction_up; }\n\t\tif(e1.position.x < e2.position.x){ return direction_right;}\n\t\tif(e1.position.y < e2.position.y){ return direction_down; }\n\t\tif(e1.position.x > e2.position.x){ return direction_left; }\n\t}\n\n\tstatic entityAdjacent(entity, otherEntity) {\n\t\tif (Utility.collision(new CollisionComponent(entity.collision.top - 1, entity.collision.right, entity.collision.top, entity.collision.left), otherEntity.collision)) {\n\t\t\treturn direction_up;\n\t\t}\n\t\telse if (Utility.collision(new CollisionComponent(entity.collision.top, entity.collision.right + 1, entity.collision.bottom, entity.collision.right), otherEntity.collision)) {\n\t\t\treturn direction_right;\n\t\t}\n\t\telse if (Utility.collision(new CollisionComponent(entity.collision.bottom, entity.collision.right, entity.collision.bottom + 1, entity.collision.left), otherEntity.collision)) {\n\t\t\treturn direction_down;\n\t\t}\n\t\telse if (Utility.collision(new CollisionComponent(entity.collision.top, entity.collision.left, entity.collision.bottom, entity.collision.left - 1), otherEntity.collision)) {\n\t\t\treturn direction_left;\n\t\t}\n\t\telse {\n\t\t\treturn -1;\n\t\t}\n\t}\n\n\tstatic getSquareNeighbors(x, y, map) {\n\t\tneighbors = [];\n\t\tif(x > 0) {\n\t\t\tneighbors.push(map[x - 1][y]);\n\t\t}\n\t\tif(y > 0) {\n\t\t\tneighbors.push(map[x][y - 1]);\n\t\t}\n\t\tif(x < map.length - 1) {\n\t\t\tneighbors.push(map[x + 1][y]);\n\t\t}\n\t\tif(y < map.length - 1) {\n\t\t\tneighbors.push(map[x][y + 1]);\n\t\t}\n\t\treturn neighbors;\n\t}\n\n\tstatic getHealthPercent(entity){\n\t\treturn entity.health.health / entity.health.maxHealth;\n\t}\n\n\tstatic findMobPath(board, mob, player){\n\t\treturn findPath(board, board[mob.position.x][mob.position.y], board[player.position.x][player.position.y]);\n\t}\n\n\tstatic walkable(x, y, map, entity, objects){\n\t\treturn Utility.positionInBounds(x, y, map.length) && Utility.squareTypeIsWalkable(map[x][y], entity) && !Utility.squareIsOccupied(x, y, entity, objects);\n\t}\n\n\tstatic positionOnScreen(x, y, w, h){\n\t\treturn x > -w && x < width + w && y > -h && y < height + h;\n\t}\n\n\tstatic positionInBounds(x, y, size){\n\t\treturn x >= 0 && x < size && y >= 0 && y < size;\n\t}\n\n\tstatic squareInBounds(square, size){\n\t\treturn square.position.x >= 0 && square.position.x < size && square.position.y >= 0 && square.position.y < size;\n\t}\n\n\tstatic squareTypeIsWalkable(square, entity){\n\t\treturn (entity instanceof Player) ? Utility.playerWalkable(square) : Utility.mobWalkable(square);\n\t}\n\n\tstatic playerWalkable(square){\n\t\treturn (!square.physical.solid || square instanceof DoorSquare || square instanceof StairUpSquare || square instanceof StairDownSquare);\n\t}\n\n\tstatic mobWalkable(square){\n\t\treturn !(square.physical.solid);\n\t}\n\n\tstatic squareIsOccupied(x, y, entity, objects){\n\t\tfor(let o of objects){\n\t\t\tif(entity != o) {\n\t\t\t\tif(Utility.collision(new CollisionComponent(x, y, entity.physical.size), o.collision)) {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\n\tstatic directionToPosition(direction) {\n\t\tswitch(direction) {\n\t\t\tcase direction_up:\n\t\t\t\treturn new PositionComponent(0, -1);\n\t\t\t\tbreak;\n\t\t\tcase direction_right:\n\t\t\t\treturn new PositionComponent(1, 0);\n\t\t\t\tbreak;\n\t\t\tcase direction_down:\n\t\t\t\treturn new PositionComponent(0, 1);\n\t\t\t\tbreak;\n\t\t\tcase direction_left:\n\t\t\t\treturn new PositionComponent(-1, 0);\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tstatic getPositionInFrontOf(entity) {\n\t\tlet dtp = Utility.directionToPosition(entity.direction.direction);\n\t\treturn new PositionComponent(entity.position.x + dtp.x, entity.position.y + dtp.y);\n\t}\n\n\tstatic isMovementAction(action){\n\t\treturn action > action_move && action <= action_move_left;\n\t}\n\n\tstatic isSprintAction(action){\n\t\treturn action > action_sprint && action <= action_sprint_left;\n\t}\n\n\tstatic convertMovementToSprint(action){\n\t\tswitch(action){\n\t\t\tcase action_move_up:\n\t\t\t\treturn action_sprint_up;\n\t\t\t\tbreak;\n\t\t\tcase action_move_right:\n\t\t\t\treturn action_sprint_right;\n\t\t\t\tbreak;\n\t\t\tcase action_move_down:\n\t\t\t\treturn action_sprint_down;\n\t\t\t\tbreak;\n\t\t\tcase action_move_left:\n\t\t\t\treturn action_sprint_left;\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tstatic convertSprintToMovement(action){\n\t\tswitch(action){\n\t\t\tcase action_sprint_up:\n\t\t\t\treturn action_move_up;\n\t\t\t\tbreak;\n\t\t\tcase action_sprint_right:\n\t\t\t\treturn action_move_right;\n\t\t\t\tbreak;\n\t\t\tcase action_sprint_down:\n\t\t\t\treturn action_move_down;\n\t\t\t\tbreak;\n\t\t\tcase action_sprint_left:\n\t\t\t\treturn action_move_left;\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tstatic convertAnimationsFromConfig(animations){\n\t\tlet animationsArray = [];\n\t\tfor(let a in animations){\n\t\t\tanimationsArray[animation_strings_to_constants[a]] = animations[a];\t\n\t\t}\n\t\treturn animationsArray;\n\t}\n\n\tstatic convertActionsFromConfig(actions){\n\t\tlet actionsArray = [];\n\t\tfor(let i = 0; i < actions.length; i++){\n\t\t\tactionsArray[i] = action_strings_to_constants[actions[i]];\t\n\t\t}\n\t\treturn actionsArray;\n\t}\n\n\tstatic getSquareCode(x, y, size) {\n\t\treturn x + (y * size);\n\t}\n\n\tstatic getSquareFromCode(map, code) {\n\t\treturn map[code % map.length][floor(code / map.length)];\n\t}\n}\n\n\n\nconst LARGE_VALUE = 2147483647;\n\nfunction findPath(board, start, end) {\n\n\tlet searched = [];\n\tlet searching = [];\n\tlet cameFrom = {};\n\tlet distFromStart = {};\n\tlet finalCost = {};\n\n\tfor (let i = 0; i < board.length; i++) {\n\t\tfor (let j = 0; j < board[0].length; j++) {\n\t\t\tdistFromStart[board[i][j]] = LARGE_VALUE;\n\t\t\tfinalCost[board[i][j]] = LARGE_VALUE;\n\t\t}\n\t}\n\n\tsearching.push(start);\n\tdistFromStart[start] = 0;\n\tfinalCost[start] = squareDistance(start, end);\n\tcameFrom[Utility.getSquareCode(start.position.x, start.position.y)] = -1;\n\n\twhile (searching.length > 0) {\n\t\tlet current = searching[0];\n\t\tfor (let s of searching) {\n\t\t\tif (finalCost[s] < finalCost[current]) current = s;\n\t\t}\n\t\tif(current == end) {\n\t\t\treturn makePath(board, cameFrom, current);\n\t\t};\n\n\t\tsearching.splice(searching.indexOf(current), 1);\n\t\tsearched.push(current);\n\n\t\tlet currentNeighbors = getNeighbors(board, current);\n\t\tfor(let n of currentNeighbors) {\n\t\t\tif (searched.includes(n)) {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tlet estimatedDistFromStart = distFromStart[current] + 1;\n\n\t\t\t\tif (!searching.includes(n)) {\n\t\t\t\t\tsearching.push(n);\n\t\t\t\t}\n\t\t\t\telse if (estimatedDistFromStart >= distFromStart[n]) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tcameFrom[Utility.getSquareCode(n.position.x, n.position.y)] = Utility.getSquareCode(current.position.x, current.position.y);\n\t\t\t\tdistFromStart[n] = estimatedDistFromStart;\n\t\t\t\tfinalCost[n] = distFromStart[n] + squareDistance(start, end);\n\t\t\t}\n\t\t}\n\t}\n\treturn false;\n}\n\nfunction squareDistance(start, end) {\n\treturn abs(start.position.x - end.position.x) + abs(start.position.y - end.position.y);\n}\n\nfunction makePath(board, cameFrom, last) {\n\tlet path = [];\n\tlet current = Utility.getSquareCode(last.position.x, last.position.y);\n\twhile(cameFrom[current] > 0) {\n\t\tpath.unshift(Utility.getSquareFromCode(board, current));\n\t\tcurrent = cameFrom[current];\n\t}\n\tpath.unshift(Utility.getSquareFromCode(board, current));\n\treturn path;\n}\n\n\nconst PATHFINDING = -1;\n\nfunction getNeighbors(board, square) {\n\tneighbors = [];\n\tif (square.position.x > 0 && walkable(entity_mob, board[square.position.x - 1][square.position.y])) {\n\t\tneighbors.push(board[square.position.x - 1][square.position.y]);\n\t}\n\tif (square.position.y > 0 && walkable(entity_mob, board[square.position.x][square.position.y - 1])) {\n\t\tneighbors.push(board[square.position.x][square.position.y - 1]);\n\t}\n\tif (square.position.x < board.length - 1 && walkable(entity_mob, board[square.position.x + 1][square.position.y])) {\n\t\tneighbors.push(board[square.position.x + 1][square.position.y]);\n\t}\n\tif (square.position.y < board.length - 1 && walkable(entity_mob, board[square.position.x][square.position.y + 1])) {\n\t\tneighbors.push(board[square.position.x][square.position.y + 1]);\n\t}\n\t// if (square.position.x > 0 && board[square.position.x - 1][square.position.y].walkable(board, PATHFINDING)) neighbors.push(board[square.position.x - 1][square.position.y]);\n\t// if (square.position.y > 0 && board[square.position.x][square.position.y - 1].walkable(board, PATHFINDING)) neighbors.push(board[square.position.x][square.position.y - 1]);\n\t// if (square.position.x < board.length - 1 && board[square.position.x + 1][square.position.y].walkable(board, PATHFINDING)) neighbors.push(board[square.position.x + 1][square.position.y]);\n\t// if (square.position.y < board.length - 1 && board[square.position.x][square.position.y + 1].walkable(board, PATHFINDING)) neighbors.push(board[square.position.x][square.position.y + 1]);\n\treturn neighbors;\n}\n\nfunction walkable(e, i){\n\n\treturn true;\n\n}\n\nfunction direction(start, target){\n\tif(abs(start[0] - target[0]) >= abs(start[1] - target[1])){\n\t\tif(start[0] < target[0]) return RIGHT;\n\t\telse if(start[0] > target[0]) return LEFT;\n\t}\n\telse{\n\t\tif(start[1] < target[1]) return DOWN;\n\t\telse if(start[1] > target[1]) return UP;\n\t}\n}\n\nfunction dirToSquare(start, target){\n\tif(start.position.x > target.position.x){\n\t\treturn LEFT;\n\t}\n\telse if(start.position.y > target.position.y){\n\t\treturn UP;\n\t}\n\telse if (start.position.x < target.position.x){\n\t\treturn RIGHT;\n\t}\n\telse if(start.position.y < target.position.y){\n\t\treturn DOWN;\n\t}\n\telse{\n\t\tthrow new Error(\"Cannot determine direction from square\" + start + \" to \" + target);\n\t}\n}\n","function setup() {\n\tcreateCanvas(windowWidth, windowHeight);\n\tload();\n}\n\nfunction load() {\n\n\tlet config = loadConfig();\n\tlet room_pool = loadRoomPools();\n\tlet images = loadImages();\n\tlet player_data = loadPlayerData();\n\tlet entity_data = loadEntityData();\n\tlet music = loadMusic();\n\tlet sounds = loadSounds();\n\tlet data = {\n\t\t\"config\": config,\n\t\t\"room_pool\": room_pool[0],\n\t\t\"stair_room_pool\": room_pool[1],\n\t\t\"images\": images,\n\t\t\"player_data\": player_data,\n\t\t\"entity_data\": entity_data,\n\t\t\"music\": music,\n\t\t\"sounds\": sounds\n\t}\n\n\tlet e = new PoppsEngine(data);\n\n\t// document.addEventListener('contextmenu', function () { });\n}\n\nfunction loadConfig(){\n\treturn loadJSON('/config/config.json');\n}\n\nfunction loadRoomPools(){\n\treturn loadJSON('/config/roompool.json');\n}\n\nfunction loadImages(){\n\tlet images = [];\n\n\timages.TEXTURES = [];\n\timages.TEXTURES[texture_floor] = loadImage('/img/textures/floor0.jpg');\n\timages.TEXTURES[texture_wall] = loadImage('/img/textures/wall0.jpg');\n\timages.TEXTURES[texture_door_open] = loadImage('/img/textures/doorOpen.png');\n\timages.TEXTURES[texture_door_closed] = loadImage('/img/textures/doorClosed.jpg');\n\timages.TEXTURES[texture_loot_open] = loadImage('/img/textures/lootOpen.png');\n\timages.TEXTURES[texture_loot_closed] = loadImage('/img/textures/lootClosed.png');\n\timages.TEXTURES[texture_stair_up] = loadImage('/img/textures/stairUp.png');\n\timages.TEXTURES[texture_stair_down] = loadImage('/img/textures/stairDown.png');\n\n\timages.UI = [];\n\timages.UI[HEART] = loadImage('/img/icons/heart.png');\n\n\treturn images;\n}\n\nfunction loadPlayerData(){\n\treturn loadJSON('/data/player_data.json');\n}\n\nfunction loadEntityData(){\n\treturn loadJSON('/data/entity_data.json');\n}\n\nfunction loadMusic(){\n\tlet music = [];\n\tmusic.push(loadAudio('/audio/music/001_0100.wav'));\n\tmusic.push(loadAudio('/audio/music/002_0001.wav'));\n\tmusic.push(loadAudio('/audio/music/003_0101.wav'));\n\tmusic.push(loadAudio('/audio/music/004_1101.wav'));\n\tmusic.push(loadAudio('/audio/music/005_1121.wav'));\n\tmusic.push(loadAudio('/audio/music/006_2121.wav'));\n\tmusic.push(loadAudio('/audio/music/007_0200.wav'));\n\tmusic.push(loadAudio('/audio/music/008_0201.wav'));\n\tmusic.push(loadAudio('/audio/music/009_1201.wav'));\n\tmusic.push(loadAudio('/audio/music/010_1221.wav'));\n\treturn music;\n}\n\nfunction loadSounds(){\n}\n\nfunction keyDown() { } \nfunction keyUp() { }\n\n// $(document).ready(function () { init(); });\n","function PositionComponent(x, y){\n\tthis.x = x;\n\tthis.y = y;\n}\n\nfunction HealthComponent(initialHealth){\n\tthis.maxHealth = initialHealth;\n\tthis.health = initialHealth;\n}\n\nfunction StrengthComponent(initialStrength){\n\tthis.strength = initialStrength;\n}\n\nfunction IntelligenceComponent(initialIntelligence){\n\tthis.intelligence = initialIntelligence;\n}\n\nfunction MagicComponent(initialMagic){\n\tthis.magic = initialMagic;\n}\n\nfunction CombatComponent(strength, magic, intelligence){\n\n\tthis.meleeAttackPower = strength;\n\tthis.meleeDefensePower = floor((strength) / 5);\n\n\tthis.magicAttackPower = (magic * intelligence) / 2;\n\tthis.magicDefensePower = (strength * magic) / 8;\n}\n\nfunction DirectionComponent(direction){\n\tthis.direction = direction;\n}\n\nfunction PhysicalComponent(solid, size){\n\tthis.solid = solid;\n\tthis.size = size;\n}\n\nfunction CollisionComponent(top, right, bottom, left){\n\tif(left === undefined) {\n\t\tthis.top = right;\n\t\tthis.right = top + bottom;\n\t\tthis.bottom = right + bottom;\n\t\tthis.left = top;\n\t}\n\telse {\n\t\tthis.top = top;\n\t\tthis.right = right;\n\t\tthis.bottom = bottom;\n\t\tthis.left = left;\n\t}\n}\n\nfunction MovementComponent(speed){\n\tthis.speed = speed;\n}\n\nfunction DisplayComponent(texture, width, height, opaque){\n\tthis.texture = texture;\n\tthis.width = width;\n\tthis.height = height;\n\tthis.visible = false;\n\tthis.discovered = 0;\n\tthis.opaque = opaque;\n}\n\nfunction LightComponent(){\n\tthis.lightLevel = 0;\n}\n\nfunction AnimationComponent(animations){\n\tthis.offsetX = 0;\n\tthis.offsetY = 0;\n\tthis.stage = 0;\n\tthis.sprite = undefined;\n\tthis.animation = animation_idle;\n\tthis.animations = animations;\n}\n\nfunction ActionComponent(actions, speed){\n\tthis.busy = 0;\n\tthis.speed = speed;\n\tthis.availible = actions;\n\tthis.nextAction = action_none;\n\tthis.currentAction = action_none;\n\tthis.lastAction = action_none;\n\tthis.lastActionFailed = false;\n}\n\nfunction SprintComponent(movesBeforeSprinting){\n\tthis.movesBeforeSprinting = movesBeforeSprinting;\n\tthis.sprintCounter = 0;\n\tthis.sprinting = false;\n}\n\nfunction MapComponent(map){\n\tthis.map = map;\n}\n\nfunction DepthComponent(depth){\n\tthis.depth = depth;\n}\n\nfunction StairComponent(x, y){\n\tthis.x = x;\n\tthis.y = y;\n}\n\nfunction AIComponent(actions, minRange, maxRange){\n\tthis.actions = actions;\n\tthis.minRange = minRange;\n\tthis.maxRange = maxRange;\n}\n","function Entity(x, y, initialDepth, initialHealth, initialStrength, initialMagic, initialIntelligence, size, speed, actions, animations) {\n\tthis.components = [component_position, component_depth, component_health, component_strength, component_magic, component_intelligence, component_direction, component_physical, component_display, component_actions, component_animation, component_combat];\n\n\tthis.position = new PositionComponent(x, y);\n\tthis.depth = new DepthComponent(initialDepth);\n\tthis.direction = new DirectionComponent(direction_down);\n\n\tthis.physical = new PhysicalComponent(physical_solid, size);\n\n\tthis.health = new HealthComponent(initialHealth);\n\tthis.strength = new StrengthComponent(initialStrength);\n\tthis.magic = new MagicComponent(initialMagic);\n\tthis.intelligence = new IntelligenceComponent(initialIntelligence);\n\tthis.combat = new CombatComponent(initialStrength, initialMagic, initialIntelligence);\n\n\tthis.display = new DisplayComponent(undefined, size, size, display_transparent);\n\tthis.animation = new AnimationComponent(animations);\n\n\tthis.actions = new ActionComponent(actions, speed);\n}\n","Mob.prototype = Object.create(Entity.prototype);\nfunction Mob(x, y, depth, config, actions, animations) {\n\tEntity.call(this, x, y, depth, config.health, config.strength, config.magic, config.intelligence, config.size, config.speed, actions, animations);\n\n\tif(config.solid) {\n\t\tthis.collision = new CollisionComponent(x, y, config.size);\n\t}\n\tthis.components.push(component_ai);\n\tthis.ai = new AIComponent(actions, config.min_range, config.max_range);\n}\n","Player.prototype = Object.create(Entity.prototype);\nfunction Player(x, y, config, playerClass, actions, animations) {\n\tEntity.call(this, x, y, 0, playerClass.health, playerClass.strength, playerClass.magic, playerClass.intelligence, config.size, config.speed, actions, animations);\n\n\tthis.collision = new CollisionComponent(x, y, config.size);\n\tthis.components.push(component_sprint);\n\tthis.sprint = new SprintComponent(config.sprint_threshhold);\n\n\t// this.components.push(component_experience);\n\t// this.level = new ExperienceComponent(0);\n}\n","\nfunction Item(){\n\n}\n","function generateLevel(CONFIG, depth, ROOM_POOL, STAIR_ROOM_POOL){\n\n\tlet startTime = millis();\n\n\tlet level; \n\tlet rooms = [];\n\n\tlet stairUp = {x:0, y:0, sector:0};\n\tlet stairDown = {x:0, y:0, sector:0};\n\n\tlevel = initLevel(CONFIG.DUNGEON_SIZE);\n\trooms.push(generateStairUpRoom(stairUp, CONFIG.DUNGEON_SIZE, STAIR_ROOM_POOL));\n\trooms.push(generateStairDownRoom(stairUp, stairDown, CONFIG.DUNGEON_SIZE, STAIR_ROOM_POOL));\n\tgenerateOtherRooms(level, rooms, CONFIG.DUNGEON_SIZE, CONFIG.ROOM_TRIES, ROOM_POOL);\n\tplaceRoomsOnLevel(level, rooms);\n\tmarkNodeSquares(level);\n\tconnectRooms(level, rooms, CONFIG.DUNGEON_SIZE);\n\tfinalizeLevel(level, stairUp, stairDown);\n\n\t// console.log(\"Milliseconds: \" + (millis() - startTime));\n\n\treturn new Level(level, stairUp, stairDown, depth);\n}\n\nfunction initLevel(size){\n\tlet level = new Array(size);\t\n\tfor(let i = 0; i < size; i++){\n\t\tlevel[i] = new Array(size);\n\t\tfor(let j = 0; j < size; j++){\n\t\t\tlevel[i][j] = WALL;\n\t\t}\n\t}\n\treturn level;\n}\n\nfunction generateStairUpRoom(stairUp, size, STAIR_ROOM_POOL){\n\tstairUp.sector = randomInt(8);\n\tsectorToCoordinates(stairUp, size);\t\n\treturn new Room(random(STAIR_ROOM_POOL), stairUp.x, stairUp.y);\n}\n\nfunction generateStairDownRoom(stairUp, stairDown, size, STAIR_ROOM_POOL){\n\tstairDown.sector = (stairUp.sector + 4) % 8;\n\tsectorToCoordinates(stairDown, size);\t\n\treturn new Room(random(STAIR_ROOM_POOL), stairDown.x, stairDown.y);\n}\n\nfunction sectorToCoordinates(stair, size){\n\t// 0 1 2\n\t// 7 X 3  (sector + 4) % 8 = opposite sector\n\t// 6 5 4\n\tswitch(stair.sector){\n\t\tcase 0:\n\t\t\tstair.x = floor(size/4);\n\t\t\tstair.y = floor(size/4);\n\t\t\tbreak;\n\t\tcase 1:\n\t\t\tstair.x = 2 * floor(size/4);\n\t\t\tstair.y = floor(size/4);\n\t\t\tbreak;\n\t\tcase 2:\n\t\t\tstair.x = 3 * floor(size/4);\n\t\t\tstair.y = floor(size/4);\n\t\t\tbreak;\n\t\tcase 3:\n\t\t\tstair.x = 3 * floor(size/4);\n\t\t\tstair.y = 2 * floor(size/4);\n\t\t\tbreak;\n\t\tcase 4:\n\t\t\tstair.x = 3 * floor(size/4);\n\t\t\tstair.y = 3 * floor(size/4);\n\t\t\tbreak;\n\t\tcase 5:\n\t\t\tstair.x = 2 * floor(size/4);\n\t\t\tstair.y = 3 * floor(size/4);\n\t\t\tbreak;\n\t\tcase 6:\n\t\t\tstair.x = floor(size/4);\n\t\t\tstair.y = 3 * floor(size/4);\n\t\t\tbreak;\n\t\tcase 7:\n\t\t\tstair.x = floor(size/4);\n\t\t\tstair.y = 2 * floor(size/4);\n\t\t\tbreak;\n\t}\n}\n\nfunction generateOtherRooms(level, rooms, size, ROOM_TRIES, ROOM_POOL){\n\tfor(let i = 0; i < ROOM_TRIES; i++){\n\t\ttryRoom(level, rooms, size, ROOM_POOL);\n\t}\n}\n\nfunction tryRoom(level, rooms, size, ROOM_POOL){\n\tlet newRoom = new Room(random(ROOM_POOL), randomInt(size), randomInt(size));\n\tif(isValidRoom(rooms, newRoom, size)) rooms.push(newRoom);\n}\n\nfunction isValidRoom(rooms, newRoom, size){\n\tif(newRoom.left < 0 || newRoom.top < 0 || newRoom.right > size || newRoom.bottom > size) return false;\n\tfor(let r of rooms){\n\t\tif(roomsCollide(r, newRoom)) return false;\n\t}\n\treturn true;\n}\n\nfunction roomsCollide(r1, r2){\n\treturn !(r1.left > r2.right || r1.top > r2.bottom || r1.right < r2.left || r1.bottom < r2.top);\n}\n\nfunction placeRoomsOnLevel(level, rooms){\n\tfor(let r of rooms){\n\t\tfor(let i = 0; i < r.width; i++){\n\t\t\tfor(let j = 0; j < r.height; j++){\n\t\t\t\tlevel[i + r.left][j + r.top] = r.squares[i][j];\n\t\t\t}\n\t\t}\n\t}\n}\n\nfunction markNodeSquares(level){\n\tfor(let i = 1; i < level.length - 1; i+=2){\n\t\tfor(let j = 1; j < level.length - 1; j+=2){\n\t\t\tif(level[i][j] == WALL) level[i][j] = new Node(i, j, false);\n\t\t}\n\t}\n}\n\nfunction connectRooms(level, rooms, size){\n\n\tlet connected = [rooms[0]];\n\tlet connectedDoors = rooms[0].doors;\n\twhile(connected.length < rooms.length){\n\t\tlet closestRoom;\n\t\tlet closestDistance;\n\t\tfor(let r of rooms){\n\t\t\tif(!connected.includes(r)){\n\t\t\t\tclosestRoom = r;\n\t\t\t\tclosestDistance = 10000;\n\t\t\t}\n\t\t}\n\t\tfor(let c of connected){\n\t\t\tfor(let r of rooms){\n\t\t\t\tif(connected.includes(r)) continue;\n\t\t\t\telse{\n\t\t\t\t\tlet currentDistance = roomDistance(c, r);\n\t\t\t\t\tif(currentDistance < closestDistance){\n\t\t\t\t\t\tclosestRoom = r;\n\t\t\t\t\t\tclosestDistance = currentDistance;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tconnectRoom(level, connected, closestRoom, connectedDoors);\n\t}\n}\n\nfunction roomDistance(r1, r2){\n\treturn abs(r1.x - r2.x) + abs(r1.y - r2.y);\t\n}\n\nfunction connectRoom(level, connected, room, connectedDoors){\n\n\tlet roomDoors = room.doors;\n\tlet closestDoors = [connectedDoors[0], roomDoors[0]];\n\tlet closestDistance = 10000;\n\tlet adjacent = false;\n\tlet success = false;\n\n\tfor(let rd of roomDoors){\n\t\t//if door touches a connected room, use that door\n\t\tif(includesDoor(connectedDoors, rd)){\n\t\t\tclosestDoors[0] = rd;\n\t\t\tadjacent = true;\n\t\t\tsuccess = true;\n\t\t\tbreak;\n\t\t}\n\t\t//otherwise find the closest point of connection\n\t\telse{\n\t\t\tfor(let cd of connectedDoors){\n\t\t\t\tlet currentDistance = doorDistance(rd, cd);\n\t\t\t\tif(currentDistance < closestDistance){\n\t\t\t\t\tclosestDoors = [cd, rd];\n\t\t\t\t\tclosestDistance = currentDistance;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tif(!adjacent){\n\t\tsuccess = makePathBetweenDoors(level, closestDoors[0], closestDoors[1], connectedDoors);\n\t}\n\n\tif(success) {\n\t\tif(adjacent){\n\t\t\tlevel[closestDoors[0][0]][closestDoors[0][1]] = DOOR;\n\t\t}\n\t\telse{\n\t\t\tlevel[closestDoors[0][0]][closestDoors[0][1]] = DOOR;\n\t\t\tlevel[closestDoors[1][0]][closestDoors[1][1]] = DOOR;\n\t\t}\n\n\t\tfor(let rd of roomDoors){\n\t\t\tif(!includesDoor(connectedDoors, rd)) {\n\t\t\t\tconnectedDoors.push(rd);\n\t\t\t}\n\t\t}\n\t\tconnected.push(room);\t\n\t}\n\telse{\n\t\tconnectedDoors.splice(connectedDoors.indexOf(closestDoors[0]), 1);\n\t\troom.doors.splice(room.doors.indexOf(closestDoors[1]), 1);\n\t\tconnectRoom(level, connected, room, connectedDoors);\n\t}\n}\n\nfunction includesDoor(doorArray, door){\n\tfor(let d of doorArray){\n\t\tif(door[0] == d[0] && door[1] == d[1]) return true;\n\t}\n\treturn false;\n}\n\nfunction doorDistance(d1, d2){\n\treturn ((d1[0] - d2[0]) * (d1[0] - d2[0])) + ((d1[1] - d2[1]) * (d1[1] - d2[1]));\n}\n\nfunction makePathBetweenDoors(level, door1, door2, connectedDoors){\n\tlet searched = [];\n\tlet searching = [];\n\tlet distFromStart = {};\n\tlet finalCost = {};\n\n\tfor (let i = 0; i < level.length; i++) {\n\t\tfor (let j = 0; j < level[0].length; j++) {\n\t\t\tdistFromStart[level[i][j]] = LARGE_VALUE;\n\t\t\tfinalCost[level[i][j]] = LARGE_VALUE;\n\t\t}\n\t}\n\n\tlet start = getAdjacentNode(level, door1);\n\tlet end = getAdjacentNode(level, door2);\n\n\tif(start == undefined || end == undefined) return false;\n\n\tsearching.push(start);\n\tdistFromStart[start] = 0;\n\tfinalCost[start] = nodeDistance(start, end);\n\tstart.cameFrom = undefined;\n\n\twhile (searching.length > 0) {\n\t\tlet current = searching[0];\n\t\tfor (let s of searching) {\n\t\t\tif (finalCost[s] < finalCost[current]) current = s;\n\t\t}\n\n\t\tif (current == end) {\n\t\t\tdrawNodePath(level, current, connectedDoors);\n\t\t\treturn true;\n\t\t};\n\n\t\tsearching.splice(searching.indexOf(current), 1);\n\t\tsearched.push(current);\n\n\t\tlet currentNeighbors = getSurroundingNodes(level, current);\n\t\tfor (let n of currentNeighbors) {\n\t\t\tif (searched.includes(n)) {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tlet estimatedDistFromStart = distFromStart[current] + 1;\n\n\t\t\t\tif (!searching.includes(n)) {\n\t\t\t\t\tsearching.push(n);\n\t\t\t\t}\n\t\t\t\telse if (estimatedDistFromStart >= distFromStart[n]) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tn.cameFrom = current;\n\t\t\t\tdistFromStart[n] = estimatedDistFromStart;\n\t\t\t\tfinalCost[n] = distFromStart[n] + nodeDistance(start, end);\n\t\t\t}\n\t\t}\n\t}\n\treturn false;\n}\n\nfunction getAdjacentNode(level, door) {\n\tif (door[0] % 2 == 1 && door[1] % 2 == 1) return level[door[0]][door[1]];\n\tif (door[0] > 1 && level[door[0] - 1][door[1]] instanceof Node) return level[door[0] - 1][door[1]];\n\tif (door[1] > 1 && level[door[0]][door[1] - 1] instanceof Node) return level[door[0]][door[1] - 1];\n\tif (door[0] < level.length - 2 && level[door[0] + 1][door[1]] instanceof Node) return level[door[0] + 1][door[1]];\n\tif (door[1] < level.length - 2 && level[door[0]][door[1] + 1] instanceof Node) return level[door[0]][door[1] + 1];\n}\n\nfunction nodeDistance(start, end) {\n\treturn abs(start.x - end.x) + abs(start.y - end.y);\n}\n\nfunction getSurroundingNodes(level, node) {\n\tlet neighbors = [];\n\tif (node.x > 1 && level[node.x - 2][node.y] instanceof Node) neighbors.push(level[node.x - 2][node.y]);\n\tif (node.y > 1 && level[node.x][node.y - 2] instanceof Node) neighbors.push(level[node.x][node.y - 2]);\n\tif (node.x < level.length - 2 && level[node.x + 2][node.y] instanceof Node) neighbors.push(level[node.x + 2][node.y]);\n\tif (node.y < level.length - 2 && level[node.x][node.y + 2] instanceof Node) neighbors.push(level[node.x][node.y + 2]);\n\treturn neighbors;\n}\n\nfunction drawNodePath(level, node) {\n\t// level[node.x][node.y] = FLOOR;\n\tlevel[node.x][node.y].connected = true;\n\twhile(node.cameFrom != undefined){\n\t\tfillBetweenNodes(level, node, node.cameFrom);\n\t\tnode = node.cameFrom;\n\t\t// level[node.x][node.y] = FLOOR;\n\t\tlevel[node.x][node.y].connected = true;\n\t}\n}\n\nfunction fillBetweenNodes(level, node1, node2){\n\tlevel[node1.x + ((node2.x - node1.x) / 2)][node1.y + ((node2.y - node1.y) / 2)] = FLOOR;\n}\n\nfunction finalizeLevel(level, stairUp, stairDown){\n\tlevel[stairUp.x][stairUp.y] = STAIR_UP;\n\tlevel[stairDown.x][stairDown.y] = STAIR_DOWN;\n\n\tfor(let i = 0; i < level.length; i++){\n\t\tfor(let j = 0; j < level.length; j++){\n\t\t\tif(level[i][j] instanceof Node){\n\t\t\t\tif(level[i][j].connected){\n\t\t\t\t\tlevel[i][j] = FLOOR;\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\tlevel[i][j] = WALL;\n\t\t\t\t}\n\t\t\t}\n\t\t\tswitch(level[i][j]){\n\t\t\t\tcase FLOOR:\n\t\t\t\t\tlevel[i][j] = new FloorSquare(i, j);\n\t\t\t\t\tbreak;\n\t\t\t\tcase WALL:\n\t\t\t\t\tlevel[i][j] = new WallSquare(i, j);\n\t\t\t\t\tbreak;\n\t\t\t\tcase DOOR:\n\t\t\t\t\tlevel[i][j] = new DoorSquare(i, j);\n\t\t\t\t\tbreak;\n\t\t\t\tcase STAIR_UP:\n\t\t\t\t\tlevel[i][j] = new StairUpSquare(i, j);\n\t\t\t\t\tbreak;\n\t\t\t\tcase STAIR_DOWN:\n\t\t\t\t\tlevel[i][j] = new StairDownSquare(i, j);\n\t\t\t\t\tbreak;\n\t\t\t\tcase LOOT:\n\t\t\t\t\tlevel[i][j] = new LootSquare(i, j);\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tconsole.log(\"Not recognized squaretype: \" + level[i][j]);\n\t\t\t\t\tlevel[i][j] = new Square(i, j, level[i][j]);\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n}\n\n\nfunction Node(x, y, connected){\n\tthis.x = x;\n\tthis.y = y;\n\tthis.connected = connected;\n}\n","function Room(template, x, y) {\n\n\t/*\n\t *\n\t *   000T000   T = (3, 0)   W = 7\n\t *   0000000   L = (0, 2)   H = 5\n\t *   L00C000R  C = (3, 2)\n\t *   0000000   R = (7, 2)\n\t *   0000000   B = (3, 5)\n\t *      B\n\t *\n\t */\n\n\tthis.width = template.width; \n\tthis.height = template.height; \n\n\tthis.left = x - floor(this.width/2); //x coordinate of left most squares\n\tthis.top = y - floor(this.height/2); //top most\n\tthis.left += (this.left % 2) - 1;\n\tthis.top += (this.top % 2) - 1;\n\tthis.right = this.left + this.width; //x coord of first wall on right \n\tthis.bottom = this.top + this.height; //x coord of first wall on right \n\n\tthis.x = this.left + ceil(this.width/2);\n\tthis.y = this.top + ceil(this.height/2);\n\n\tthis.squares = template.squares.slice(0);\n\tthis.doors = new Array(template.doors.length);\n\n\tfor(let i = 0; i < this.doors.length; i++){\n\t\tthis.doors[i] = [template.doors[i][0] + this.left, template.doors[i][1] + this.top];\n\t}\n}\n","class AISystem extends System {\n\n\tconstructor() {\n\t\tsuper([component_ai]);\n\n\t\tthis.player;\n\t}\n\n\trun(engine) {\n\t\tfor(let entity of this.objects) {\n\t\t\tif(Utility.entityDistance(entity, this.player) < entity_active_range) {\n\t\t\t\tentity.actions.nextAction = this.determineAction(entity, this.player);\n\t\t\t}\n\t\t}\n\t}\n\n\thandleEvent(engine, eventID, data) { }\n\n\taddObject(object) {\n\t\tif(object instanceof Player) { this.player = object; }\n\t\telse{ super.addObject(object); }\n\t}\n\n\tdetermineAction(entity, player) {\n\t\tif(Utility.entityDistance(entity, player) < entity.ai.maxRange) {\n\t\t\treturn this.getAttackAction(entity, player);\n\t\t}\n\t\telse{\n\t\t\treturn this.getMoveCloserAction(entity, player);\n\t\t}\n\t}\n\n\tgetAttackAction(entity, player) {\n\t\tlet dir = Utility.getDirectionToEntity(entity, player);\n\t\tentity.direction.direction = dir;\n\t\treturn direction_to_attack[dir];\t\n\t}\n\n\tgetMoveCloserAction(entity, player) {\n\t\treturn direction_to_movement[Utility.getDirectionToEntity(entity, player)];\t\n\t}\n}\n","class ActionSystem extends System {\n\t\n\tconstructor() {\n\t\tsuper([component_actions]);\n\t}\n\n\trun(engine) {\n\t\tfor(let entity of this.objects) {\n\t\t\tif(entity.actions.busy > 0) {\n\t\t\t\tentity.actions.busy -= entity.actions.speed;\n\t\t\t}\n\t\t\telse{\n\t\t\t\tthis.setCurrentAction(entity, engine);\n\t\t\t}\n\t\t}\n\t}\n\n\thandleEvent(engine, eventID, data) {\n\t\tswitch(eventID) {\n\t\t\tcase event_successful_action:\n\t\t\t\tthis.handleSuccessfulAction(data.entity, engine);\n\t\t\t\tbreak;\n\t\t\tcase event_failed_action:\n\t\t\t\tthis.handleFailedAction(data.entity, engine);\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tsetCurrentAction(entity, engine) {\n\t\tentity.actions.currentAction = entity.actions.nextAction;\n\t\tentity.actions.nextAction = action_none;\n\t}\n\n\thandleSuccessfulAction(entity, engine) {\n\t\tentity.actions.busy = action_to_length[entity.actions.currentAction];\n\n\t\tif(entity.components.includes(component_sprint)) {\n\t\t\tthis.handleSprinting(entity, engine);\n\t\t}\n\n\t\tentity.animation.animation = action_to_animation[entity.actions.currentAction];\n\t\tengine.sendEvent(event_new_animation, entity);\n\n\t\tentity.actions.lastAction = entity.actions.currentAction;\n\t\tentity.actions.currentAction = action_none;\n\t}\n\n\thandleFailedAction(entity, engine) {\n\t\tentity.actions.busy = 1;\n\n\t\t// entity.animation.animation = action_to_animation[entity.actions.currentAction];\n\t\t// engine.sendEvent(event_new_animation, entity);\n\n\t\tentity.actions.lastActionFailed = true;\n\t\tentity.actions.lastAction = entity.actions.currentAction;\n\t\tentity.actions.currentAction = action_none;\n\t}\n\n\thandleSprinting(entity, engine) {\n\t\tif(entity.sprint.sprinting) {\n\t\t\tentity.actions.busy = action_to_length[action_sprint];\n\t\t}\n\t}\n}\n","class AnimationSystem extends System {\n\n\tconstructor(config) {\n\t\tsuper([component_animation]);\n\n\t\tthis.config = config;\n\n\t\tthis.animationCounter = 0;\n\t\tthis.idleAnimationCounter = 0;\n\t}\n\n\trun(engine) {\n\t\t// for(let o of this.objects) {\n\t\t// \tif(o.animation.newAnimation) {\n\t\t// \t\tstartAnimation(o);\t\n\t\t// \t}\n\t\t// }\n\t\tif(this.animationCounter == this.config.ANIMATION_SPEED) {\n\t\t\tthis.animationCounter = 0;\n\t\t\tif(this.idleAnimationCounter == this.config.IDLE_ANIMATION_SLOW_FACTOR) {\n\t\t\t\tthis.idleAnimationCounter = 0;\n\t\t\t}\n\t\t\tfor(let o of this.objects) {\n\t\t\t\to.animation.stage++;\n\t\t\t\t// console.log(o);\n\t\t\t\tif(o.animation.stage == o.animation.animations[o.animation.animation].length) {\n\t\t\t\t\tthis.startIdleAnimation(o);\n\t\t\t\t}\n\t\t\t\tthis.updateAnimation(o);\n\t\t\t\t// if((o.animation.nextAnimation == animation_idle && this.idleAnimationCounter == 0) || o.animation.nextAnimation != animation_idle) {\n\t\t\t\t// \tif(o.animation.stage == o.animation.animations[o.animation.animation].length) {\n\t\t\t\t// \t\tthis.startAnimation(o, action_none); \n\t\t\t\t// \t}\n\t\t\t\t// }\n\t\t\t}\n\t\t\tthis.idleAnimationCounter++;\n\t\t}\n\t\tthis.animationCounter++;\n\t}\n\n\thandleEvent(engine, eventID, data) {\n\t\tswitch(eventID) {\n\t\t\tcase event_new_animation:\n\t\t\t\tthis.startAnimation(data);\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tstartIdleAnimation(entity) {\n\t\tentity.animation.animation = animation_idle;\n\t\tentity.animation.stage = 0;\n\t\tthis.updateAnimation(entity);\n\t}\n\n\tupdateAnimation(entity) {\n\t\tentity.animation.offsetX = entity.animation.animations[entity.animation.animation][entity.animation.stage].ox;\n\t\t// if(entity.animation.offsetX == undefined) {entity.animation.offsetX = 0;}\n\t\tentity.animation.offsetY = entity.animation.animations[entity.animation.animation][entity.animation.stage].oy;\n\t\t// if(entity.animation.offsetY == undefined) {entity.animation.offsetY = 0;}\n\t\tentity.animation.sprite = entity.animation.animations[entity.animation.animation][entity.animation.stage].sprite;\n\t}\n\n\tstartAnimation(object) {\n\t\tobject.animation.stage = 0;\n\t\tthis.updateAnimation(object);\n\t}\n}\n","function AudioManager() {\n    const mm = new MusicManager();\n    let sounds = [];\n}\n","class CombatSystem extends System {\n\n\tconstructor() {\n\t\tsuper([component_combat]);\n\n\t\tthis.player;\n\t\tthis.inCombat = false;\n\t\tthis.combatTimer = 0;\n\t\tthis.combatTimerMax = 30;\n\t}\n\n\trun(engine) {\n\t\tfor(let entity of this.objects) {\n\t\t\tswitch(entity.actions.currentAction) {\n\t\t\t\tcase action_melee_attack:\n\t\t\t\t\tthis.determineAttackDirection(entity, this.objects);\n\t\t\t\t\tthis.meleeAttack(engine, entity, this.objects);\n\t\t\t\t\tbreak;\n\t\t\t\tcase action_melee_attack_up: case action_melee_attack_right: case action_melee_attack_down: case action_melee_attack_left: \n\t\t\t\t\tthis.meleeAttack(engine, entity, this.objects);\n\t\t\t\t\tbreak;\n\t\t\t\tcase action_spin_attack:\n\t\t\t\t\tthis.spinAttack(engine, entity, this.objects);\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tif(this.inCombat) {\n\t\t\tif(!this.checkInCombat(this.player, this.objects)) {\n\t\t\t\tthis.combatTimer--;\n\t\t\t\tif(this.combatTimer == 0) {\n\t\t\t\t\tthis.endCombat(engine);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthis.resetCombatTimer();\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\tif(this.checkInCombat(this.player, this.objects)) {\n\t\t\t\tthis.beginCombat(engine);\n\t\t\t}\n\t\t}\n\t}\n\n\thandleEvent(engine, eventID, data) {\n\t\tswitch(eventID) { }\n\t}\n\n\taddObject(object) {\n\t\tif(object instanceof Player) { this.player = object; }\n\t\tsuper.addObject(object);\n\t}\n\n\tresetCombatTimer() {\n\t\tthis.combatTimer = this.combatTimerMax;\n\t}\n\n\tbeginCombat(engine) {\n\t\tif(!this.inCombat) {\n\t\t\tengine.sendEvent(event_begin_combat);\n\t\t\tthis.resetCombatTimer();\n\t\t\tthis.inCombat = true;\n\t\t}\n\t}\n\n\tendCombat(engine) {\n\t\tif(this.inCombat) {\n\t\t\tengine.sendEvent(event_end_combat);\n\t\t\tthis.inCombat = false;\n\t\t}\n\t}\n\n\tcheckInCombat(player, objects) {\n\t\tfor(let o of objects) {\n\t\t\tif(o instanceof Mob && o.display.visible) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\n\tdetermineAttackDirection(entity, objects) {\n\t\tfor(let o of objects) {\n\t\t\tlet dir = Utility.entityAdjacent(entity, o);\n\t\t\tif(dir != -1) {\n\t\t\t\tentity.direction.direction = dir;\n\t\t\t\tentity.actions.currentAction = direction_to_attack[dir];\n\t\t\t}\n\t\t}\n\t}\n\n\tmeleeAttack(engine, entity, objects) {\n\t\tfor(let o of objects) {\n\t\t\tif(entity != o) {\n\t\t\t\tlet target = Utility.getPositionInFrontOf(entity);\n\t\t\t\tif(Utility.collision(new CollisionComponent(target.x, target.y, entity.physical.size), o.collision)) {\n\t\t\t\t\tlet healthLost = max(0, (entity.combat.meleeAttackPower * 1.5) - o.combat.meleeDefensePower);\n\t\t\t\t\tif(entity instanceof Player) {\n\t\t\t\t\t\tengine.sendEvent(event_player_melee_attack);\n\t\t\t\t\t}\n\t\t\t\t\tengine.sendEvent(event_entity_take_damage, { \"object\": o, \"healthLost\": healthLost });\n\t\t\t\t\tengine.sendEvent(event_successful_action, { \"action\": entity.actions.currentAction, \"entity\": entity });\n\t\t\t\t\tthis.beginCombat(engine);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tspinAttack(engine, entity, objects) {\n\t\tlet targets = [];\n\t\tfor(let o of objects) {\n\t\t\tif(entity != o && this.entityAround(entity, o)) {\n\t\t\t\ttargets.push(o);\n\t\t\t}\n\t\t}\n\t\tif(targets.length > 0) {\n\t\t\tfor(let o of targets) {\n\t\t\t\tlet healthLost = max(0, entity.combat.meleeAttackPower - o.combat.meleeDefensePower);\n\t\t\t\tengine.sendEvent(event_entity_take_damage, { \"object\": o, \"healthLost\": healthLost });\n\t\t\t}\n\t\t\tif(entity instanceof Player) {\n\t\t\t\tengine.sendEvent(event_player_spin_attack);\n\t\t\t}\n\t\t\tengine.sendEvent(event_successful_action, { \"action\": entity.actions.currentAction, \"entity\": entity });\n\t\t\tthis.beginCombat(engine);\n\t\t}\n\t}\n\n\tentityAround(entity, otherEntity) {\n\t\treturn Utility.collision(new CollisionComponent(entity.position.x - 1, entity.position.y - 1, 3), otherEntity.collision);\n\t}\n}\n","class DisplaySystem extends System {\n\n\tconstructor(config, images) {\n\t\tsuper([component_position, component_display]);\n\n\t\tthis.config = config;\n\t\tthis.textures = images.TEXTURES;\n\t\tthis.ui = images.UI;\n\n\t\tthis.camera = {\n\t\t\tx: 0,\n\t\t\ty: 0,\n\t\t\tshakeOffsetX : 0,\n\t\t\tshakeOffsetY : 0,\n\t\t\tcombat: false,\n\t\t\tsprinting: false,\n\t\t\tzoom: this.config.CAMERA_DEFAULT_ZOOM\n\t\t}\n\n\t\tthis.player;\n\n\t\tthis.cameraZoomTimer = undefined;\n\t\tthis.cameraShakeTimer = undefined;\n\t\tthis.cameraMoving = false;\n\n\t\tthis.lightOffset = 0;\n\t\tthis.lightOffsetScale = .02;\n\t\tthis.lightOffsetSpeed = 600;\n\n\t\tthis.centerX = floor(width / 2);\n\t\tthis.centerY = floor(height / 2);\n\n\t\tthis.gridSize = this.config.GRID_SIZE;\n\t\tthis.halfGridSize = this.gridSize / 2;\n\t}\n\n\trun(engine) {\n\t\tbackground(0);\n\t\tthis.drawTextures(this.objects); \n\t\tthis.drawLights(this.objects);\n\t\tthis.drawHealth(this.objects);\n\t\tif(this.cameraMoving) {\n\t\t\tif(this.player.animation.animation == animation_idle) { this.cameraMoving = false; }\n\t\t\tthis.centerCamera(this.camera, this.player.position, this.player.animation.offsetX, this.player.animation.offsetY); \n\t\t}\n\n\t\t// canvas.translate(width/2, height/2);\n\t\t// canvas.rotate(45 * Math.PI / 180);\n\t\t// fill(255, 0, 0);\n\t\t// rect(0, 0, 200, 200);\n\t\t// canvas.setTransform();\n\t}\n\n\thandleEvent(engine, eventID, data) {\n\t\tswitch(eventID) {\n\t\t\tcase event_start_game:\n\t\t\t\tthis.centerCamera(this.camera, this.player.position);\n\t\t\t\tbreak;\n\t\t\tcase event_up_level: case event_down_level: case event_player_moved:\n\t\t\t\tthis.cameraMoving = true;\n\t\t\t\tbreak;\n\t\t\tcase event_window_resized:\n\t\t\t\tthis.resize();\n\t\t\t\tbreak;\n\t\t\tcase event_begin_combat:\n\t\t\t\tthis.camera.combat = true;\n\t\t\t\tthis.decideCameraZoomState(this.camera);\n\t\t\t\tbreak;\n\t\t\tcase event_end_combat:\n\t\t\t\tthis.camera.combat = false;\n\t\t\t\tthis.decideCameraZoomState(this.camera);\n\t\t\t\tbreak;\n\t\t\tcase event_player_start_sprinting:\n\t\t\t\tthis.camera.sprinting = true;\n\t\t\t\tthis.decideCameraZoomState(this.camera);\n\t\t\t\tbreak;\n\t\t\tcase event_player_stop_sprinting:\n\t\t\t\tthis.camera.sprinting = false;\n\t\t\t\tthis.decideCameraZoomState(this.camera);\n\t\t\t\tbreak;\n\t\t\tcase event_player_melee_attack:\n\t\t\t\tthis.shakeCamera(this.camera, this.config.CAMERA_SHAKE_MEDIUM_SMALL);\n\t\t\t\tbreak;\n\t\t\tcase event_player_spin_attack:\n\t\t\t\tthis.shakeCamera(this.camera, this.config.CAMERA_SHAKE_SMALL);\n\t\t\t\tbreak;\n\t\t\tcase event_player_take_damage:\n\t\t\t\tthis.shakeCamera(this.camera, this.config.CAMERA_SHAKE_SMALL);\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\taddObject(object) {\n\t\tif(object instanceof Player) {\n\t\t\tthis.player = object;\n\t\t}\n\t\tsuper.addObject(object);\n\t}\n\n\tdrawTextures(objects) {\n\t\tfor(let o of objects) {\n\t\t\tif(o.display.visible || o.display.discovered > 0) {\n\t\t\t\tlet x = this.centerX - (this.camera.zoom * (this.gridSize * (this.camera.x - o.position.x))) + this.camera.shakeOffsetX;\n\t\t\t\tlet y = this.centerY - (this.camera.zoom * (this.gridSize * (this.camera.y - o.position.y))) + this.camera.shakeOffsetY;\n\t\t\t\tlet w = o.display.width * this.gridSize * this.camera.zoom;\n\t\t\t\tlet h = o.display.height * this.gridSize * this.camera.zoom;\n\t\t\t\tif(Utility.positionOnScreen(x, y, w, h)) {\n\t\t\t\t\tthis.drawTexture(o, x, y, w, h); \n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tdrawTexture(o, x, y, w, h) {\n\t\tif(o.components.includes(component_animation)) {\n\t\t\tx += this.gridSize * o.animation.offsetX;\n\t\t\ty += this.gridSize * o.animation.offsetY;\n\t\t\tlet s = o.animation.sprite;\n\t\t\tif(s == undefined) {\n\t\t\t\tif(o instanceof Player) {\n\t\t\t\t\tfill(255);\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\tfill(255, 150, 100);\n\t\t\t\t}\n\t\t\t\trect(x + (this.gridSize / 8), y + (this.gridSize / 8), w - (this.gridSize / 4), h - (this.gridSize / 4));\n\t\t\t}\n\t\t\telse{\n\t\t\t\timage(a, x, y, w, h);\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\tlet t = o.display.texture;\n\t\t\tif(t == undefined) {\n\t\t\t\tfill(255, 100, 100);\n\t\t\t\trect(x, y, w, h);\n\t\t\t}\n\t\t\telse if(t.length > 1) {\n\t\t\t\tfor(let i of t) {\n\t\t\t\t\timage(this.textures[i], x, y, w, h);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse {\n\t\t\t\timage(this.textures[t], x, y, w, h);\n\t\t\t}\n\t\t\tif(!o.display.visible && o.display.discovered > 0) {\n\t\t\t\tfill(5, 10, 0, .2);\n\t\t\t\trect(x, y, w, h);\n\t\t\t}\n\t\t}\n\t}\n\n\tdrawLights(objects) {\n\t\t// let st = millis();\n\t\tlet lightFill = light_fill_string + light_intensity + \")\";\n\t\tfor(let o of objects) {\n\t\t\tif(o.display.discovered && o.components.includes(component_light)) {\n\t\t\t\tcanvas.fillStyle = lightFill;\n\t\t\t\tthis.lightSquare(o);\n\t\t\t}\n\t\t}\n\t\t// console.log(millis() - st);\n\t}\n\n\tlightSquare(o) {\n\t\tlet x = this.centerX - (this.camera.zoom * (this.gridSize * (this.camera.x - o.position.x))) + this.camera.shakeOffsetX;\n\t\tlet y = this.centerY - (this.camera.zoom * (this.gridSize * (this.camera.y - o.position.y))) + this.camera.shakeOffsetY;\n\t\tlet w = o.display.width * this.gridSize * this.camera.zoom;\n\t\tlet h = o.display.height * this.gridSize * this.camera.zoom;\n\n\t\trect(x, y, w, h);\n\t\tcanvas.fillStyle = light_level_to_shadow[o.light.lightLevel];\n\t\t// fill(shadow_red, shadow_green, shadow_blue, constrainHigh(shadow_intensity * (light_max - o.light.lightLevel), shadow_max));\n\t\t// console.log(shadow_intensity * (light_max - o.light.lightLevel));\n\t\trect(x, y, w, h);\n\t}\n\n\tdrawHealth(objects) {\n\t\tfor(let o of objects) {\n\t\t\tif(o.components.includes(component_health) && (o.display.visible || o.display.discovered > 0)) {\n\t\t\t\tlet x = this.centerX - (this.camera.zoom * (this.gridSize * (this.camera.x - o.position.x))) + this.camera.shakeOffsetX;\n\t\t\t\tlet y = this.centerY - (this.camera.zoom * (this.gridSize * (this.camera.y - o.position.y))) + this.camera.shakeOffsetY;\n\t\t\t\tlet healthBarWidth = o.display.width * this.gridSize * this.camera.zoom;\n\t\t\t\tif(o instanceof Player) {\n\t\t\t\t\tthis.drawPlayerHealth(o);\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tthis.drawMobHealth(o, x, y, healthBarWidth);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tdrawPlayerHealth(player) {\n\t\tconst HEART_SIZE = 30;\n\t\tconst HEART_OFFSET = 20;\n\t\tlet x = 0, y = 0;\n\t\tfor(let i = 1; i <= this.player.health.health; i++) {\n\t\t\timage(this.ui[HEART], (x * HEART_SIZE) + HEART_OFFSET, (y * HEART_SIZE) + HEART_OFFSET, HEART_SIZE, HEART_SIZE);\n\t\t\tx++;\n\t\t\tif(i % 15 == 0) {\n\t\t\t\ty++;\n\t\t\t\tx = 0;\n\t\t\t}\n\t\t}\n\t}\n\n\tdrawMobHealth(mob, x, y, healthBarWidth) {\n\t\tconst HEALTH_BAR_OFFSET = 3;\n\t\tconst HEALTH_BAR_HEIGHT = 4;\n\t\tconst xoff = this.gridSize * mob.animation.offsetX;\n\t\tconst yoff = this.gridSize * mob.animation.offsetY;\n\t\thealthBarWidth = healthBarWidth - (this.gridSize / 4);\n\t\tfill(40,0,0);\n\t\trect(xoff + x + (this.gridSize / 8), yoff + y - HEALTH_BAR_OFFSET, healthBarWidth, HEALTH_BAR_HEIGHT);\n\t\thealthBarWidth = healthBarWidth * Utility.getHealthPercent(mob);\n\t\tfill(50, 220, 120);\n\t\trect(xoff + x + (this.gridSize / 8), yoff + y - HEALTH_BAR_OFFSET, healthBarWidth, HEALTH_BAR_HEIGHT);\n\t}\n\n\tcenterCamera(camera, position, offsetX = 0, offsetY = 0) {\n\t\tcamera.x = position.x + offsetX;\n\t\tcamera.y = position.y + offsetY;\n\t\t//if(entity.position.x > camera.x) {\n\t\t//\tcamera.x = floor(camera.x * 40 + 1) / 40;\n\t\t//\tcameraMoveTimer = setTimeout(function() {moveCamera(camera, entity, direction)}, this.config.CAMERA_MOVE_SPEED);\n\t\t//}\n\t\t//else{\n\t\t//\tclearTimeout(cameraMoveTimer);\n\t\t//}\n\t}\n\n\tdecideCameraZoomState(camera) {\n\t\tif(camera.combat) {\n\t\t\tif(camera.sprinting) {\n\t\t\t\tthis.changeZoom(camera, this.config.CAMERA_ZOOM_STEPS_SLOW, this.config.CAMERA_COMBAT_ZOOM);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthis.changeZoom(camera, this.config.CAMERA_ZOOM_STEPS_MEDIUM, this.config.CAMERA_COMBAT_ZOOM);\n\t\t\t}\n\t\t}\n\t\telse if(camera.sprinting) {\n\t\t\tthis.changeZoom(camera, this.config.CAMERA_ZOOM_STEPS_MEDIUM, this.config.CAMERA_SPRINT_ZOOM);\n\t\t}\n\t\telse {\n\t\t\tthis.changeZoom(camera, this.config.CAMERA_ZOOM_STEPS_MEDIUM, this.config.CAMERA_DEFAULT_ZOOM);\n\t\t}\n\t}\n\n\tchangeZoom(camera, steps, zoom) {\n\t\tif(camera.zoom != zoom) {\n\t\t\tclearTimeout(this.cameraZoomTimer);\n\t\t\tthis.recursiveZoom(camera, this.config.CAMERA_ZOOM_SPEED, zoom, (zoom - camera.zoom) / steps);\n\t\t}\n\t}\n\n\trecursiveZoom(camera, speed, zoom, dif) { \n\t\tlet self = this;\n\t\tif(dif <= 0 && zoom - camera.zoom >= 0) { \n\t\t\tcamera.zoom = zoom;\n\t\t\treturn;\n\t\t}\n\t\telse if(dif > 0 && zoom - camera.zoom <= 0) { \n\t\t\tcamera.zoom = zoom;\n\t\t\treturn;\n\t\t}\n\t\telse {\n\t\t\tcamera.zoom += dif;\n\t\t\tthis.cameraZoomTimer = setTimeout(function() { self.recursiveZoom(camera, speed, zoom, dif); }, speed);\n\t\t}\n\t}\n\n\tshakeCamera(camera, shakeAmount) {\n\t\tlet self = this;\n\t\tclearTimeout(this.cameraShakeTimer);\n\t\tif(shakeAmount > 0) {\n\t\t\tcamera.shakeOffestX = ((shakeAmount % 2 == 0) ? -1 : 1) * (randomInt(0, shakeAmount * this.config.CAMERA_SHAKE_MULTIPLIER) + this.config.CAMERA_SHAKE_CONSTANT);\n\t\t\tcamera.shakeOffsetY = random(-1, 1) * this.config.CAMERA_SHAKE_CONSTANT / 2 * shakeAmount;\n\t\t\tthis.cameraShakeTimer = setTimeout(function() { self.shakeCamera(camera, shakeAmount - 1); }, this.config.CAMERA_SHAKE_SPEED);\n\t\t}\n\t\telse{\n\t\t\tcamera.shakeOffsetX = 0;\n\t\t\tcamera.shakeOffsetY = 0;\n\t\t\tthis.cameraShakeTimer = undefined;\n\t\t}\n\t}\n\n\tresize() {\n\t\tresizeCanvas(window.innerWidth, window.innerHeight);\n\t\tthis.centerX = floor(width / 2);\n\t\tthis.centerY = floor(height / 2);\n\t}\n}\n","class EntitySystem extends System {\n\n\tconstructor(player_data, entity_data) {\n\t\tsuper([component_actions]);\n\n\t\tthis.playerData = player_data;\n\t\tthis.entityData = entity_data;\n\n\t\tthis.entities = [];\n\t\tthis.levels = [];\n\t\tthis.depth = 0;\n\t\tthis.player;\n\t}\n\n\trun(engine) {\n\t\tfor(let e of this.objects) {\n\t\t\tif(e instanceof Mob) {\n\t\t\t\t// let action = getMobBehavior(e, player);\n\t\t\t\t// e.actions.nextAction = action;\n\t\t\t}\n\t\t}\n\t}\n\n\thandleEvent(engine, eventID, data) {\n\t\tswitch(eventID) {\n\t\t\tcase event_first_level_initiated:\n\t\t\t\tthis.generatePlayer(engine, this.levels[0].stairUp);\n\t\t\t\tthis.generateEnemies(engine, this.depth);\n\t\t\t\tbreak;\n\t\t\tcase event_new_level:\n\t\t\t\tthis.generateEnemies(engine, this.depth + 1);\n\t\t\t\tbreak;\n\t\t\tcase event_up_level: \n\t\t\t\tthis.depth--;\t\n\t\t\t\tthis.updateEntities(engine);\n\t\t\t\tbreak;\n\t\t\tcase event_down_level:\n\t\t\t\tthis.depth++;\n\t\t\t\tthis.updateEntities(engine);\n\t\t\t\tbreak;\n\t\t\tcase event_spawn_enemy_close:\n\t\t\t\tlet config = this.entityData[random(Object.keys(this.entityData))];\n\t\t\t\tthis.generateEnemy(engine, this.player.position.x - randomInt(-4, 4), this.player.position.y - randomInt(2, 4), this.depth, config);\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\taddObject(object) {\n\t\tif(object instanceof Level) { this.levels.push(object); }\n\t\telse{ super.addObject(object); }\n\t}\n\n\tremoveObject(object) {\n\t\tfor(let level of this.entities) {\n\t\t\tif(level.includes(object)) {\n\t\t\t\tlevel.splice(level.indexOf(object), 1);\n\t\t\t}\n\t\t}\n\t\tsuper.removeObject(object);\n\t}\n\n\tgeneratePlayer(engine, position) {\n\t\tlet animations = Utility.convertAnimationsFromConfig(this.playerData.animations);\n\t\tlet actions = Utility.convertActionsFromConfig(this.playerData.actions);\n\t\tlet config = this.playerData;\n\t\tlet playerClass = this.playerData.classes.warrior;\n\t\tthis.player = new Player(position.x, position.y, config, playerClass, actions, animations);\n\t\tengine.sendEvent(event_player_generated);\n\t\tengine.addObject(this.player);\n\t}\n\n\tgenerateEnemies(engine, depth) {\n\t\tlet config = this.entityData[random(Object.keys(this.entityData))];\n\n\t\tthis.entities[depth] = [];\n\t\tlet numEntities = depth + 7;\n\n\t\twhile(numEntities > 0) {\n\t\t\tlet entityPosition = this.findSafeSpawnLocation(config.size, this.entities[depth], this.levels[depth].map.map);\t\t\t\n\t\t\tif(entityPosition != undefined) {\n\t\t\t\tthis.generateEnemy(engine, entityPosition.x, entityPosition.y, depth, config);\n\t\t\t}\n\t\t\tnumEntities--;\n\t\t}\n\t}\n\n\tgenerateEnemy(engine, x, y, depth, config) {\n\t\tlet animations = Utility.convertAnimationsFromConfig(config.animations);\n\t\tlet actions = Utility.convertActionsFromConfig(config.actions);\n\t\tif(this.safeSpawnLocation(x, y, config.size, this.entities[depth], this.levels[depth].map.map)) {\n\t\t\tlet mob = new Mob(x, y, depth, config, actions, animations);\n\t\t\tif(config.sprint_threshhold !== undefined) {\n\t\t\t\tmob.components.push(component_sprint);\n\t\t\t\tmob.sprint = new SprintComponent(config.sprint_threshhold);\n\t\t\t}\n\t\t\tthis.entities[depth].push(mob);\n\t\t\tengine.addObject(mob);\n\t\t\tengine.sendEvent(event_entity_spawned, mob);\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\n\tfindSafeSpawnLocation(size, entities, map) {\n\t\tlet validSquares = [];\n\t\tfor(let i = 0; i < map.length; i++) {\n\t\t\tfor(let j = 0; j < map[0].length; j++) {\n\t\t\t\tif(this.safeSpawnLocation(i, j, size, entities, map)) {\n\t\t\t\t\tvalidSquares.push(map[i][j].position);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn random(validSquares);\n\t}\n\n\tsafeSpawnLocation(x, y, size, entities, map) {\n\t\tfor(let i = x; i < x + size; i++) {\n\t\t\tfor(let j = y; j < y + size; j++) {\n\t\t\t\tif(map[i][j].physical.solid) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tlet col = new CollisionComponent(x, y, size);\n\t\tfor(let e of entities) {\n\t\t\tif(Utility.collision(col, e.collision)) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t\treturn true;\n\t}\n\n\tupdateEntities(engine) {\n\t\tfor(let e of this.entities[this.depth]) {\n\t\t\tengine.addObject(e);\n\t\t}\n\t\tengine.addObject(this.player);\n\t}\n}\n","class HealthSystem extends System {\n\n\tconstructor(config) {\n\t\tsuper([component_health]);\n\n\t\tthis.config = config;\n\n\t\tthis.healthRegenCounter = 0;\n\t\tthis.healthRegen = true;\n\t}\n\n\trun(engine) { \n\t\tif(this.healthRegen) {\n\t\t\tif(this.healthRegenCounter % this.config.HEALTH_REGEN_TIMER == 0) {\t\n\t\t\t\tfor(let o of this.objects) {\n\t\t\t\t\tif(o.health.health < o.health.maxHealth) {\n\t\t\t\t\t\to.health.health++;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis.healthRegenCounter = 1;\n\t\t\t}\n\t\t\tthis.healthRegenCounter++;\n\t\t}\n\t}\n\n\thandleEvent(engine, eventID, data) {\n\t\tswitch(eventID) { \n\t\t\tcase event_entity_take_damage:\n\t\t\t\tif(data.object instanceof Player) { engine.sendEvent(event_player_take_damage); }\n\t\t\t\tthis.applyDamage(engine, data.object, data.healthLost);\n\t\t\t\tbreak;\n\t\t\tcase event_begin_combat:\n\t\t\t\tthis.healthRegen = false;\n\t\t\t\tbreak;\n\t\t\tcase event_end_combat:\n\t\t\t\tthis.healthRegen = true;\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tapplyDamage(engine, object, healthLost) {\n\t\tobject.health.health -= healthLost;\n\t\tthis.checkDead(engine, object);\n\t}\n\n\tcheckDead(engine, object) {\n\t\tif(object.health.health <= 0) {\n\t\t\tengine.removeObject(object);\n\t\t\tif(object instanceof Player) {\n\t\t\t\tengine.sendEvent(event_game_over);\n\t\t\t}\n\t\t}\n\t}\n}\n\n","class InputSystem extends System {\n\n\tconstructor() {\n\t\tsuper([]);\n\t\tthis.player;\n\t\tthis.mobSpawnCooldown = 0;\n\t}\n\n\trun(engine) {\n\t\tif(keys.includes('n') && this.mobSpawnCooldown <= 0) {\n\t\t\tthis.mobSpawnCooldown = 10;\n\t\t\tengine.sendEvent(event_spawn_enemy_close, this.player);\n\t\t}\n\n\t\tif(this.mobSpawnCooldown > 0) {\n\t\t\tthis.mobSpawnCooldown--;\n\t\t}\n\n\t\tthis.player.actions.nextAction = this.determineAction();\t\t\n\t}\n\n\taddObject(object) {\n\t\tif(object instanceof Player) {\n\t\t\tthis.player = object;\n\t\t}\n\t}\n\n\tdetermineAction() {\n\t\tlet action = action_none;\n\n\t\tif(keys.length > 0) {\n\t\t\tlet highestPriority = 0;\n\t\t\tfor(let k of keys) {\n\t\t\t\tlet a = key_to_action[k];\n\t\t\t\tlet priority = action_to_priority[a];\n\t\t\t\tpriority = this.fixPriority(this.player, a, priority);\n\t\t\t\tif(priority > highestPriority) {\n\t\t\t\t\taction = a;\n\t\t\t\t\thighestPriority = priority;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn action;\n\t}\n\n\tfixPriority(player, a, priority) {\n\t\tif(this.actionEqualsLastAction(player, a)) {\n\t\t\tif(player.actions.lastActionFailed) { return 0; }\n\t\t\telse { return priority - 1; }\n\t\t}\n\t\treturn priority;\n\t}\n\n\n\tactionEqualsLastAction(player, a) {\n\t\treturn player.actions.lastAction == a;\n\t}\n}\n","class LevelSystem extends System {\n\n\tconstructor(config, room_pool, stair_room_pool) {\n\t\tsuper([]);\n\n\t\tthis.config = config;\n\t\tthis.roomPool = room_pool;\n\t\tthis.stairRoomPool = stair_room_pool;\n\n\t\tthis.player;\n\t\tthis.depth = 0;\n\t\tthis.levels = [];\n\t}\n\n\trun(engine) { }\n\n\thandleEvent(engine, eventID, data) {\n\t\tswitch(eventID) {\n\t\t\tcase event_down_level:\n\t\t\t\tthis.handleDownLevel(engine);\n\t\t\t\tbreak;\n\t\t\tcase event_up_level:\n\t\t\t\tthis.handleUpLevel(engine);\n\t\t\t\tbreak;\n\t\t\tcase event_new_game:\n\t\t\t\tthis.handleNewGame(engine);\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\taddObject(object) {\n\t\tif(object instanceof Player) {\n\t\t\tthis.player = object;\n\t\t}\n\t\tsuper.addObject(object);\n\t}\n\n\thandleNewGame(engine) {\n\t\tthis.newLevel(engine, 0);\n\t\tthis.updateLevel(engine);\n\t\tengine.sendEvent(event_first_level_initiated);\n\t}\n\n\tnewLevel(engine, depth) {\n\t\tlet level = generateLevel(this.config, depth, this.roomPool, this.stairRoomPool);\n\t\tthis.levels.push(level);\n\t\treturn level; \n\t}\n\n\thandleDownLevel(engine) {\n\t\tengine.clearObjects();\n\t\tthis.depth++;\n\t\tif(this.depth == this.levels.length) {\n\t\t\tthis.newLevel(engine, this.depth); \n\t\t\tthis.updateLevel(engine);\n\t\t\tengine.sendEvent(event_new_level);\n\t\t}\n\t\telse{\n\t\t\tthis.updateLevel(engine);\n\t\t}\n\t\tthis.fixPlayerPosition(this.levels[this.depth].stairUp);\n\t}\n\n\thandleUpLevel(engine) {\n\t\tengine.clearObjects();\n\t\tif(this.depth > 0) {\n\t\t\tthis.depth--; \n\t\t\tthis.updateLevel(engine);\n\t\t\tthis.fixPlayerPosition(this.levels[this.depth].stairDown);\n\t\t}\n\t}\n\n\tupdateLevel(engine) {\n\t\tlet level = this.levels[this.depth];\n\t\tengine.addObject(level);\n\t\tfor (var i = 0; i < this.levels[this.depth].map.map.length; i++) {\n\t\t\tfor (let j = 0; j < this.levels[this.depth].map.map.length; j++) {\n\t\t\t\tengine.addObject(level.map.map[i][j]);\n\t\t\t}\n\t\t}\n\t}\n\n\tfixPlayerPosition(stair) {\n\t\tthis.player.position.x = stair.x;\n\t\tthis.player.position.y = stair.y;\n\t}\n}\n","class MovementSystem extends System {\n\n\tconstructor() {\n\t\tsuper([component_position, component_physical, component_actions]);\n\t\tthis.map;\n\t\tthis.depth = 0;\n\t}\n\n\trun(engine) {\n\t\tfor(let o of this.objects) {\n\t\t\tswitch(o.actions.currentAction) {\n\t\t\t\tcase action_move_up: case action_move_right: case action_move_down: case action_move_left:\n\t\t\t\t\tthis.move(engine, this.map, o, this.objects);\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\thandleEvent(engine, eventID) {\n\t\tswitch(eventID) {\n\t\t\tcase event_up_level:\n\t\t\t\tthis.depth--;\n\t\t\t\tbreak;\n\t\t\tcase event_down_level:\n\t\t\t\tthis.depth++;\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\taddObject(object) {\n\t\tif(object instanceof Level) {\n\t\t\tthis.map = object.map.map;\n\t\t}\n\t\telse {\n\t\t\tsuper.addObject(object);\n\t\t}\n\t}\n\n\tmove(engine, map, entity, objects) {\n\t\tlet targetX = entity.position.x;\n\t\tlet targetY = entity.position.y;\n\n\t\tswitch (entity.actions.currentAction) {\n\t\t\tcase action_move_up:\n\t\t\t\ttargetY--;\n\t\t\t\tbreak;\n\t\t\tcase action_move_right:\n\t\t\t\ttargetX++;\n\t\t\t\tbreak;\n\t\t\tcase action_move_down:\n\t\t\t\ttargetY++;\n\t\t\t\tbreak;\n\t\t\tcase action_move_left:\n\t\t\t\ttargetX--;\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tconsole.log(\"No direction\");\n\t\t\t\tbreak;\n\t\t}\n\n\t\tentity.direction.direction = action_to_direction[entity.actions.currentAction];\n\n\t\tlet walkable = true;\n\n\t\tfor(let i = targetX; i < targetX + entity.physical.size; i++) {\n\t\t\tfor(let j = targetY; j < targetY + entity.physical.size; j++) {\n\t\t\t\tif(!Utility.walkable(i, j, map, entity, objects)) {\n\t\t\t\t\twalkable = false;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif(walkable) {\n\t\t\tentity.position.x = targetX;\n\t\t\tentity.position.y = targetY;\n\n\t\t\tentity.collision.top = targetY;\n\t\t\tentity.collision.right = targetX + entity.physical.size;\n\t\t\tentity.collision.bottom = targetY + entity.physical.size;\n\t\t\tentity.collision.left = targetX;\n\n\t\t\tif(entity instanceof Player) {\n\t\t\t\tthis.playerWalkEvents(engine, entity, map[targetX][targetY]);\n\t\t\t}\n\n\t\t\tengine.sendEvent(event_successful_action, { \"action\": entity.actions.currentAction, \"entity\": entity });\n\n\t\t}\n\t\telse{\n\t\t\tentity.actions.lastAction = entity.actions.currentAction;\n\t\t\tentity.actions.currentAction = action_none;\n\t\t\t//handle\n\t\t}\n\t}\n\n\tplayerWalkEvents(engine, player, square) {\n\t\tif(square instanceof StairUpSquare && this.depth > 0) {\n\t\t\tengine.sendEvent(event_up_level); \n\t\t}\n\t\telse if(square instanceof StairDownSquare) {\n\t\t\tengine.sendEvent(event_down_level); \n\t\t}\n\t\telse if(square instanceof DoorSquare) {\n\t\t\tsquare.open();\n\t\t}\n\t\tengine.sendEvent(event_player_moved);\n\t}\n}\n","function MusicManager() {\n\n    let music = MUSIC;\n    MUSIC = null;\n    let currentLoop = music[0];\n\n    let loop = function () {\n        currentLoop.ended = function () {\n            currentLoop = playSound(music[randomInt(music.length)]);\n            loop();\n        }\n    }\n\n    let init = (function () {\n        // currentLoop = playSound(currentLoop);\n        // loop();\n    })();\n}","class SprintSystem extends System {\n\n\tconstructor() {\n\t\tsuper([component_sprint]);\n\n\t\tthis.sprintTimer = [];\n\t\tthis.sprintTimerMax = 20;\n\t\tthis.combat = false;\n\t}\n\n\trun(engine) {\n\t\tfor(let entity of this.objects) {\n\t\t\tif(!this.combat) {\n\t\t\t\tthis.decrementSprintCounter(entity);\n\t\t\t\tthis.determineSprintState(engine, entity);\n\t\t\t}\n\t\t}\n\t}\n\n\thandleEvent(engine, eventID, data) {\n\t\tswitch(eventID) {\n\t\t\tcase event_successful_action:\n\t\t\t\tif(!this.combat && data.entity.components.includes(component_sprint)) {\n\t\t\t\t\tthis.sprintHandler(engine, data.entity, data.action);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase event_begin_combat:\n\t\t\t\tthis.combat = true;\n\t\t\t\tthis.stopAllSprinting(engine);\n\t\t\t\tbreak;\n\t\t\tcase event_end_combat:\n\t\t\t\tthis.combat = false;\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\taddObject(object) {\n\t\tif(object.components.includes(component_sprint)) {\n\t\t\tsuper.addObject(object);\n\t\t\tthis.sprintTimer[object] = 0;\n\t\t}\n\t}\n\n\tsprintHandler(engine, entity, action) {\n\t\tif(Utility.isMovementAction(action)) {\n\t\t\tif(entity.sprint.sprintCounter < entity.sprint.movesBeforeSprinting) {\n\t\t\t\tentity.sprint.sprintCounter++;\n\t\t\t}\n\t\t\tthis.resetSprintTimer(entity);\n\t\t}\n\t\telse {\n\t\t\tif(entity.sprint.sprintCounter > 0) {\n\t\t\t\tentity.sprint.sprintCounter--;\n\t\t\t}\n\t\t}\n\t\tthis.determineSprintState(engine, entity);\n\t}\n\n\tdetermineSprintState(engine, entity) {\n\t\tif(entity.sprint.sprinting) {\n\t\t\tif(entity.sprint.sprintCounter < entity.sprint.movesBeforeSprinting) {\n\t\t\t\tthis.stopSprinting(engine, entity);\n\t\t\t}\n\t\t}\n\t\telse if(!entity.sprint.sprinting && entity.sprint.sprintCounter == entity.sprint.movesBeforeSprinting) {\n\t\t\tthis.startSprinting(engine, entity);\n\t\t}\n\t}\n\n\tstartSprinting(engine, entity) {\n\t\tif(entity instanceof Player) {\n\t\t\tengine.sendEvent(event_player_start_sprinting);\n\t\t}\n\t\tentity.sprint.sprinting = true;\n\t\tthis.resetSprintTimer(entity);\n\t}\n\n\tstopSprinting(engine, entity) {\n\t\tif(entity instanceof Player) {\n\t\t\tengine.sendEvent(event_player_stop_sprinting);\n\t\t}\n\t\tentity.sprint.sprinting = false;\n\t\tentity.sprint.sprintCounter = 0;\n\t}\n\n\tresetSprintTimer(entity) {\n\t\tthis.sprintTimer[entity] = this.sprintTimerMax;\n\t}\n\n\tdecrementSprintCounter(entity) {\n\t\tif(entity.sprint.sprintCounter > 0) {\n\t\t\tthis.sprintTimer[entity]--;\n\t\t\tif(this.sprintTimer[entity] <= 0) {\n\t\t\t\tentity.sprint.sprintCounter--;\n\t\t\t\tthis.resetSprintTimer(entity);\n\t\t\t}\n\t\t}\n\t}\n\n\tstopAllSprinting(engine) {\n\t\tfor(let entity of this.objects) {\n\t\t\tthis.stopSprinting(engine, entity);\n\t\t}\n\t}\n}\n","class VisionSystem extends System {\n\n\tconstructor(config) {\n\t\tsuper([]);\n\n\t\tthis.player;\n\t\tthis.map;\n\t\tthis.entities = [];\n\t\tthis.config = config;\n\t}\n\n\trun(engine) { }\n\n\thandleEvent(engine, eventID, data) {\n\t\tswitch (eventID) {\n\t\t\tcase event_start_game: case event_player_moved: case event_down_level: case event_up_level: case event_entity_spawned:\n\t\t\t\tthis.vision(this.map, this.player);\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\taddObject(object) {\n\t\tif(object instanceof Player) { this.player = object; }\n\t\telse if(object instanceof Level) { this.map = object.map.map }\n\t\telse if(object instanceof Mob) { this.entities.push(object); }\n\t}\n\n\tvision(map, player) {\n\t\tfor(let r of map) {\n\t\t\tfor(let s of r) {\n\t\t\t\ts.display.visible = false;\n\t\t\t\tif(s.display.discovered > 0) {s.display.discovered--};\n\t\t\t\tif(s.components.includes(component_light)) { s.light.lightLevel = 0; }\n\t\t\t}\n\t\t}\n\t\tplayer.display.visible = true;\n\t\tmap[player.position.x][player.position.y].display.visible = true;\n\t\tmap[player.position.x][player.position.y].display.discovered = this.config.DISCOVERED_MAX;\n\t\tmap[player.position.x][player.position.y].light.lightLevel = light_range;\n\t\tfor(let octant = 0; octant < 8; octant++) {\n\t\t\tthis.playerSightTriangle(map, octant, player.position.x, player.position.y, this.config.PLAYER_VISION_RANGE);\n\t\t\tthis.lightTriangle(map, octant, player.position.x, player.position.y, light_range);\n\t\t}\n\t\tfor(let e of this.entities) {\n\t\t\tif(map[e.position.x][e.position.y].display.visible) { \n\t\t\t\te.display.visible = true;\n\t\t\t\te.display.discovered = true;\n\t\t\t}\n\t\t\telse {\n\t\t\t\te.display.visible = false;\n\t\t\t}\n\t\t}\n\t}\n\n\tlightTriangle(map, octant, sx, sy, range) {\n\t\tlet x = 1;\n\t\tlet shadows = [];\n\t\tlet squaresVisible = true;\n\n\t\twhile (x <= range && squaresVisible) {\n\t\t\tsquaresVisible = false;\n\t\t\tlet y = 0;\n\t\t\tlet curslope = 0;\n\t\t\twhile(curslope <= 1) {\n\t\t\t\tif(!this.inShadow(x, y, shadows)) {\n\t\t\t\t\tsquaresVisible = true;\n\t\t\t\t\tlet cur = this.getTranslatedSquare(map, octant, x, y, sx, sy); \n\t\t\t\t\tif(cur === undefined) { break; }\n\t\t\t\t\tcur.light.lightLevel = range - x;\n\t\t\t\t\tif(cur.display.opaque) {\n\t\t\t\t\t\tlet firstBlocked = this.getFirstBlockedLight(map, octant, x, y, sx, sy, shadows, range);\n\t\t\t\t\t\tlet lastBlocked = this.getBlockedLight(map, octant, x, y, sx, sy, shadows, range);\n\t\t\t\t\t\tlet shadowStart = this.slope(firstBlocked.x, firstBlocked.y, BOTTOM_RIGHT);\n\t\t\t\t\t\tlet shadowEnd = this.slope(lastBlocked.x, lastBlocked.y, TOP_LEFT);\n\t\t\t\t\t\tshadows.push([shadowStart, shadowEnd]);\n\t\t\t\t\t}\n\t\t\t\t\telse{\n\t\t\t\t\t\tlet above = this.getTranslatedSquare(map, octant, x, y + 1, sx, sy); \n\t\t\t\t\t\tif(above !== undefined ) { \n\t\t\t\t\t\t\t// above.display.discovered = this.config.DISCOVERED_MAX;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\ty++;\n\t\t\t\tcurslope = this.slope(x, y, CENTER_SQUARE); \n\t\t\t}\n\t\t\tx++;\n\t\t}\n\t}\n\n\tgetFirstBlockedLight(map, octant, x, y, sx, sy, shadows, range) {\n\t\tlet firstBlocked = {x:x, y:y};\n\n\t\tlet currentBlocked = this.getTranslatedSquare(map, octant, x, y, sx, sy); \n\n\t\twhile(currentBlocked !== undefined && currentBlocked.display.opaque && this.slope(x, y, CENTER_SQUARE) > 0) {\n\t\t\tfirstBlocked = {x:x, y:y};\n\t\t\tif(!this.inShadow(x, y, shadows)) {\n\t\t\t\tcurrentBlocked.light.lightLevel = range - x;\n\t\t\t}\n\n\t\t\ty--;\n\t\t\tcurrentBlocked = this.getTranslatedSquare(map, octant, x, y, sx, sy);\n\t\t}\n\t\treturn firstBlocked;\n\t}\n\n\tgetBlockedLight(map, octant, x, y, sx, sy, shadows, range) {\n\t\tlet lastBlocked = {x:x, y:y};\n\n\t\tlet currentBlocked = this.getTranslatedSquare(map, octant, x, y, sx, sy); \n\n\t\twhile(currentBlocked !== undefined && currentBlocked.display.opaque && this.slope(x, y, BOTTOM_RIGHT) < 1) {\n\t\t\tlastBlocked = {x:x, y:y};\n\t\t\tif(!this.inShadow(x, y, shadows)) {\n\t\t\t\tcurrentBlocked.light.lightLevel = range - x;\n\t\t\t}\n\n\t\t\ty++;\n\t\t\tcurrentBlocked = this.getTranslatedSquare(map, octant, x, y, sx, sy);\n\t\t}\n\t\treturn lastBlocked;\n\t}\n\n\tplayerSightTriangle(map, octant, sx, sy, range) {\n\t\tlet x = 1;\n\t\tlet shadows = [];\n\t\tlet squaresVisible = true;\n\n\t\twhile (x <= range && squaresVisible) {\n\t\t\tsquaresVisible = false;\n\t\t\tlet y = 0;\n\t\t\tlet curslope = 0;\n\t\t\twhile(curslope <= 1) {\n\t\t\t\tif(!this.inShadow(x, y, shadows)) {\n\t\t\t\t\tsquaresVisible = true;\n\t\t\t\t\tlet cur = this.getTranslatedSquare(map, octant, x, y, sx, sy); \n\t\t\t\t\tif(cur === undefined) { break; }\n\t\t\t\t\tcur.display.visible = true;\n\t\t\t\t\tcur.display.discovered = this.config.DISCOVERED_MAX;\n\t\t\t\t\tif(cur.display.opaque) {\n\t\t\t\t\t\tlet firstBlocked = this.getFirstBlocked(map, octant, x, y, sx, sy, shadows);\n\t\t\t\t\t\tlet lastBlocked = this.getBlocked(map, octant, x, y, sx, sy, shadows);\n\t\t\t\t\t\tlet shadowStart = this.slope(firstBlocked.x, firstBlocked.y, BOTTOM_RIGHT);\n\t\t\t\t\t\tlet shadowEnd = this.slope(lastBlocked.x, lastBlocked.y, TOP_LEFT);\n\t\t\t\t\t\tshadows.push([shadowStart, shadowEnd]);\n\t\t\t\t\t}\n\t\t\t\t\telse{\n\t\t\t\t\t\tlet above = this.getTranslatedSquare(map, octant, x, y + 1, sx, sy); \n\t\t\t\t\t\tif(above !== undefined ) { above.display.discovered = this.config.DISCOVERED_MAX; }\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\ty++;\n\t\t\t\tcurslope = this.slope(x, y, CENTER_SQUARE); \n\t\t\t}\n\t\t\tx++;\n\t\t}\n\t}\n\n\tslope(x, y, CORNER) {\n\t\tswitch(CORNER) {\n\t\t\tcase CENTER_SQUARE:\n\t\t\t\treturn y/x;\n\t\t\tcase TOP_LEFT:\n\t\t\t\tif(x == 0) {\n\t\t\t\t\treturn 1;\n\t\t\t\t}\n\t\t\t\treturn (y + .5)/(x - .5);\n\t\t\tcase BOTTOM_RIGHT:\n\t\t\t\treturn max(0, (y - .5)/(x + .5));\n\t\t\tcase UPPER_BOUND:\n\t\t\t\treturn (y + PERM)/(x - PERM);\n\t\t\tcase LOWER_BOUND:\n\t\t\t\treturn (y - PERM)/(x + PERM);\n\t\t}\n\t\treturn 1;\n\t}\n\n\tgetFirstBlocked(map, octant, x, y, sx, sy, shadows) {\n\t\tlet firstBlocked = {x:x, y:y};\n\n\t\tlet currentBlocked = this.getTranslatedSquare(map, octant, x, y, sx, sy); \n\n\t\twhile(currentBlocked !== undefined && currentBlocked.display.opaque && this.slope(x, y, CENTER_SQUARE) > 0) {\n\t\t\tfirstBlocked = {x:x, y:y};\n\t\t\tif(!this.inShadow(x, y, shadows)) {\n\t\t\t\tcurrentBlocked.display.visible = true;\n\t\t\t\tcurrentBlocked.display.discovered = this.config.DISCOVERED_MAX;\n\t\t\t}\n\n\t\t\ty--;\n\t\t\tcurrentBlocked = this.getTranslatedSquare(map, octant, x, y, sx, sy);\n\t\t}\n\t\treturn firstBlocked;\n\t}\n\n\tgetBlocked(map, octant, x, y, sx, sy, shadows) {\n\t\tlet lastBlocked = {x:x, y:y};\n\n\t\tlet currentBlocked = this.getTranslatedSquare(map, octant, x, y, sx, sy); \n\n\t\twhile(currentBlocked !== undefined && currentBlocked.display.opaque && this.slope(x, y, BOTTOM_RIGHT) < 1) {\n\t\t\tlastBlocked = {x:x, y:y};\n\t\t\tif(!this.inShadow(x, y, shadows)) {\n\t\t\t\tcurrentBlocked.display.visible = true;\n\t\t\t\tcurrentBlocked.display.discovered = this.config.DISCOVERED_MAX;\n\t\t\t}\n\n\t\t\ty++;\n\t\t\tcurrentBlocked = this.getTranslatedSquare(map, octant, x, y, sx, sy);\n\t\t}\n\t\treturn lastBlocked;\n\t}\n\n\tinShadow(x, y, shadows) {\n\t\tlet BR = this.slope(x, y, BOTTOM_RIGHT), TL = this.slope(x, y, TOP_LEFT);\n\t\tfor(let s of shadows) {\n\t\t\tif( BR >= s[0] && TL <= s[1]) return true;\n\t\t\telse if( BR >= s[0] && BR <= s[1] && TL >= s[1]) { BR = s[1]; }\n\t\t\telse if( BR <= s[0] && TL >= s[0] && TL <= s[1]) { TL = s[0]; }\n\t\t}\n\t\treturn false;\n\t}\n\n\tstartSquare(x, slopeStart) {\n\t\tif(slopeStart == 0) return 0; \n\t\treturn ceil(x * slopeStart);\n\t}\n\n\tgetTranslatedSquare(map, octant, x, y, sx, sy) {\n\t\tlet uc = this.translate(octant, x, y);\n\t\tlet fx = sx + uc[0];\n\t\tlet fy = sy - uc[1];\n\t\tif(Utility.positionInBounds(fx, fy, map.length)) {\n\t\t\treturn map[fx][fy];\n\t\t}\n\t\treturn undefined;\n\t}\n\n\ttranslate(octant, x, y) {\n\t\treturn[ x * xxcomp[octant] + y * xycomp[octant], x * yxcomp[octant] + y * yycomp[octant]];\n\t}\n\n}\n","function Level(map, stairUp, stairDown, depth) {\n\tthis.components = [component_map, component_stair, component_depth];\n\tthis.map = new MapComponent(map);\n\tthis.stairUp = new StairComponent(stairUp.x, stairUp.y);\n\tthis.stairDown = new StairComponent(stairDown.x, stairDown.y);\n\tthis.depth = new DepthComponent(depth)\n}\n","function Square(x, y, texture, solid, opaque) {\n\tthis.components = [component_position, component_display, component_physical, component_light];\n\tthis.position = new PositionComponent(x, y);\n\tthis.display = new DisplayComponent(texture, 1, 1, opaque);\n\tthis.physical = new PhysicalComponent(solid, 1);\n\tthis.light = new LightComponent();\n}\n\nWallSquare.prototype = Object.create(Square.prototype);\nfunction WallSquare(x, y) {\n\tSquare.call(this, x, y, texture_wall, physical_solid, display_opaque);\n}\n\nFloorSquare.prototype = Object.create(Square.prototype);\nfunction FloorSquare(x, y) {\n\tSquare.call(this, x, y, texture_floor, physical_non_solid, display_transparent);\n}\n\nDoorSquare.prototype = Object.create(Square.prototype);\nfunction DoorSquare(x, y) {\n\tSquare.call(this, x, y, texture_door_closed, physical_solid, display_opaque);\n\tthis.opened = false;\n}\nDoorSquare.prototype.open = function () {\n\tthis.opened = true;\n\tthis.physical.solid = false;\n\tthis.display.texture = [texture_floor, texture_door_open];\n\tthis.display.opaque = false;\n}\n\nLootSquare.prototype = Object.create(Square.prototype);\nfunction LootSquare(x, y) {\n\tSquare.call(this, x, y, [texture_floor, texture_loot_closed], physical_solid, display_transparent);\n\tthis.opened = false;\n}\nLootSquare.prototype.open = function () {\n\tthis.opened = true;\n\tthis.display.texture = [texture_floor, texture_loot_open];\n}\n\nStairUpSquare.prototype = Object.create(Square.prototype);\nfunction StairUpSquare(x, y) {\n\tSquare.call(this, x, y, [texture_floor, texture_stair_up], physical_solid, display_transparent);\n}\n\nStairDownSquare.prototype = Object.create(Square.prototype);\nfunction StairDownSquare(x, y) {\n\tSquare.call(this, x, y, [texture_floor, texture_stair_down], physical_solid, display_transparent);\n}\n"]}