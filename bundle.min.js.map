{"version":3,"sources":["config/constants.js","js/systems/System.js","js/PoppsEngine.js","js/Utility.js","js/app.js","js/components/Components.js","js/entities/Entity.js","js/entities/Mob.js","js/entities/Player.js","js/items/Item.js","js/levelgen/LevelGenerator.js","js/levelgen/Room.js","js/systems/AISystem.js","js/systems/AbilitySystem.js","js/systems/ActionSystem.js","js/systems/AnimationSystem.js","js/systems/AudioSystem.js","js/systems/CombatSystem.js","js/systems/DisplaySystem.js","js/systems/EntitySystem.js","js/systems/HealthSystem.js","js/systems/InputSystem.js","js/systems/LevelSystem.js","js/systems/LightSystem.js","js/systems/MovementSystem.js","js/systems/MusicSystem.js","js/systems/SprintSystem.js","js/systems/UISystem.js","js/systems/VisionSystem.js","js/world/Level.js","js/world/Square.js","js/world/Torch.js"],"names":[],"mappings":"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","file":"bundle.min.js","sourcesContent":["//constants\nconst TITLE_SCREEN = false;\nconst LOADING_SCREEN_TIME = 30;\nconst LEVEL_GEN = true;\nconst DEBUG_MODE = false;\nconst UP = 0, RIGHT = 1, DOWN = 2, LEFT = 3;\nconst OPEN = 0, CLOSED = 1;\nconst entity_player = 0, entity_mob = 1;\nconst physical_solid = true, physical_non_solid = false;\nconst display_opaque = true, display_transparent = false;\nconst entity_active_range = 20;\n\n//vision\nconst CENTER_SQUARE = 0, TOP_LEFT = 1, BOTTOM_RIGHT = 2, UPPER_BOUND = 3, LOWER_BOUND = 4;\nconst PERM = .5;\n\nconst xxcomp = [ 1, 0, 0, -1, -1, 0, 0, 1 ];\nconst xycomp = [ 0, 1, -1, 0, 0, -1, 1, 0 ];\nconst yxcomp = [ 0, 1, 1, 0, 0, -1, -1, 0 ];\nconst yycomp = [ 1, 0, 0, 1, -1, 0, 0, -1 ];\n\n// lights\nconst light_range = 10, light_max = light_range - 1;\nconst light_intensity = .25, light_red = 255, light_green = 190, light_blue = 0;\nconst shadow_intensity = .40, shadow_stop = 4, shadow_red = 10, shadow_green = 0, shadow_blue = 40;\nconst light_fill_string = 'rgba(' + light_red + ',' + light_green + ',' + light_blue + ',' + light_intensity + ')';\n\nconst light_level_to_light = [];\nconst light_level_to_shadow = [];\nfor(let i = 0; i < light_range; i++) {\n\tlight_level_to_light.unshift('rgba(' +\n\t\tfloor(light_red - ((light_red / (light_range - 1)) * i)) + ',' +\n\t\tfloor(light_green - ((light_green / (light_range - 1)) * i)) + ',' +\n\t\tfloor(light_blue - ((light_blue / (light_range - 1)) * i)) + ',' +\n\t\t(floor(100 * (light_intensity - ((light_intensity / (light_range - 1)) * i))) / 100) + ')');\n\tif(i > shadow_stop) {\n\t\tlight_level_to_shadow.push('rgba(0,0,0,0)');\n\t}\n\telse {\n\t\tlight_level_to_shadow.push('rgba(' +\n\t\t\tfloor(shadow_red - ((shadow_red / shadow_stop) * i)) + ',' +\n\t\t\tfloor(shadow_green - ((shadow_green / shadow_stop) * i)) + ',' +\n\t\t\tfloor(shadow_blue - ((shadow_blue / shadow_stop) * i)) + ',' +\n\t\t\t(floor(100 * (shadow_intensity - ((shadow_intensity / shadow_stop) * i))) / 100) + ')');\n\t}\n}\n\nlight_level_to_light[light_level_to_light.length - 1] = light_level_to_light[light_level_to_light.length - 2];\n\nconst light_level_player = 3, light_level_torch = light_max - 2;\n\n// console.log(light_level_to_light);\n// console.log(light_level_to_shadow);\n\n//direction\nconst direction_up = 0, direction_right = 1, direction_down = 2, direction_left = 3;\n\n//square constants\nconst square_floor = 0, square_wall = 1, square_door = 2, square_stair_down = 3, square_stair_up = 4, square_loot = 5;\n\n//texture constants\nconst texture_floor = 0,\n\ttexture_wall = 1,\n\ttexture_door_closed = 2,\n\ttexture_door_open = 3,\n\ttexture_loot_closed = 4,\n\ttexture_loot_open = 5,\n\ttexture_stair_up = 6,\n\ttexture_stair_down = 7;\n\nconst texture_default = 0,\n\ttexture_alt1 = 1,\n\ttexture_alt2 = 2,\n\ttexture_alt3 = 3,\n\ttexture_alt4 = 4,\n\ttexture_alt5 = 5,\n\ttexture_alt6 = 6,\n\ttexture_alt7 = 7,\n\ttexture_alt8 = 8,\n\ttexture_alt9 = 9,\n\ttexture_side_top = 10,\n\ttexture_side_right = 11,\n\ttexture_side_bottom = 12,\n\ttexture_side_left = 13,\n\ttexture_in_corner_top_right = 14,\n\ttexture_in_corner_bottom_right = 15,\n\ttexture_in_corner_bottom_left = 16,\n\ttexture_in_corner_top_left = 17,\n\ttexture_out_corner_top_right = 18,\n\ttexture_out_corner_bottom_right = 19,\n\ttexture_out_corner_bottom_left = 20,\n\ttexture_out_corner_top_left = 21,\n\ttexture_U_top = 22,\n\ttexture_U_right = 23,\n\ttexture_U_bottom = 24,\n\ttexture_U_left = 25,\n\ttexture_cross = 26,\n\ttexture_num_alts = 27;\n\n\nconst texture_probability_distribution = [];\ntexture_probability_distribution[0] = 55;\ntexture_probability_distribution[1] = texture_probability_distribution[0] + 34;\ntexture_probability_distribution[2] = texture_probability_distribution[1] + 21;\ntexture_probability_distribution[3] = texture_probability_distribution[2] + 13;\ntexture_probability_distribution[4] = texture_probability_distribution[3] + 8;\ntexture_probability_distribution[5] = texture_probability_distribution[4] + 5;\ntexture_probability_distribution[6] = texture_probability_distribution[5] + 3;\ntexture_probability_distribution[7] = texture_probability_distribution[6] + 2;\ntexture_probability_distribution[8] = texture_probability_distribution[7] + 1;\ntexture_probability_distribution[9] = texture_probability_distribution[8] + 1;\n\nconst texture_probability_max = texture_probability_distribution[texture_probability_distribution.length - 1];\n\nconst ui_heart = 0, ui_empty_heart = 1;\n\n//components\nconst component_position = 0,\n\tcomponent_movement = 1,\n\tcomponent_display = 2,\n\tcomponent_texture = 3,\n\tcomponent_animation = 4,\n\tcomponent_actions = 5,\n\tcomponent_sprint = 6,\n\tcomponent_direction = 7,\n\tcomponent_map = 8,\n\tcomponent_health = 9,\n\tcomponent_light = 10,\n\tcomponent_strength = 11,\n\tcomponent_dexterity = 12,\n\tcomponent_magic = 13,\n\tcomponent_level = 14,\n\tcomponent_depth = 15,\n\tcomponent_stair = 16,\n\tcomponent_combat = 17,\n\tcomponent_ai = 18,\n\tcomponent_light_emitter = 19,\n\tcomponent_collision = 20,\n\tcomponent_abilities = 21;\n\n//events\nconst event_new_game = 0,\n\tevent_reset_game = 1,\n\tevent_window_resized = 2,\n\n\tevent_player_generated = 3,\n\tevent_down_level = 4,\n\tevent_up_level = 5,\n\tevent_new_level = 6,\n\tevent_level_loaded = 7,\n\tevent_entities_loaded = 8,\n\tevent_begin_level = 9,\n\n\tevent_player_moved = 10,\n\tevent_entity_moved = 11,\n\tevent_player_start_sprinting = 12,\n\tevent_player_stop_sprinting = 13,\n\tevent_open_door = 14,\n\n\tevent_successful_action = 20,\n\tevent_failed_action = 21,\n\n\tevent_new_animation = 30,\n\tevent_hitstun = 31,\n\n\tevent_begin_combat = 40,\n\tevent_end_combat = 41,\n\tevent_entity_attacked = 42,\n\n\tevent_player_take_damage = 45,\n\n\tevent_entity_spawned = 50,\n\tevent_spawn_enemy_close = 51,\n\n\tevent_title_screen = 999,\n\tevent_game_over = 1000\n\n\n// Entity constants\nconst class_warrior = 0,\n\tclass_mage = 1,\n\tclass_rogue = 2,\n\tentity_skeleton = 3,\n\tboss_blob = 4\n\n;\n\nconst entity_string_to_constant = [];\nentity_string_to_constant['warrior'] = class_warrior;\nentity_string_to_constant['mage'] = class_mage;\nentity_string_to_constant['rogue'] = class_rogue;\nentity_string_to_constant['skeleton'] = entity_skeleton;\nentity_string_to_constant['blob'] = boss_blob;\n\n\n// Animations\nconst animation_idle = 0,\n\n\tanimation_move_up = 1,\n\tanimation_move_right = 2,\n\tanimation_move_down = 3,\n\tanimation_move_left = 4\n;\n\nconst animation_strings_to_constants = [];\n\nanimation_strings_to_constants['animation_idle'] = animation_idle;\n\nanimation_strings_to_constants['animation_move_up'] = animation_move_up;\nanimation_strings_to_constants['animation_move_right'] = animation_move_right;\nanimation_strings_to_constants['animation_move_down'] = animation_move_down;\nanimation_strings_to_constants['animation_move_left'] = animation_move_left;\n\n// Actions\nconst action_none = 0,\n\n\taction_move = 10,\n\taction_move_up = 11,\n\taction_move_right = 12,\n\taction_move_down = 13,\n\taction_move_left = 14,\n\n\taction_ability_one = 20,\n\taction_ability_two = 21,\n\taction_ability_three = 22\n;\n\nconst action_string_to_constant = [];\naction_string_to_constant['action_none'] = action_none;\n\naction_string_to_constant['action_move_up'] = action_move_up;\naction_string_to_constant['action_move_right'] = action_move_right;\naction_string_to_constant['action_move_down'] = action_move_down;\naction_string_to_constant['action_move_left'] = action_move_left;\n\naction_string_to_constant['action_ability_one'] = action_ability_one;\naction_string_to_constant['action_ability_two'] = action_ability_two;\naction_string_to_constant['action_ability_three'] = action_ability_three;\n\nconst keyCode_to_action = [];\nkeyCode_to_action[87] = action_move_up;  \t\t//w\nkeyCode_to_action[68] = action_move_right;  \t//d\nkeyCode_to_action[83] = action_move_down; \t\t//s\nkeyCode_to_action[65] = action_move_left; \t\t//a\n\nkeyCode_to_action[49] = action_ability_one;    \t//1\nkeyCode_to_action[50] = action_ability_two;    \t//2\nkeyCode_to_action[51] = action_ability_three; \t//3\n\nkeyCode_to_action[38] = action_move_up;\nkeyCode_to_action[39] = action_move_right\nkeyCode_to_action[40] = action_move_down;\nkeyCode_to_action[37] = action_move_left;\n\nconst action_to_priority = [];\naction_to_priority[action_none] = 0;\n\naction_to_priority[action_move_up] = 3;\naction_to_priority[action_move_left] = 3;\naction_to_priority[action_move_down] = 3;\naction_to_priority[action_move_right] = 3;\n\naction_to_priority[action_ability_one] = 4;\naction_to_priority[action_ability_two] = 4;\naction_to_priority[action_ability_three] = 4;\n\nconst action_to_direction = [];\naction_to_direction[action_move_up] = direction_up;\naction_to_direction[action_move_right] = direction_right;\naction_to_direction[action_move_down] = direction_down;\naction_to_direction[action_move_left] = direction_left;\n\n// const direction_to_movement = [];\n// direction_to_movement[direction_up] = action_move_up;\n// direction_to_movement[direction_right] = action_move_right;\n// direction_to_movement[direction_down] = action_move_down;\n// direction_to_movement[direction_left] = action_move_left;\n\nconst action_to_animation = [];\n\naction_to_animation[action_none] = animation_idle;\n\naction_to_animation[action_move_up] = animation_move_up;\naction_to_animation[action_move_right] = animation_move_right;\naction_to_animation[action_move_down] = animation_move_down;\naction_to_animation[action_move_left] = animation_move_left;\n\n// Ability types\nconst ability_type_melee = 0,\n\tability_type_aoe = 1,\n\tability_type_aoe_ranged = 2,\n\tability_type_skillshot = 3,\n\tability_type_smite = 4\n;\n\nconst ability_type_string_to_constant = [];\nability_type_string_to_constant['melee'] = ability_type_melee;\nability_type_string_to_constant['aoe'] = ability_type_aoe;\nability_type_string_to_constant['aoe_ranged'] = ability_type_aoe_ranged;\nability_type_string_to_constant['skillshot'] = ability_type_skillshot;\nability_type_string_to_constant['smite'] = ability_type_smite;\n\n\n// Abilities\nconst ability_slash = 0,\n\tability_spin_attack = 1,\n\tability_judgement_day = 2\n\n// ability_spin_attack = 3,\n// ability_spin_attack = 4,\n// ability_spin_attack = 5,\n// ability_spin_attack = 6,\n// ability_spin_attack = 7,\n// ability_spin_attack = 8,\n\n;\n\nconst ability_string_to_constant = [];\nability_string_to_constant['Slash'] = ability_slash;\nability_string_to_constant['Spin Attack'] = ability_spin_attack;\nability_string_to_constant['Judgement Day'] = ability_judgement_day;\n","class System {\n\n\tconstructor(componentRequirements) {\n\t\tthis.objects = [];\n\t\tthis.componentRequirements = componentRequirements;\n\t}\n\n\tinit(engine) { }\n\n\trun(engine) { }\n\n\taddObject(object) {\n\t\tif(this.componentRequirements.length > 0 && !this.objects.includes(object) && Utility.checkComponents(object, this.componentRequirements)) {\n\t\t\tthis.objects.push(object);\n\t\t}\n\t}\n\n\tremoveObject(object) {\n\t\tif(this.objects.indexOf(object) !== -1) {\n\t\t\tthis.objects.splice(this.objects.indexOf(object), 1);\n\t\t}\n\t}\n\n\tclearObjects() {\n\t\tthis.objects = [];\n\t}\n\n\thandleEvent(engine, eventID, data) { }\n}\n","class PoppsEngine {\n\n\tconstructor(data) {\n\n\t\tconst config = data.config;\n\n\t\tconst room_pool = data.room_pool;\n\t\tconst stair_room_pool = data.stair_room_pool;\n\n\t\tconst images = data.images.textures;\n\t\tconst ui = data.images.ui;\n\n\t\tconst player_data = data.player_data;\n\t\tconst entity_data = data.entity_data;\n\t\tconst boss_data = data.boss_data;\n\n\t\tthis.systems = [];\n\t\tthis.InputSystem = new InputSystem();\n\t\tthis.DisplaySystem = new DisplaySystem(config.display, images);\n\t\tthis.VisionSystem = new VisionSystem(config.vision);\n\t\tthis.LightSystem = new LightSystem(config.light);\n\t\tthis.ActionSystem = new ActionSystem();\n\t\tthis.MovementSystem = new MovementSystem();\n\t\tthis.LevelSystem = new LevelSystem(config.level, room_pool, stair_room_pool);\n\t\tthis.EntitySystem = new EntitySystem(config.entities, player_data, entity_data, boss_data);\n\t\tthis.AnimationSystem = new AnimationSystem(config.animation);\n\t\tthis.CombatSystem = new CombatSystem();\n\t\tthis.HealthSystem = new HealthSystem(config.health);\n\t\tthis.AISystem = new AISystem(config.ai);\n\t\tthis.AbilitySystem = new AbilitySystem(config.abilities);\n\t\tthis.SprintSystem = new SprintSystem(config.sprint);\n\n\t\tthis.systems.push(this.InputSystem);\n\t\tthis.systems.push(this.DisplaySystem);\n\t\tthis.systems.push(this.VisionSystem);\n\t\tthis.systems.push(this.LightSystem);\n\t\tthis.systems.push(this.ActionSystem);\n\t\tthis.systems.push(this.MovementSystem);\n\t\tthis.systems.push(this.LevelSystem);\n\t\tthis.systems.push(this.EntitySystem);\n\t\tthis.systems.push(this.AnimationSystem);\n\t\tthis.systems.push(this.CombatSystem);\n\t\tthis.systems.push(this.HealthSystem);\n\t\tthis.systems.push(this.AISystem);\n\t\tthis.systems.push(this.SprintSystem);\n\t\tthis.systems.push(this.AbilitySystem);\n\n\t\tthis.UISystem = new UISystem(config.ui, data.images.ui);\n\t\tthis.systems.push(this.UISystem);\n\n\n\t\tthis.init();\n\n\t\tif(TITLE_SCREEN) {\n\t\t\tthis.sendEvent(event_title_screen);\n\t\t}\n\t\telse {\n\t\t\tthis.sendEvent(event_new_game);\n\t\t}\n\t}\n\n\tinit() {\n\t\tthis.clearObjects();\n\t\tthis.UIOnly = true;\n\t\tthis.FOCUSED = true;\n\t\tthis.events = [];\n\n\t\tthis.Dungeon = {\n\t\t\tdepth: 0,\n\t\t\tplayer: undefined,\n\t\t\tmap: undefined,\n\t\t\tlevels: [],\n\t\t\tentities: []\n\t\t};\n\n\t\tfor(let system of this.systems) {\n\t\t\tsystem.init(this);\n\t\t}\n\n\t\twindow.addEventListener('resize', this.sendEvent(event_window_resized));\n\t\tlet self = this;\n\t\twindow.addEventListener(\"focus\", function () {\n\t\t\tself.tick();\n\t\t});\n\t\twindow.addEventListener(\"blur\", function () {\n\t\t\twindow.cancelAnimationFrame(self.requestID);\n\t\t});\n\t\tthis.tick();\n\t}\n\n\tpause() {\n\t\tthis.UIOnly = true;\n\t}\n\n\tresume() {\n\t\tthis.UIOnly = false;\n\t}\n\n\ttick() {\n\t\tthis.handleEvents(this.events);\n\t\tif(this.UIOnly) {\n\t\t\tthis.UISystem.run(this);\n\t\t}\n\t\telse{\n\t\t\tfor(let s of this.systems) {\n\t\t\t\ts.run(this);\n\t\t\t}\n\t\t}\n\t\tthis.requestID = window.requestAnimationFrame(() => this.tick());\n\t}\n\n\tsendEvent(e, data = undefined, ticks = 0) {\n\t\tif(ticks == 0) {\n\t\t\tthis.runEvent([e, data]);\n\t\t}\n\t\telse {\n\t\t\tthis.events.push([e, data, ticks]);\n\t\t}\n\t}\n\n\thandleEvents(events) {\n\t\tfor(let i = events.length - 1; i >= 0; i--) {\n\t\t\tif(events[i][2] > 0) {\n\t\t\t\tevents[i][2]--;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthis.runEvent(events[i]);\n\t\t\t\tevents.splice(i, 1);\n\t\t\t}\n\t\t}\n\t}\n\n\trunEvent(e) {\n\t\tif(DEBUG_MODE) {\n\t\t\tthis.printEvent(e);\n\t\t}\n\t\tthis.handleEvent(e[0], e[1]);\n\t\tfor(let s of this.systems) {\n\t\t\ts.handleEvent(this, e[0], e[1]);\n\t\t}\n\t}\n\n\thandleEvent(event, data) {\n\t\tswitch(event) {\n\t\t\tcase event_new_game:\n\t\t\t\tthis.Dungeon.entities.push([]);\n\t\t\t\tthis.EntitySystem.generatePlayer(this);\n\t\t\t\tthis.LevelSystem.generateLevel(this, this.Dungeon.depth);\n\t\t\t\tthis.EntitySystem.generateEntities(this, this.Dungeon.levels[this.Dungeon.depth], this.Dungeon.depth);\n\t\t\t\tthis.LightSystem.generateTorches(this, this.Dungeon.levels[this.Dungeon.depth].map.map, this.Dungeon.levels[this.Dungeon.depth].rooms);\n\t\t\t\tthis.clearObjects();\n\t\t\t\tthis.loadObjects(this.Dungeon.depth);\n\t\t\t\tthis.sendEvent(event_begin_level, this.Dungeon.levels[this.Dungeon.depth], LOADING_SCREEN_TIME);\n\t\t\t\tthis.resume();\n\t\t\t\tbreak;\n\t\t\tcase event_reset_game:\n\t\t\t\tthis.init();\n\t\t\t\tbreak;\n\t\t\tcase event_game_over:\n\t\t\t\tthis.pause();\n\t\t\t\tbreak;\n\t\t\tcase event_down_level:\n\t\t\t\tthis.Dungeon.depth++;\n\t\t\t\tif(this.Dungeon.depth == this.Dungeon.levels.length) {\n\t\t\t\t\tthis.Dungeon.entities.push([]);\n\t\t\t\t\tthis.LevelSystem.generateLevel(this, this.Dungeon.depth);\n\t\t\t\t\tthis.EntitySystem.generateEntities(this, this.Dungeon.levels[this.Dungeon.depth], this.Dungeon.depth);\n\t\t\t\t\tthis.LightSystem.generateTorches(this, this.Dungeon.levels[this.Dungeon.depth].map.map, this.Dungeon.levels[this.Dungeon.depth].rooms);\n\t\t\t\t}\n\t\t\t\tthis.clearObjects();\n\t\t\t\tthis.loadObjects(this.Dungeon.depth);\n\t\t\t\tthis.sendEvent(event_begin_level, this.Dungeon.levels[this.Dungeon.depth], LOADING_SCREEN_TIME);\n\t\t\t\tbreak;\n\t\t\tcase event_up_level:\n\t\t\t\tthis.Dungeon.depth--;\n\t\t\t\tthis.clearObjects();\n\t\t\t\tthis.loadObjects(this.Dungeon.depth);\n\t\t\t\tthis.sendEvent(event_begin_level, this.Dungeon.levels[this.Dungeon.depth], LOADING_SCREEN_TIME);\n\t\t\t\tbreak;\n\t\t\tcase event_new_level:\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\taddObject(object) {\n\t\tfor(let s of this.systems) {\n\t\t\ts.addObject(object);\n\t\t}\n\n\t\tif(object instanceof Player) {\n\t\t\tthis.Dungeon.player = object;\n\t\t}\n\n\t\tif(object instanceof Level) {\n\t\t\tthis.Dungeon.levels[this.Dungeon.depth] = object;\n\t\t\tfor (let i = 0; i < this.Dungeon.levels[this.Dungeon.depth].map.map.length; i++) {\n\t\t\t\tfor (let j = 0; j < this.Dungeon.levels[this.Dungeon.depth].map.map.length; j++) {\n\t\t\t\t\tthis.addObject(this.Dungeon.levels[this.Dungeon.depth].map.map[i][j]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif(object instanceof Entity) {\n\t\t\tif(!this.Dungeon.entities[this.Dungeon.depth].includes(object)) {\n\t\t\t\tthis.Dungeon.entities[this.Dungeon.depth].push(object);\n\t\t\t}\n\t\t}\n\t}\n\n\tremoveObject(object) {\n\t\tfor(let s of this.systems) {\n\t\t\ts.removeObject(object);\n\t\t}\n\n\t\tif(object instanceof Entity) {\n\t\t\tif(this.Dungeon.entities[object.depth.depth].includes(object)) {\n\t\t\t\tthis.Dungeon.entities[object.depth.depth].splice(this.Dungeon.entities[object.depth.depth].indexOf(object), 1);\n\t\t\t}\n\t\t}\n\t}\n\n\tclearObjects() {\n\t\tfor(let s of this.systems) {\n\t\t\ts.clearObjects();\n\t\t}\n\t}\n\n\tloadObjects(depth) {\n\t\tfor (let i = 0; i < this.Dungeon.levels[depth].map.map.length; i++) {\n\t\t\tfor (let j = 0; j < this.Dungeon.levels[depth].map.map.length; j++) {\n\t\t\t\tthis.addObject(this.Dungeon.levels[depth].map.map[i][j]);\n\t\t\t}\n\t\t}\n\n\t\tthis.sendEvent(event_level_loaded, this.Dungeon.levels[depth]);\n\n\t\tfor(let e of this.Dungeon.entities[depth]) {\n\t\t\tthis.addObject(e);\n\t\t}\n\n\t\tthis.sendEvent(event_entities_loaded);\n\n\t\tthis.addObject(this.Dungeon.player);\n\t}\n\n\tprintEvent(e) {\n\t\tfor(key in window) {\n\t\t\tif(e[0] == window[key] && key.includes('event_')) {\n\t\t\t\tconsole.log(key);\n\t\t\t}\n\t\t}\n\t}\n\n\tgetDepth() {\n\t\treturn this.Dungeon.depth;\n\t}\n\n\tgetPlayer() {\n\t\treturn this.Dungeon.player;\n\t}\n\n\tgetMap() {\n\t\treturn this.Dungeon.levels[this.Dungeon.depth].map.map;\n\t}\n\n\tgetLevel() {\n\t\treturn this.Dungeon.levels[this.Dungeon.depth];\n\t}\n\n\tgetEntities() {\n\t\treturn this.Dungeon.entities[this.Dungeon.depth];\n\t}\n\n}\n","class Utility {\n\n\tstatic collision(o1, o2) {\n\t\treturn !(o1.top >= o2.bottom || o1.right <= o2.left || o1.bottom <= o2.top || o1.left >= o2.right);\n\t}\n\n\tstatic checkComponents(object, requirements) {\n\t\tfor(var i = 0; i < requirements.length; i++) {\n\t\t\tif(object.components.indexOf(requirements[i]) === -1)\n\t\t\t\treturn false;\n\t\t}\n\t\treturn true;\n\t}\n\n\tstatic entityActionSuccessful(entity) {\n\t\tentity.actions.busy = action_length[entity.actions.currentAction];\n\n\t\tentity.animation.newAnimation = true;\n\t\tentity.animation.animation = action_to_animation[entity.actions.currentAction];\n\n\t\tentity.actions.failedAction = action_none;\n\t\tentity.actions.lastAction = entity.actions.currentAction;\n\t\tentity.actions.currentAction = action_none;\n\t}\n\n\tstatic entityActionFailed(entity) {\n\t\tentity.actions.lastAction = action_none;\n\t\tentity.actions.failedAction = entity.actions.currentAction;\n\t\tentity.actions.currentAction = action_none;\n\t}\n\n\tstatic entityWithinRange(e1, e2, dist) {\n\t\treturn abs(e1.position.x - e2.position.x) < dist && abs(e1.position.y - e2.position.y) < dist;\n\t}\n\n\tstatic positionInRange(p1, p2, dist) {\n\t\treturn abs(p1.x - p2.x) < dist && abs(p1.y - p2.y) < dist;\n\t}\n\n\tstatic entityDistance(e1, e2) {\n\t\tif(e1.collision.width == 1 && e1.collision.height == 1 && e2.collision.width == 1 && e2.collision.height == 1) {\n\t\t\treturn Utility.distance(e1.position, e2.position);\n\t\t}\n\t\telse {\n\t\t\tlet xDist = 0;\n\t\t\tif(e1.collision.left >= e2.collision.right) {\n\t\t\t\txDist = abs(e1.collision.left - (e2.collision.right - 1));\n\t\t\t}\n\t\t\telse if(e1.collision.right <= e2.collision.left) {\n\t\t\t\txDist = abs((e1.collision.right - 1) - e2.collision.left);\n\t\t\t}\n\t\t\tlet yDist = 0;\n\t\t\tif(e1.collision.top >= e2.collision.bottom) {\n\t\t\t\tyDist = abs(e1.collision.top - (e2.collision.bottom - 1));\n\t\t\t}\n\t\t\telse if(e1.collision.bottom <= e2.collision.top) {\n\t\t\t\tyDist = abs((e1.collision.bottom - 1) - e2.collision.top);\n\t\t\t}\n\t\t\treturn xDist + yDist;\n\t\t}\n\t}\n\n\tstatic distance(p1, p2) {\n\t\treturn abs(p1.x - p2.x) + abs(p1.y - p2.y);\n\t}\n\n\tstatic getDirectionToEntity(e1, e2) {\n\t\tif(e1.position.y > e2.position.y) { return direction_up; }\n\t\tif(e1.position.x < e2.position.x) { return direction_right;}\n\t\tif(e1.position.y < e2.position.y) { return direction_down; }\n\t\tif(e1.position.x > e2.position.x) { return direction_left; }\n\t}\n\n\tstatic shortestPath(map, startPosition, endPosition) {\n\t\t// let nodeMap = Utility.convertMapToNodes(map);\n\t\t// let searching = [];\n\n\t\t// let start = nodeMap[startPosition.x][startPosition.y];\n\t\t// let end = nodeMap[endPosition.x][endPosition.y];\n\n\t\t// searching.push(start);\n\t\t// start.distFromStart = 0;\n\t\t// start.finalCost = Utility.distance(startPosition, endPosition);\n\t\t// // start.cameFrom = undefined;\n\n\t\t// while (searching.length > 0) {\n\t\t// \tlet current = searching[0];\n\t\t// \tfor (let node of searching) {\n\t\t// \t\tif (node.finalCost < current.finalCost) {\n\t\t// \t\t\tcurrent = node;\n\t\t// \t\t}\n\t\t// \t}\n\n\t\t// \tif(current == end) {\n\t\t// \t\treturn makePath(current);\n\t\t// \t}\n\n\t\t// \tsearching.splice(searching.indexOf(current), 1);\n\t\t// \tcurrent.searched = true;\n\n\t\t// \tlet currentNeighbors = getNeighbors(board, current);\n\t\t// \tfor(let n of currentNeighbors) {\n\t\t// \t\tif (!n.searched) {\n\t\t// \t\t\tlet estimatedDistFromStart = Utility.distance();\n\n\t\t// \t\t\tif (!searching.includes(n)) {\n\t\t// \t\t\t\tsearching.push(n);\n\t\t// \t\t\t}\n\t\t// \t\t\telse if (estimatedDistFromStart >= distFromStart[n]) {\n\t\t// \t\t\t\tcontinue;\n\t\t// \t\t\t}\n\n\t\t// \t\t\tcameFrom[Utility.getSquareCode(n.position.x, n.position.y)] = Utility.getSquareCode(current.position.x, current.position.y);\n\t\t// \t\t\tdistFromStart[n] = estimatedDistFromStart;\n\t\t// \t\t\tfinalCost[n] = distFromStart[n] + squareDistance(start, end);\n\t\t// \t\t}\n\t\t// \t}\n\t\t// }\n\t\t// return false;\n\t}\n\n\tstatic convertMapToNodes(map) {\n\t\tlet nodeMap = new Array(map.length);\n\t\tfor(let i = 0; i < map.length; i++) {\n\t\t\tnodeMap[i] = new Array(map.length);\n\t\t\tfor(let j = 0; j < map.length; j++) {\n\t\t\t\tnodeMap[i][j] = {\n\t\t\t\t\t'searched': false,\n\t\t\t\t\t'cameFrom': undefined,\n\t\t\t\t\t'distFromStart': 10000,\n\t\t\t\t\t'finalCost': 10000\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn nodeMap;\n\t}\n\n\tstatic getCollisionInFrontOf(entity) {\n\t\treturn Utility.getCollisionInDirection(entity, entity.direction.direction);\n\t}\n\n\tstatic getCollisionInDirection(entity, direction) {\n\t\tswitch(direction) {\n\t\t\tcase direction_up:\n\t\t\t\treturn new CollisionComponent(entity.collision.left, entity.collision.top - 1, entity.collision.width, 1);\n\t\t\tcase direction_right:\n\t\t\t\treturn new CollisionComponent(entity.collision.right, entity.collision.top, 1, entity.collision.height);\n\t\t\tcase direction_down:\n\t\t\t\treturn new CollisionComponent(entity.collision.left, entity.collision.bottom, entity.collision.width, 1);\n\t\t\tcase direction_left:\n\t\t\t\treturn new CollisionComponent(entity.collision.left - 1, entity.collision.top, 1, entity.collision.height);\n\t\t\tdefault:\n\t\t\t\tconsole.log(\"Cannot determine direction\");\n\t\t\t\treturn;\n\t\t}\n\t}\n\n\tstatic entityAdjacent(entity, otherEntity) {\n\t\tlet c1 = entity.collision, c2 = otherEntity.collision;\n\t\tif (Utility.collision(Utility.getCollisionInDirection(entity, direction_up), c2)) {\n\t\t\treturn direction_up;\n\t\t}\n\t\telse if (Utility.collision(Utility.getCollisionInDirection(entity, direction_right), c2)) {\n\t\t\treturn direction_right;\n\t\t}\n\t\telse if (Utility.collision(Utility.getCollisionInDirection(entity, direction_down), c2)) {\n\t\t\treturn direction_down;\n\t\t}\n\t\telse if (Utility.collision(Utility.getCollisionInDirection(entity, direction_left), c2)) {\n\t\t\treturn direction_left;\n\t\t}\n\t\telse {\n\t\t\treturn -1;\n\t\t}\n\t}\n\n\tstatic getSquareNeighbors(x, y, map) {\n\t\tneighbors = [];\n\t\tif(x > 0) {\n\t\t\tneighbors.push(map[x - 1][y]);\n\t\t}\n\t\tif(y > 0) {\n\t\t\tneighbors.push(map[x][y - 1]);\n\t\t}\n\t\tif(x < map.length - 1) {\n\t\t\tneighbors.push(map[x + 1][y]);\n\t\t}\n\t\tif(y < map.length - 1) {\n\t\t\tneighbors.push(map[x][y + 1]);\n\t\t}\n\t\treturn neighbors;\n\t}\n\n\tstatic findMobPath(board, mob, player) {\n\t\treturn findPath(board, board[mob.position.x][mob.position.y], board[player.position.x][player.position.y]);\n\t}\n\n\tstatic walkable(x, y, map, entity, objects){\n\t\treturn Utility.positionInBounds(new PositionComponent(x, y), map.length) && Utility.squareIsWalkable(map[x][y], entity) && !Utility.squareIsOccupied(x, y, entity, objects);\n\t}\n\n\tstatic positionOnScreen(x, y, w, h) {\n\t\treturn x > -w && x < width + w && y > -h && y < height + h;\n\t}\n\n\tstatic positionInBounds(position, size){\n\t\treturn position.x >= 0 && position.x < size && position.y >= 0 && position.y < size;\n\t}\n\n\tstatic squareInBounds(square, size) {\n\t\treturn square.position.x >= 0 && square.position.x < size && square.position.y >= 0 && square.position.y < size;\n\t}\n\n\tstatic getNeighbors(square, map) {\n\t\tlet neighbors = new Array(4);\n\t\tif(Utility.positionInBounds(new PositionComponent(square.position.x, square.position.y - 1), map.length)) {\n\t\t\tneighbors[0] = (map[square.position.x][square.position.y - 1]);\n\t\t}\n\t\tif(Utility.positionInBounds(new PositionComponent(square.position.x + 1, square.position.y), map.length)) {\n\t\t\tneighbors[1] = (map[square.position.x + 1][square.position.y]);\n\t\t}\n\t\tif(Utility.positionInBounds(new PositionComponent(square.position.x, square.position.y + 1), map.length)) {\n\t\t\tneighbors[2] = (map[square.position.x][square.position.y + 1]);\n\t\t}\n\t\tif(Utility.positionInBounds(new PositionComponent(square.position.x - 1, square.position.y), map.length)) {\n\t\t\tneighbors[3] = (map[square.position.x - 1][square.position.y]);\n\t\t}\n\t\treturn neighbors;\n\t}\n\n\tstatic getCornerNeighbors(square, map) {\n\t\tlet neighbors = new Array(4);\n\t\tif(Utility.positionInBounds(new PositionComponent(square.position.x - 1, square.position.y - 1), map.length)) {\n\t\t\tneighbors[0] = (map[square.position.x - 1][square.position.y - 1]);\n\t\t}\n\t\tif(Utility.positionInBounds(new PositionComponent(square.position.x + 1, square.position.y - 1), map.length)) {\n\t\t\tneighbors[1] = (map[square.position.x + 1][square.position.y - 1]);\n\t\t}\n\t\tif(Utility.positionInBounds(new PositionComponent(square.position.x - 1, square.position.y + 1), map.length)) {\n\t\t\tneighbors[2] = (map[square.position.x - 1][square.position.y + 1]);\n\t\t}\n\t\tif(Utility.positionInBounds(new PositionComponent(square.position.x - 1, square.position.y + 1), map.length)) {\n\t\t\tneighbors[3] = (map[square.position.x + 1][square.position.y + 1]);\n\t\t}\n\t\treturn neighbors;\n\t}\n\n\tstatic squareIsWalkable(square, entity){\n\t\treturn (entity instanceof Player) ? Utility.playerWalkable(square) : Utility.mobWalkable(square);\n\t}\n\n\tstatic playerWalkable(square) {\n\t\treturn (!square.components.includes(component_collision) || square instanceof DoorSquare || square instanceof StairUpSquare || square instanceof StairDownSquare);\n\t}\n\n\tstatic mobWalkable(square) {\n\t\treturn !square.components.includes(component_collision);\n\t}\n\n\tstatic squareIsOccupied(x, y, entity, objects) {\n\t\tfor(let o of objects) {\n\t\t\tif(entity != o && o.components.includes(component_collision)) {\n\t\t\t\tif(Utility.collision(new CollisionComponent(x, y, 1), o.collision)) {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\n\tstatic directionToPosition(direction) {\n\t\tswitch(direction) {\n\t\t\tcase direction_up:\n\t\t\t\treturn new PositionComponent(0, -1);\n\t\t\tcase direction_right:\n\t\t\t\treturn new PositionComponent(1, 0);\n\t\t\tcase direction_down:\n\t\t\t\treturn new PositionComponent(0, 1);\n\t\t\tcase direction_left:\n\t\t\t\treturn new PositionComponent(-1, 0);\n\t\t}\n\t}\n\n\n\tstatic isMovementAction(action) {\n\t\treturn action > action_move && action <= action_move_left;\n\t}\n\n\tstatic convertMovementToSprint(action) {\n\t\tswitch(action) {\n\t\t\tcase action_move_up:\n\t\t\t\treturn action_sprint_up;\n\t\t\tcase action_move_right:\n\t\t\t\treturn action_sprint_right;\n\t\t\tcase action_move_down:\n\t\t\t\treturn action_sprint_down;\n\t\t\tcase action_move_left:\n\t\t\t\treturn action_sprint_left;\n\t\t}\n\t}\n\n\tstatic convertSprintToMovement(action) {\n\t\tswitch(action) {\n\t\t\tcase action_sprint_up:\n\t\t\t\treturn action_move_up;\n\t\t\tcase action_sprint_right:\n\t\t\t\treturn action_move_right;\n\t\t\tcase action_sprint_down:\n\t\t\t\treturn action_move_down;\n\t\t\tcase action_sprint_left:\n\t\t\t\treturn action_move_left;\n\t\t}\n\t}\n\n\tstatic convertAnimationsFromConfig(animations) {\n\t\tlet animationsArray = [];\n\t\tfor(let a in animations) {\n\t\t\tanimationsArray[animation_strings_to_constants[a]] = animations[a];\n\t\t}\n\t\treturn animationsArray;\n\t}\n\n\tstatic convertActionsFromConfig(actions) {\n\t\tlet actionsArray = [];\n\t\tfor(let i = 0; i < actions.length; i++) {\n\t\t\tactionsArray[i] = action_strings_to_constants[actions[i]];\n\t\t}\n\t\treturn actionsArray;\n\t}\n\n\tstatic getSquareCode(x, y, size) {\n\t\treturn x + (y * size);\n\t}\n\n\tstatic getSquareFromCode(map, code) {\n\t\treturn map[code % map.length][floor(code / map.length)];\n\t}\n}\n\nconst LARGE_VALUE = 10000;\n\nfunction findPath(board, start, end) {\n\n\tlet searched = [];\n\tlet searching = [];\n\tlet cameFrom = {};\n\tlet distFromStart = {};\n\tlet finalCost = {};\n\n\tfor (let i = 0; i < board.length; i++) {\n\t\tfor (let j = 0; j < board[0].length; j++) {\n\t\t\tdistFromStart[board[i][j]] = LARGE_VALUE;\n\t\t\tfinalCost[board[i][j]] = LARGE_VALUE;\n\t\t}\n\t}\n\n\tsearching.push(start);\n\tdistFromStart[start] = 0;\n\tfinalCost[start] = squareDistance(start, end);\n\tcameFrom[Utility.getSquareCode(start.position.x, start.position.y)] = -1;\n\n\twhile (searching.length > 0) {\n\t\tlet current = searching[0];\n\t\tfor (let s of searching) {\n\t\t\tif (finalCost[s] < finalCost[current]) current = s;\n\t\t}\n\t\tif(current == end) {\n\t\t\treturn makePath(board, cameFrom, current);\n\t\t}\n\n\t\tsearching.splice(searching.indexOf(current), 1);\n\t\tsearched.push(current);\n\n\t\tlet currentNeighbors = getNeighbors(board, current);\n\t\tfor(let n of currentNeighbors) {\n\t\t\tif (searched.includes(n)) {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tlet estimatedDistFromStart = distFromStart[current] + 1;\n\n\t\t\t\tif (!searching.includes(n)) {\n\t\t\t\t\tsearching.push(n);\n\t\t\t\t}\n\t\t\t\telse if (estimatedDistFromStart >= distFromStart[n]) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tcameFrom[Utility.getSquareCode(n.position.x, n.position.y)] = Utility.getSquareCode(current.position.x, current.position.y);\n\t\t\t\tdistFromStart[n] = estimatedDistFromStart;\n\t\t\t\tfinalCost[n] = distFromStart[n] + squareDistance(start, end);\n\t\t\t}\n\t\t}\n\t}\n\treturn false;\n}\n\nfunction squareDistance(start, end) {\n\treturn abs(start.position.x - end.position.x) + abs(start.position.y - end.position.y);\n}\n\nfunction makePath(board, cameFrom, last) {\n\tlet path = [];\n\tlet current = Utility.getSquareCode(last.position.x, last.position.y);\n\twhile(cameFrom[current] > 0) {\n\t\tpath.unshift(Utility.getSquareFromCode(board, current));\n\t\tcurrent = cameFrom[current];\n\t}\n\tpath.unshift(Utility.getSquareFromCode(board, current));\n\treturn path;\n}\n\nfunction getNeighbors(board, square) {\n\tneighbors = [];\n\tif (square.position.x > 0 && walkable(entity_mob, board[square.position.x - 1][square.position.y])) {\n\t\tneighbors.push(board[square.position.x - 1][square.position.y]);\n\t}\n\tif (square.position.y > 0 && walkable(entity_mob, board[square.position.x][square.position.y - 1])) {\n\t\tneighbors.push(board[square.position.x][square.position.y - 1]);\n\t}\n\tif (square.position.x < board.length - 1 && walkable(entity_mob, board[square.position.x + 1][square.position.y])) {\n\t\tneighbors.push(board[square.position.x + 1][square.position.y]);\n\t}\n\tif (square.position.y < board.length - 1 && walkable(entity_mob, board[square.position.x][square.position.y + 1])) {\n\t\tneighbors.push(board[square.position.x][square.position.y + 1]);\n\t}\n\t// if (square.position.x > 0 && board[square.position.x - 1][square.position.y].walkable(board, PATHFINDING)) neighbors.push(board[square.position.x - 1][square.position.y]);\n\t// if (square.position.y > 0 && board[square.position.x][square.position.y - 1].walkable(board, PATHFINDING)) neighbors.push(board[square.position.x][square.position.y - 1]);\n\t// if (square.position.x < board.length - 1 && board[square.position.x + 1][square.position.y].walkable(board, PATHFINDING)) neighbors.push(board[square.position.x + 1][square.position.y]);\n\t// if (square.position.y < board.length - 1 && board[square.position.x][square.position.y + 1].walkable(board, PATHFINDING)) neighbors.push(board[square.position.x][square.position.y + 1]);\n\treturn neighbors;\n}\n","function setup() {\n\tcreateCanvas(windowWidth, windowHeight, \"game\");\n\tload();\n}\n\nfunction load() {\n\n\tlet config = loadConfig();\n\tlet images = loadImages(config.textures);\n\tlet room_pool = loadRoomPools();\n\tlet player_data = processEntityData(loadJSON('/data/player_data.json'));\n\tlet entity_data = processEntityData(loadJSON('/data/entity_data.json'));\n\tlet boss_data = processEntityData(loadJSON('/data/boss_data.json'));\n\n\t// let music = loadMusic();\n\t// let sounds = loadSounds();\n\n\tlet data = {\n\t\t'config': config,\n\t\t'room_pool': room_pool[0],\n\t\t'stair_room_pool': room_pool[1],\n\t\t'images': images,\n\t\t'player_data': player_data,\n\t\t'entity_data': entity_data,\n\t\t'boss_data': boss_data\n\t\t// 'music': music,\n\t\t// 'sounds': sounds\n\t};\n\n\tnew PoppsEngine(data);\n\n\t// document.addEventListener('contextmenu', function () { });\n}\n\nfunction processEntityData(entityData) {\n\tlet newEntityData = [];\n\tfor(let e in entityData) {\n\n\t\tlet entityConstant = entity_string_to_constant[e];\n\t\tnewEntityData[entityConstant] = entityData[e];\n\n\t\tlet processedActions = [];\n\t\tfor(let action of entityData[e].actions) {\n\t\t\tlet a = action_string_to_constant[action.action];\n\t\t\tprocessedActions[a] = {\n\t\t\t\taction: a,\n\t\t\t\tcooldown: action.cooldown,\n\t\t\t\ttime: action.time\n\t\t\t};\n\t\t}\n\n\t\tlet processedAbilities = [];\n\t\tlet i = 0;\n\t\tfor(let ability of entityData[e].abilities) {\n\t\t\tlet a = ability_type_string_to_constant[ability.ability_type];\n\t\t\tprocessedAbilities[i] = {\n\t\t\t\tabilityName: ability.ability_name,\n\t\t\t\tabilityType: a,\n\t\t\t\tcooldown: ability.cooldown,\n\t\t\t\ttime: ability.time\n\t\t\t};\n\t\t\ti++;\n\t\t}\n\n\t\tnewEntityData[entityConstant].actions = processedActions;\n\t\tnewEntityData[entityConstant].abilities = processedAbilities;\n\n\t}\n\treturn newEntityData;\n}\n\nfunction loadConfig(){\n\treturn loadJSON('/config/config.json');\n}\n\nfunction loadRoomPools(){\n\treturn loadJSON('/config/roompool.json');\n}\n\nfunction loadImages(textureConfig){\n\tlet images = {}\n\timages.textures = loadTextures(textureConfig);\n\timages.ui = loadUI();\n\treturn images;\n}\n\nfunction loadTextures(textureConfig) {\n\tlet textures = [];\n\n\ttextures[texture_floor] = [];\n\ttextures[texture_floor][texture_default] = loadImage('/img/textures/floor/floor_default.jpg');\n\ttextures[texture_floor][texture_num_alts] = textureConfig.NUM_FLOOR_ALTS;\n\tfor(let i = 0; i < textures[texture_floor][texture_num_alts]; i++) {\n\t\ttextures[texture_floor][texture_alt1 + i] = loadImage('/img/textures/floor/floor_alt_' + (1 + i) + '.png');\n\t}\n\n\t// textures[texture_floor][texture_alt2] = loadImage('/img/textures/floor/floor_alt_1.png');\n\t// textures[texture_floor][texture_alt3] = loadImage('/img/textures/floor/floor_alt_2.png');\n\t// textures[texture_floor][texture_alt4] = loadImage('/img/textures/floor/floor_alt_3.png');\n\t// textures[texture_floor][texture_alt5] = loadImage('/img/textures/floor/floor_alt_4.png');\n\t// textures[texture_floor][texture_alt6] = loadImage('/img/textures/floor/floor_alt_5.png');\n\n\t// \ttextures[texture_floor][texture_side_top] = loadImage('/img/textures/floor/side_top.png');\n\t// \ttextures[texture_floor][texture_side_right] = loadImage('/img/textures/floor/side_right.png');\n\t// \ttextures[texture_floor][texture_side_bottom] = loadImage('/img/textures/floor/side_bottom.png');\n\t// \ttextures[texture_floor][texture_side_left] = loadImage('/img/textures/floor/side_left.png');\n\n\t// \ttextures[texture_floor][texture_in_corner_top_right] = loadImage('/img/textures/floor/corner_in_top_right.png');\n\t// \ttextures[texture_floor][texture_in_corner_bottom_right] = loadImage('/img/textures/floor/corner_in_bottom_right.png');\n\t// \ttextures[texture_floor][texture_in_corner_bottom_left] = loadImage('/img/textures/floor/corner_in_bottom_left.png');\n\t// \ttextures[texture_floor][texture_in_corner_top_left] = loadImage('/img/textures/floor/corner_in_top_left.png');\n\n\t// \ttextures[texture_floor][texture_out_corner_top_right] = loadImage('/img/textures/floor/corner_out_top_right.png');\n\t// \ttextures[texture_floor][texture_out_corner_bottom_right] = loadImage('/img/textures/floor/corner_out_bottom_right.png');\n\t// \ttextures[texture_floor][texture_out_corner_bottom_left] = loadImage('/img/textures/floor/corner_out_bottom_left.png');\n\t// \ttextures[texture_floor][texture_out_corner_top_left] = loadImage('/img/textures/floor/corner_out_top_left.png');\n\n\t// \ttextures[texture_floor][texture_U_top] = loadImage('/img/textures/floor/U_top.png');\n\t// \ttextures[texture_floor][texture_U_right] = loadImage('/img/textures/floor/U_right.png');\n\t// \ttextures[texture_floor][texture_U_bottom] = loadImage('/img/textures/floor/U_bottom.png');\n\t// \ttextures[texture_floor][texture_U_left] = loadImage('/img/textures/floor/U_left.png');\n\n\t// textures[texture_floor][texture_cross] = loadImage('/img/textures/floor/cross.png');\n\n\n\ttextures[texture_wall] = [];\n\ttextures[texture_wall][texture_default] = loadImage('/img/textures/wall/wall_default.png');\n\ttextures[texture_wall][texture_num_alts] = textureConfig.NUM_WALL_ALTS;\n\tfor(let i = 0; i < textures[texture_wall][texture_num_alts]; i++) {\n\t\ttextures[texture_wall][texture_alt1 + i] = loadImage('/img/textures/wall/wall_alt_' + (1 + i) + '.png');\n\t}\n\n\t// textures[texture_wall][texture_alt1] = loadImage('/img/textures/old/wallTexture0.png');\n\t// textures[texture_wall][texture_alt2] = loadImage('/img/textures/old/wallTexture0.png');\n\t// textures[texture_wall][texture_alt3] = loadImage('/img/textures/old/wallTexture1.png');\n\t// textures[texture_wall][texture_alt4] = loadImage('/img/textures/old/wallTexture3.png');\n\t// textures[texture_wall][texture_alt5] = loadImage('/img/textures/old/wallTexture4.png');\n\t// textures[texture_wall][texture_alt6] = loadImage('/img/textures/old/wallTexture5.png');\n\t// textures[texture_wall][texture_num_alts] = 0;\n\n\ttextures[texture_wall][texture_side_top] = loadImage('/img/textures/wall/wall_side_top.png');\n\ttextures[texture_wall][texture_side_right] = loadImage('/img/textures/wall/wall_side_right.png');\n\ttextures[texture_wall][texture_side_bottom] = loadImage('/img/textures/wall/wall_side_bottom.png');\n\ttextures[texture_wall][texture_side_left] = loadImage('/img/textures/wall/wall_side_left.png');\n\n\ttextures[texture_wall][texture_in_corner_top_right] = loadImage('/img/textures/wall/wall_corner_in_top_right.png');\n\ttextures[texture_wall][texture_in_corner_bottom_right] = loadImage('/img/textures/wall/wall_corner_in_bottom_right.png');\n\ttextures[texture_wall][texture_in_corner_bottom_left] = loadImage('/img/textures/wall/wall_corner_in_bottom_left.png');\n\ttextures[texture_wall][texture_in_corner_top_left] = loadImage('/img/textures/wall/wall_corner_in_top_left.png');\n\n\ttextures[texture_wall][texture_out_corner_top_right] = loadImage('/img/textures/wall/wall_corner_out_top_right.png');\n\ttextures[texture_wall][texture_out_corner_bottom_right] = loadImage('/img/textures/wall/wall_corner_out_bottom_right.png');\n\ttextures[texture_wall][texture_out_corner_bottom_left] = loadImage('/img/textures/wall/wall_corner_out_bottom_left.png');\n\ttextures[texture_wall][texture_out_corner_top_left] = loadImage('/img/textures/wall/wall_corner_out_top_left.png');\n\n\t// textures[texture_wall][texture_U_top] = loadImage('/img/textures/wall/wall_U_top.png');\n\t// textures[texture_wall][texture_U_right] = loadImage('/img/textures/wall/wall_U_right.png');\n\t// textures[texture_wall][texture_U_bottom] = loadImage('/img/textures/wall/wall_U_bottom.png');\n\t// textures[texture_wall][texture_U_left] = loadImage('/img/textures/wall/wall_U_left.png');\n\n\t// textures[texture_wall][texture_cross] = loadImage('/img/textures/wall/wall_cross.png');\n\n\n\ttextures[texture_door_closed] = [];\n\ttextures[texture_door_closed][texture_default] = loadImage('/img/textures/old/doorClosedTexture.png');\n\ttextures[texture_door_closed][texture_num_alts] = 0;\n\n\ttextures[texture_door_open] = [];\n\ttextures[texture_door_open][texture_default] = loadImage('/img/textures/old/doorOpenedTexture.png');\n\ttextures[texture_door_open][texture_num_alts] = 0;\n\n\ttextures[texture_loot_closed] = [];\n\ttextures[texture_loot_closed][texture_default] = loadImage('/img/textures/old/lootClosedTexture.png');\n\ttextures[texture_loot_closed][texture_num_alts] = 0;\n\n\ttextures[texture_loot_open] = [];\n\ttextures[texture_loot_open][texture_default] = loadImage('/img/textures/old/lootOpenedTexture.png');\n\ttextures[texture_loot_open][texture_num_alts] = 0;\n\n\ttextures[texture_stair_up] = [];\n\ttextures[texture_stair_up][texture_default] = loadImage('/img/textures/stairUp.png');\n\ttextures[texture_stair_up][texture_num_alts] = 0;\n\n\ttextures[texture_stair_down] = [];\n\ttextures[texture_stair_down][texture_default] = loadImage('/img/textures/stairDown.png');\n\ttextures[texture_stair_down][texture_num_alts] = 0;\n\n\treturn textures;\n}\n\nfunction loadUI() {\n\tlet ui = [];\n\tui[ui_heart] = loadImage('/img/icons/heart.png');\n\tui[ui_empty_heart] = loadImage('/img/icons/emptyHeart.png');\n\treturn ui;\n}\n\n\nfunction loadMusic(){\n\tlet music = [];\n\tmusic.push(loadAudio('/audio/music/001_0100.wav'));\n\tmusic.push(loadAudio('/audio/music/002_0001.wav'));\n\tmusic.push(loadAudio('/audio/music/003_0101.wav'));\n\tmusic.push(loadAudio('/audio/music/004_1101.wav'));\n\tmusic.push(loadAudio('/audio/music/005_1121.wav'));\n\tmusic.push(loadAudio('/audio/music/006_2121.wav'));\n\tmusic.push(loadAudio('/audio/music/007_0200.wav'));\n\tmusic.push(loadAudio('/audio/music/008_0201.wav'));\n\tmusic.push(loadAudio('/audio/music/009_1201.wav'));\n\tmusic.push(loadAudio('/audio/music/010_1221.wav'));\n\treturn music;\n}\n\nfunction loadSounds(){\n}\n\nfunction keyDown() { }\n\nfunction keyUp() { }\n\n// $(document).ready(function () { init(); });\n","function PositionComponent(x, y){\n\tthis.x = x;\n\tthis.y = y;\n}\n\nfunction HealthComponent(initialHealth){\n\tthis.maxHealth = initialHealth;\n\tthis.health = initialHealth;\n}\n\nfunction StrengthComponent(initialStrength){\n\tthis.strength = initialStrength;\n}\n\nfunction IntelligenceComponent(initialIntelligence){\n\tthis.intelligence = initialIntelligence;\n}\n\nfunction DexterityComponent(initialDexterity){\n\tthis.dexterity = initialDexterity;\n}\n\nfunction CombatComponent(attackDamage, magicDamage, armor){\n\tthis.attackDamage = attackDamage;\n\tthis.magicDamage = magicDamage;\n\tthis.armor = armor;\n}\n\nfunction DirectionComponent(direction){\n\tthis.direction = direction;\n}\n\nfunction PhysicalComponent(solid, size){\n\tthis.solid = solid;\n\tthis.size = size;\n}\n\nfunction CollisionComponent(x, y, w, h){\n\tif(h === undefined) {\n\t\th = w;\n\t}\n\tthis.top = y;\n\tthis.right = x + w;\n\tthis.bottom = y + h;\n\tthis.left = x;\n\tthis.width = w;\n\tthis.height = h;\n}\n\nfunction MovementComponent(speed){\n\tthis.speed = speed;\n}\n\nfunction DisplayComponent(width, height, opaque, offsetX = 0, offsetY = 0){\n\tthis.width = width;\n\tthis.height = height;\n\tthis.visible = false;\n\tthis.discovered = false;\n\tthis.discoveredCounter = 0;\n\tthis.opaque = opaque;\n\tthis.offsetX = offsetX;\n\tthis.offsetY = offsetY;\n}\n\nfunction AnimationComponent(animations){\n\tthis.offsetX = 0;\n\tthis.offsetY = 0;\n\tthis.stage = 0;\n\tthis.sprite = undefined;\n\tthis.animation = animation_idle;\n\tthis.animations = animations;\n}\n\nfunction TextureComponent(type) {\n\tthis.textureType = type;\n\tthis.textureElements = [];\n}\n\nfunction TextureElementComponent(element = texture_default, xOff = 0, yOff = 0) {\n\tthis.element = element;\n\tthis.xOff = xOff;\n\tthis.yOff = yOff;\n}\n\nfunction LightComponent(){\n\tthis.level = 0;\n}\n\nfunction LightEmitterComponent(emitterLevel){\n\tthis.level = emitterLevel;\n}\n\nfunction ActionsComponent(actions){\n\tthis.busy = 0;\n\tthis.actions = [];\n\tfor(let a in actions) {\n\t\tthis.actions[a] = new ActionComponent(actions[a].action, actions[a].cooldown, actions[a].time);\n\t}\n\tthis.nextAction = action_none;\n\tthis.currentAction = action_none;\n\tthis.lastAction = action_none;\n\tthis.lastActionFailed = false;\n}\n\nfunction ActionComponent(actionID, actionCooldown, actionTime) {\n\tthis.action = actionID;\n\tthis.cooldown = actionCooldown;\n\tthis.time = actionTime;\n\tthis.currentCooldown = 0;\n}\n\nfunction SprintComponent(movesBeforeSprinting, sprintSpeed){\n\tthis.movesBeforeSprinting = movesBeforeSprinting;\n\tthis.lastMoveTime = 0;\n\tthis.sprintCounter = 0;\n\tthis.sprinting = false;\n\tthis.sprintSpeed = sprintSpeed;\n}\n\nfunction MapComponent(map){\n\tthis.map = map;\n}\n\nfunction DepthComponent(depth){\n\tthis.depth = depth;\n}\n\nfunction AIComponent(attackRange){\n\tthis.attackRange = attackRange;\n\tthis.noticedPlayer = false;\n\tthis.idleTimer = 0;\n}\n\nfunction AbilitiesComponent(abilities){\n\tthis.abilities = [];\n\tfor(let a of abilities) {\n\t\tthis.abilities.push(new AbilityComponent(a));\n\t}\n}\n\nfunction AbilityComponent(ability){\n\tthis.name = ability.abilityName;\n\tthis.type = ability.abilityType;\n\tthis.cooldown = ability.cooldown;\n\tthis.time = ability.time;\n}\n","function Entity(x, y, initialDepth, size, visible, solid, animations) {\n\tthis.components = [component_position, component_depth, component_display];\n\n\tthis.position = new PositionComponent(x, y);\n\tthis.depth = new DepthComponent(initialDepth);\n\tthis.display = new DisplayComponent(size, size, visible);\n\n\tif(solid) {\n\t\tthis.components.push(component_collision);\n\t\tthis.collision = new CollisionComponent(x, y, size, size);\n\t}\n\tif(animations !== null) {\n\t\tthis.components.push(component_animation);\n\t\tthis.animation = new AnimationComponent(animations);\n\t}\n\n}\n","Mob.prototype = Object.create(Entity.prototype);\nfunction Mob(x, y, depth, config, actions, animations) {\n\tEntity.call(this, x, y, depth, config.size, display_opaque, physical_solid, animations);\n\n\tthis.components.push(component_direction, component_combat, component_actions, component_collision, component_ai);\n\n\tthis.health = new HealthComponent(config.health);\n\tthis.direction = new DirectionComponent(direction_down);\n\tthis.combat = new CombatComponent(config.attackDamage, config.magicDamage, config.armor);\n\tthis.actions = new ActionsComponent(actions);\n\tthis.ai = new AIComponent(config.attack_range);\n\n\tif(config.sprint_threshhold !== undefined) {\n\t\tthis.components.push(component_sprint);\n\t\tthis.sprint = new SprintComponent(config.sprint_threshhold, config.sprint_speed);\n\t}\n}\n","Player.prototype = Object.create(Entity.prototype);\nfunction Player(x, y, config, playerClass, actions, animations) {\n\tEntity.call(this, x, y, 0, 1, display_opaque, physical_solid, animations);\n\n\tthis.components.push(component_direction, component_health, component_combat, component_actions, component_collision, component_sprint, component_light_emitter, component_abilities);\n\n\tthis.direction = new DirectionComponent(direction_down);\n\tthis.health = new HealthComponent(config.health);\n\tthis.combat = new CombatComponent(config.attackDamage, config.magicDamage, config.armor);\n\tthis.actions = new ActionsComponent(actions);\n\tthis.sprint = new SprintComponent(config.sprint_threshhold, config.sprint_speed);\n\tthis.lightEmitter = new LightEmitterComponent(light_level_player);\n\tthis.abilities = new AbilitiesComponent(config.abilities);\n\n\tconsole.log(this);\n\n\t// this.components.push(component_experience);\n\t// this.level = new ExperienceComponent(0);\n}\n","\nfunction Item(){\n\n}\n","function generateLevel(CONFIG, depth, ROOM_POOL, STAIR_ROOM_POOL) {\n\tif(LEVEL_GEN) {\n\t\tlet startTime = millis();\n\n\t\tlet level;\n\t\tlet rooms = [];\n\t\tlet torches = [];\n\n\t\tlet stairUp = {x:0, y:0, sector:0};\n\t\tlet stairDown = {x:0, y:0, sector:0};\n\n\t\tlevel = initLevel(CONFIG.DUNGEON_SIZE, square_wall);\n\t\trooms.push(generateStairUpRoom(stairUp, CONFIG.DUNGEON_SIZE, STAIR_ROOM_POOL));\n\t\tstairUp.x = rooms[0].x;\n\t\tstairUp.y = rooms[0].y;\n\t\trooms.push(generateStairDownRoom(stairUp, stairDown, CONFIG.DUNGEON_SIZE, STAIR_ROOM_POOL));\n\t\tstairDown.x = rooms[1].x;\n\t\tstairDown.y = rooms[1].y;\n\t\tgenerateOtherRooms(level, rooms, CONFIG.DUNGEON_SIZE, CONFIG.ROOM_TRIES, ROOM_POOL);\n\t\tplaceRoomsOnLevel(level, rooms);\n\t\tmarkNodeSquares(level);\n\t\tconnectRooms(level, rooms, CONFIG.DUNGEON_SIZE);\n\t\tpopulateRooms(level, rooms, torches);\n\t\tfinalizeLevel(level, stairUp, stairDown);\n\n\t\t// console.log(\"Milliseconds: \" + (millis() - startTime));\n\n\t\treturn new Level(level, rooms, stairUp, stairDown, depth, torches);\n\t}\n\telse {\n\t\tlet level = initLevel(CONFIG.DUNGEON_SIZE, square_floor);\n\t\tlet torches = [];\n\t\tlet stairUp = {\n\t\t\tx: randomInt(CONFIG.DUNGEON_SIZE),\n\t\t\ty: randomInt(CONFIG.DUNGEON_SIZE)\n\t\t}\n\t\tlet stairDown = {\n\t\t\tx: randomInt(CONFIG.DUNGEON_SIZE),\n\t\t\ty: randomInt(CONFIG.DUNGEON_SIZE)\n\t\t}\n\t\tfinalizeLevel(level, stairUp, stairDown);\n\t\treturn new Level(level, stairUp, stairDown, depth, torches);\n\t}\n}\n\nfunction initLevel(size, defaultValue) {\n\tlet level = new Array(size);\n\tfor(let i = 0; i < size; i++) {\n\t\tlevel[i] = new Array(size);\n\t\tfor(let j = 0; j < size; j++) {\n\t\t\tlevel[i][j] = defaultValue;\n\t\t}\n\t}\n\treturn level;\n}\n\nfunction generateStairUpRoom(stairUp, size, STAIR_ROOM_POOL) {\n\tstairUp.sector = randomInt(8);\n\tsectorToCoordinates(stairUp, size);\n\n\t// stairUp.x += (stairUp.x % 2) - 1;\n\t// stairUp.y += (stairUp.y % 2) - 1;\n\n\treturn new Room(random(STAIR_ROOM_POOL), stairUp.x, stairUp.y);\n}\n\nfunction generateStairDownRoom(stairUp, stairDown, size, STAIR_ROOM_POOL) {\n\tstairDown.sector = (stairUp.sector + 4) % 8;\n\tsectorToCoordinates(stairDown, size);\n\n\t// stairDown.x += (stairDown.x % 2) - 1;\n\t// stairDown.y += (stairDown.y % 2) - 1;\n\n\treturn new Room(random(STAIR_ROOM_POOL), stairDown.x, stairDown.y);\n}\n\nfunction sectorToCoordinates(stair, size) {\n\t// 0 1 2\n\t// 7 X 3  (sector + 4) % 8 = opposite sector\n\t// 6 5 4\n\tswitch(stair.sector) {\n\t\tcase 0:\n\t\t\tstair.x = floor(size/4);\n\t\t\tstair.y = floor(size/4);\n\t\t\tbreak;\n\t\tcase 1:\n\t\t\tstair.x = 2 * floor(size/4);\n\t\t\tstair.y = floor(size/4);\n\t\t\tbreak;\n\t\tcase 2:\n\t\t\tstair.x = 3 * floor(size/4);\n\t\t\tstair.y = floor(size/4);\n\t\t\tbreak;\n\t\tcase 3:\n\t\t\tstair.x = 3 * floor(size/4);\n\t\t\tstair.y = 2 * floor(size/4);\n\t\t\tbreak;\n\t\tcase 4:\n\t\t\tstair.x = 3 * floor(size/4);\n\t\t\tstair.y = 3 * floor(size/4);\n\t\t\tbreak;\n\t\tcase 5:\n\t\t\tstair.x = 2 * floor(size/4);\n\t\t\tstair.y = 3 * floor(size/4);\n\t\t\tbreak;\n\t\tcase 6:\n\t\t\tstair.x = floor(size/4);\n\t\t\tstair.y = 3 * floor(size/4);\n\t\t\tbreak;\n\t\tcase 7:\n\t\t\tstair.x = floor(size/4);\n\t\t\tstair.y = 2 * floor(size/4);\n\t\t\tbreak;\n\t}\n}\n\nfunction generateOtherRooms(level, rooms, size, ROOM_TRIES, ROOM_POOL) {\n\tfor(let i = 0; i < ROOM_TRIES; i++) {\n\t\ttryRoom(level, rooms, size, ROOM_POOL);\n\t}\n}\n\nfunction tryRoom(level, rooms, size, ROOM_POOL) {\n\tlet newRoom = new Room(random(ROOM_POOL), randomInt(size), randomInt(size));\n\tif(isValidRoom(rooms, newRoom, size)) rooms.push(newRoom);\n}\n\nfunction isValidRoom(rooms, newRoom, size) {\n\tif(newRoom.left < 0 || newRoom.top < 0 || newRoom.right > size || newRoom.bottom > size) return false;\n\tfor(let r of rooms) {\n\t\tif(roomsCollide(r, newRoom)) return false;\n\t}\n\treturn true;\n}\n\nfunction roomsCollide(r1, r2) {\n\treturn !(r1.left > r2.right || r1.top > r2.bottom || r1.right < r2.left || r1.bottom < r2.top);\n}\n\nfunction placeRoomsOnLevel(level, rooms) {\n\tfor(let r of rooms) {\n\t\tfor(let i = 0; i < r.width; i++) {\n\t\t\tfor(let j = 0; j < r.height; j++) {\n\t\t\t\tlevel[i + r.left][j + r.top] = r.squares[i][j];\n\t\t\t}\n\t\t}\n\t}\n}\n\nfunction markNodeSquares(level) {\n\tfor(let i = 1; i < level.length - 1; i+=2) {\n\t\tfor(let j = 1; j < level.length - 1; j+=2) {\n\t\t\tif(level[i][j] == square_wall) level[i][j] = new Node(i, j, false);\n\t\t}\n\t}\n}\n\nfunction connectRooms(level, rooms, size) {\n\n\tlet connected = [rooms[0]];\n\tlet connectedDoors = rooms[0].doors;\n\twhile(connected.length < rooms.length) {\n\t\tlet closestRoom;\n\t\tlet closestDistance;\n\t\tfor(let r of rooms) {\n\t\t\tif(!connected.includes(r)) {\n\t\t\t\tclosestRoom = r;\n\t\t\t\tclosestDistance = 10000;\n\t\t\t}\n\t\t}\n\t\tfor(let c of connected) {\n\t\t\tfor(let r of rooms) {\n\t\t\t\tif(connected.includes(r)) continue;\n\t\t\t\telse{\n\t\t\t\t\tlet currentDistance = roomDistance(c, r);\n\t\t\t\t\tif(currentDistance < closestDistance) {\n\t\t\t\t\t\tclosestRoom = r;\n\t\t\t\t\t\tclosestDistance = currentDistance;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tconnectRoom(level, connected, closestRoom, connectedDoors);\n\t}\n}\n\nfunction roomDistance(r1, r2) {\n\treturn abs(r1.x - r2.x) + abs(r1.y - r2.y);\n}\n\nfunction connectRoom(level, connected, room, connectedDoors) {\n\n\tlet roomDoors = room.doors;\n\tlet closestDoors = [connectedDoors[0], roomDoors[0]];\n\tlet closestDistance = 10000;\n\tlet adjacent = false;\n\tlet success = false;\n\n\tfor(let rd of roomDoors) {\n\t\t//if door touches a connected room, use that door\n\t\tif(includesDoor(connectedDoors, rd)) {\n\t\t\tclosestDoors[0] = rd;\n\t\t\tadjacent = true;\n\t\t\tsuccess = true;\n\t\t\tbreak;\n\t\t}\n\t\t//otherwise find the closest point of connection\n\t\telse{\n\t\t\tfor(let cd of connectedDoors) {\n\t\t\t\tlet currentDistance = doorDistance(rd, cd);\n\t\t\t\tif(currentDistance < closestDistance) {\n\t\t\t\t\tclosestDoors = [cd, rd];\n\t\t\t\t\tclosestDistance = currentDistance;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tif(!adjacent) {\n\t\tsuccess = makePathBetweenDoors(level, closestDoors[0], closestDoors[1], connectedDoors);\n\t}\n\n\tif(success) {\n\t\tif(adjacent) {\n\t\t\tlevel[closestDoors[0][0]][closestDoors[0][1]] = square_door;\n\t\t}\n\t\telse{\n\t\t\tlevel[closestDoors[0][0]][closestDoors[0][1]] = square_door;\n\t\t\tlevel[closestDoors[1][0]][closestDoors[1][1]] = square_door;\n\t\t}\n\n\t\tfor(let rd of roomDoors) {\n\t\t\tif(!includesDoor(connectedDoors, rd)) {\n\t\t\t\tconnectedDoors.push(rd);\n\t\t\t}\n\t\t}\n\t\tconnected.push(room);\n\t}\n\telse{\n\t\tconnectedDoors.splice(connectedDoors.indexOf(closestDoors[0]), 1);\n\t\troom.doors.splice(room.doors.indexOf(closestDoors[1]), 1);\n\t\tconnectRoom(level, connected, room, connectedDoors);\n\t}\n}\n\nfunction includesDoor(doorArray, door) {\n\tfor(let d of doorArray) {\n\t\tif(door[0] == d[0] && door[1] == d[1]) return true;\n\t}\n\treturn false;\n}\n\nfunction doorDistance(d1, d2) {\n\treturn ((d1[0] - d2[0]) * (d1[0] - d2[0])) + ((d1[1] - d2[1]) * (d1[1] - d2[1]));\n}\n\nfunction makePathBetweenDoors(level, door1, door2, connectedDoors) {\n\tlet searched = [];\n\tlet searching = [];\n\tlet distFromStart = {};\n\tlet finalCost = {};\n\n\tfor (let i = 0; i < level.length; i++) {\n\t\tfor (let j = 0; j < level[0].length; j++) {\n\t\t\tdistFromStart[level[i][j]] = LARGE_VALUE;\n\t\t\tfinalCost[level[i][j]] = LARGE_VALUE;\n\t\t}\n\t}\n\n\tlet start = getAdjacentNode(level, door1);\n\tlet end = getAdjacentNode(level, door2);\n\n\tif(start == undefined || end == undefined) return false;\n\n\tsearching.push(start);\n\tdistFromStart[start] = 0;\n\tfinalCost[start] = nodeDistance(start, end);\n\tstart.cameFrom = undefined;\n\n\twhile (searching.length > 0) {\n\t\tlet current = searching[0];\n\t\tfor (let s of searching) {\n\t\t\tif (finalCost[s] < finalCost[current]) current = s;\n\t\t}\n\n\t\tif (current == end) {\n\t\t\tdrawNodePath(level, current, connectedDoors);\n\t\t\treturn true;\n\t\t}\n\n\t\tsearching.splice(searching.indexOf(current), 1);\n\t\tsearched.push(current);\n\n\t\tlet currentNeighbors = getSurroundingNodes(level, current);\n\t\tfor (let n of currentNeighbors) {\n\t\t\tif (searched.includes(n)) {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tlet estimatedDistFromStart = distFromStart[current] + 1;\n\n\t\t\t\tif (!searching.includes(n)) {\n\t\t\t\t\tsearching.push(n);\n\t\t\t\t}\n\t\t\t\telse if (estimatedDistFromStart >= distFromStart[n]) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tn.cameFrom = current;\n\t\t\t\tdistFromStart[n] = estimatedDistFromStart;\n\t\t\t\tfinalCost[n] = distFromStart[n] + nodeDistance(start, end);\n\t\t\t}\n\t\t}\n\t}\n\treturn false;\n}\n\nfunction getAdjacentNode(level, door) {\n\tif (door[0] % 2 == 1 && door[1] % 2 == 1) return level[door[0]][door[1]];\n\tif (door[0] > 1 && level[door[0] - 1][door[1]] instanceof Node) return level[door[0] - 1][door[1]];\n\tif (door[1] > 1 && level[door[0]][door[1] - 1] instanceof Node) return level[door[0]][door[1] - 1];\n\tif (door[0] < level.length - 2 && level[door[0] + 1][door[1]] instanceof Node) return level[door[0] + 1][door[1]];\n\tif (door[1] < level.length - 2 && level[door[0]][door[1] + 1] instanceof Node) return level[door[0]][door[1] + 1];\n}\n\nfunction nodeDistance(start, end) {\n\treturn abs(start.x - end.x) + abs(start.y - end.y);\n}\n\nfunction getSurroundingNodes(level, node) {\n\tlet neighbors = [];\n\tif (node.x > 1 && level[node.x - 2][node.y] instanceof Node) neighbors.push(level[node.x - 2][node.y]);\n\tif (node.y > 1 && level[node.x][node.y - 2] instanceof Node) neighbors.push(level[node.x][node.y - 2]);\n\tif (node.x < level.length - 2 && level[node.x + 2][node.y] instanceof Node) neighbors.push(level[node.x + 2][node.y]);\n\tif (node.y < level.length - 2 && level[node.x][node.y + 2] instanceof Node) neighbors.push(level[node.x][node.y + 2]);\n\treturn neighbors;\n}\n\nfunction drawNodePath(level, node) {\n\t// level[node.x][node.y] = square_floor;\n\tlevel[node.x][node.y].connected = true;\n\twhile(node.cameFrom != undefined) {\n\t\tfillBetweenNodes(level, node, node.cameFrom);\n\t\tnode = node.cameFrom;\n\t\t// level[node.x][node.y] = square_floor;\n\t\tlevel[node.x][node.y].connected = true;\n\t}\n}\n\nfunction fillBetweenNodes(level, node1, node2) {\n\tlevel[node1.x + ((node2.x - node1.x) / 2)][node1.y + ((node2.y - node1.y) / 2)] = square_floor;\n}\n\nfunction populateRooms(level, rooms, torches) {\n}\n\n\nfunction finalizeLevel(level, stairUp, stairDown) {\n\tlevel[stairUp.x][stairUp.y] = square_stair_up;\n\tlevel[stairDown.x][stairDown.y] = square_stair_down;\n\n\tfor(let i = 0; i < level.length; i++) {\n\t\tfor(let j = 0; j < level.length; j++) {\n\t\t\tif(level[i][j] instanceof Node) {\n\t\t\t\tif(level[i][j].connected) {\n\t\t\t\t\tlevel[i][j] = square_floor;\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\tlevel[i][j] = square_wall;\n\t\t\t\t}\n\t\t\t}\n\t\t\tswitch(level[i][j]) {\n\t\t\t\tcase square_floor:\n\t\t\t\t\tlevel[i][j] = new FloorSquare(i, j);\n\t\t\t\t\tbreak;\n\t\t\t\tcase square_wall:\n\t\t\t\t\tlevel[i][j] = new WallSquare(i, j);\n\t\t\t\t\tbreak;\n\t\t\t\tcase square_door:\n\t\t\t\t\tlevel[i][j] = new DoorSquare(i, j);\n\t\t\t\t\tbreak;\n\t\t\t\tcase square_stair_up:\n\t\t\t\t\tlevel[i][j] = new StairUpSquare(i, j);\n\t\t\t\t\tbreak;\n\t\t\t\tcase square_stair_down:\n\t\t\t\t\tlevel[i][j] = new StairDownSquare(i, j);\n\t\t\t\t\tbreak;\n\t\t\t\tcase square_loot:\n\t\t\t\t\tlevel[i][j] = new FloorSquare(i, j);\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tconsole.log('Not recognized squaretype: ' + level[i][j]);\n\t\t\t\t\tlevel[i][j] = new Square(i, j, level[i][j]);\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\n\tlet blanks = [];\n\n\tfor(let i = 1; i < level.length - 1; i++) {\n\t\tfor(let j = 1; j < level.length - 1; j++) {\n\t\t\tif(level[i][j] instanceof WallSquare && !(level[i - 1][j - 1] instanceof FloorSquare || level[i][j - 1] instanceof FloorSquare || level[i + 1][j - 1] instanceof FloorSquare || level[i - 1][j] instanceof FloorSquare || level[i + 1][j] instanceof FloorSquare || level[i - 1][j + 1] instanceof FloorSquare || level[i][j + 1] instanceof FloorSquare || level[i + 1][j + 1] instanceof FloorSquare)){\n\t\t\t\tblanks.push(level[i][j]);\n\t\t\t}\n\t\t}\n\t}\n\n\tfor(let i = 1; i < level.length - 1; i++) {\n\t\tif(!(level[i - 1][1] instanceof FloorSquare || level[i][1] instanceof FloorSquare || level[i + 1][1] instanceof FloorSquare)){\n\t\t\tblanks.push(level[i][0]);\n\t\t}\n\t\tif(!(level[1][i - 1] instanceof FloorSquare || level[1][i] instanceof FloorSquare || level[1][i + 1] instanceof FloorSquare)){\n\t\t\tblanks.push(level[0][i]);\n\t\t}\n\t\tif(!(level[i - 1][level.length - 2] instanceof FloorSquare || level[i][level.length - 2] instanceof FloorSquare || level[i + 1][level.length - 2] instanceof FloorSquare)){\n\t\t\tblanks.push(level[i][level.length - 1]);\n\t\t}\n\t\tif(!(level[level.length - 2][i - 1] instanceof FloorSquare || level[level.length - 2][i] instanceof FloorSquare || level[level.length - 2][i + 1] instanceof FloorSquare)){\n\t\t\tblanks.push(level[level.length - 1][i]);\n\t\t}\n\t}\n\n\tfor(let b of blanks) {\n\t\tlevel[b.position.x][b.position.y] = new BlankSquare(b.position.x, b.position.y);\n\t}\n}\n\nfunction Node(x, y, connected) {\n\tthis.x = x;\n\tthis.y = y;\n\tthis.connected = connected;\n}\n","function Room(template, x, y) {\n\n\t/*\n\t *\n\t *   000T000   T = (3, 0)   W = 7\n\t *   0000000   L = (0, 2)   H = 5\n\t *   L00C000R  C = (3, 2)\n\t *   0000000   R = (7, 2)\n\t *   0000000   B = (3, 5)\n\t *      B\n\t *\n\t */\n\n\tthis.width = template.width;\n\tthis.height = template.height;\n\n\tthis.left = x - floor(this.width / 2); //x coordinate of left most squares\n\tthis.top = y - floor(this.height / 2); //top most\n\tthis.left += (this.left % 2) - 1;\n\tthis.top += (this.top % 2) - 1;\n\tthis.right = this.left + this.width; //x coord of first wall on right\n\tthis.bottom = this.top + this.height; //x coord of first wall on right\n\n\tthis.x = this.left + floor(this.width / 2);\n\tthis.y = this.top + floor(this.height / 2);\n\n\tthis.squares = template.squares.slice(0);\n\tthis.doors = new Array(template.doors.length);\n\n\tfor(let i = 0; i < this.doors.length; i++){\n\t\tthis.doors[i] = [template.doors[i][0] + this.left, template.doors[i][1] + this.top];\n\t}\n}\n","class AISystem extends System {\n\n\tconstructor(config) {\n\t\tsuper([component_ai]);\n\t\tthis.config = config;\n\t}\n\n\trun(engine) {\n\t\tfor(let entity of this.objects) {\n\t\t\tif(Utility.distance(entity.position, engine.getPlayer().position) < entity_active_range) {\n\t\t\t\tif(entity.ai.noticedPlayer) {\n\t\t\t\t\tthis.handleActiveEntity(engine, entity, engine.getPlayer());\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tthis.handleIdleEntity(engine, entity, engine.getPlayer());\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\thandleEvent(engine, eventID, data) {\n\t\tswitch(eventID) {\n\t\t\tcase event_entity_attacked:\n\t\t\t\tif(data.attacker instanceof Player) {\n\t\t\t\t\tlet target = data.target;\n\t\t\t\t\tlet self = this;\n\t\t\t\t\ttarget.ai.idleTimer = 100;\n\t\t\t\t\tsetTimeout(function() {\n\t\t\t\t\t\ttarget.ai.noticedPlayer = true;\n\t\t\t\t\t}, this.config.MOB_REACTION_TIME);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase event_successful_action:\n\t\t\t\tlet entity = data.entity;\n\t\t\t\tif(entity instanceof Mob && !entity.ai.noticedPlayer && entity.display.visible) {\n\t\t\t\t\tlet self = this;\n\t\t\t\t\tsetTimeout(function() {\n\t\t\t\t\t\tentity.ai.noticedPlayer = self.checkNoticePlayer(engine, entity, engine.getPlayer());\n\t\t\t\t\t}, this.config.MOB_REACTION_TIME);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\taddObject(object) {\n\t\tsuper.addObject(object);\n\t}\n\n\thandleActiveEntity(engine, entity, player) {\n\t\tif(entity.actions.busy == 0) {\n\t\t\tentity.actions.nextAction = this.determineAction(engine, entity, player);\n\t\t}\n\t}\n\n\tdetermineAction(engine, entity, player) {\n\t\treturn randomInt(11, 14);\n\t\t// if(Utility.entityDistance(entity, player) <= entity.ai.attackRange) {\n\t\t// \treturn this.getAttackAction(entity, player);\n\t\t// }\n\t\t// else{\n\t\t// \treturn this.getMoveCloserAction(engine, entity, player);\n\t\t// }\n\t}\n\n\tgetAttackAction(entity, player) {\n\t\tlet dir = Utility.getDirectionToEntity(entity, player);\n\t\tentity.direction.direction = dir;\n\t\treturn direction_to_attack[dir];\n\t}\n\n\tgetMoveCloserAction(engine, entity, player) {\n\t\t// Utility.shortestPath(engine.getMap(), entity.position, player.position);\n\t\treturn direction_to_movement[Utility.getDirectionToEntity(entity, player)];\n\t}\n\n\thandleIdleEntity(engine, entity, player) {\n\t\tif(entity.ai.idleTimer == 0) {\n\t\t\tentity.actions.nextAction = this.determineIdleAction(engine, entity);\n\t\t\tentity.ai.idleTimer = randomInt(this.config.MIN_IDLE_TIME, this.config.MAX_IDLE_TIME);\n\t\t}\n\t\telse {\n\t\t\tentity.ai.idleTimer--;\n\t\t}\n\t}\n\n\tcheckNoticePlayer(engine, entity, player) {\n\t\tswitch(entity.direction.direction) {\n\t\t\tcase direction_up:\n\t\t\t\tif(entity.collision.top + 1 >= player.collision.bottom) {\n\t\t\t\t\treturn VisionSystem.lineOfSight(engine, entity.position, player.position);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase direction_right:\n\t\t\t\tif(entity.collision.right - 1 <= player.collision.left) {\n\t\t\t\t\treturn VisionSystem.lineOfSight(engine, entity.position, player.position);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase direction_down:\n\t\t\t\tif(entity.collision.bottom - 1 <= player.collision.top) {\n\t\t\t\t\treturn VisionSystem.lineOfSight(engine, entity.position, player.position);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase direction_left:\n\t\t\t\tif(entity.collision.left + 1 >= player.collision.right) {\n\t\t\t\t\treturn VisionSystem.lineOfSight(engine, entity.position, player.position);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tconsole.log(\"Cannot determine entity direction: \" + entity.direction.direction);\n\t\t\t\treturn false;\n\t\t}\n\t\treturn false;\n\t}\n\n\tdetermineIdleAction(engine, entity) {\n\t\tlet randomMoveAction = action_move + randomInt(1, 5);\n\t\tif(MovementSystem.validMove(engine, entity, MovementSystem.getDestination(entity, randomMoveAction))) {\n\t\t\treturn randomMoveAction;\n\t\t}\n\t\telse {\n\t\t\t// console.log(\"test\");\n\t\t\tif(randomMoveAction == action_move_up) {\n\t\t\t\treturn action_move_down;\n\t\t\t}\n\t\t\telse if(randomMoveAction == action_move_right) {\n\t\t\t\treturn action_move_left;\n\t\t\t}\n\t\t\telse if(randomMoveAction == action_move_down) {\n\t\t\t\treturn action_move_up;\n\t\t\t}\n\t\t\telse if(randomMoveAction == action_move_left) {\n\t\t\t\treturn action_move_right;\n\t\t\t}\n\t\t\treturn action_none;\n\t\t}\n\t}\n}\n","class AbilitySystem extends System {\n\n\tconstructor() {\n\t\tsuper([component_abilities]);\n\t}\n\n\trun(engine) {\n\t\tfor(let entity of this.objects) {\n\t\t\tswitch(entity.actions.currentAction) {\n\t\t\t\tcase action_ability_one:\n\t\t\t\t\tthis.handleAbility(engine, entity, entity.abilities.abilities[0]);\n\t\t\t\t\tbreak;\n\t\t\t\tcase action_ability_two:\n\t\t\t\t\tthis.handleAbility(engine, entity, entity.abilities.abilities[1]);\n\t\t\t\t\tbreak;\n\t\t\t\tcase action_ability_three:\n\t\t\t\t\tthis.handleAbility(engine, entity, entity.abilities.abilities[2]);\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\thandleEvent(engine, eventID, data) { }\n\n\thandleAbility(engine, entity, ability) {\n\t\tif(ability !== undefined) {\n\t\t\tswitch(ability.type) {\n\t\t\t\tcase ability_type_melee:\n\t\t\t\t\tthis.handleMeleeAbility(engine, entity, ability);\n\t\t\t\t\tbreak;\n\t\t\t\tcase ability_type_aoe:\n\t\t\t\t\tthis.handleAOEAbility(engine, entity, ability);\n\t\t\t\t\tbreak;\n\t\t\t\tcase ability_type_aoe_ranged:\n\t\t\t\t\tthis.handleAOERangedAbility(engine, entity, ability);\n\t\t\t\t\tbreak;\n\t\t\t\tcase ability_type_skillshot:\n\t\t\t\t\tthis.handleSkillshotAbility(engine, entity, ability);\n\t\t\t\t\tbreak;\n\t\t\t\tcase ability_type_smite:\n\t\t\t\t\tthis.handleSmiteAbility(engine, entity, ability);\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\n\t// add effects, buffs\n\n\n\thandleMeleeAbility(engine, entity, ability) {\n\t\tconsole.log(\"melee: \" + entity);\n\n\t\tengine.sendEvent(event_successful_action, {'action': entity.actions.currentAction, 'entity': entity });\n\t}\n\n\thandleAOEAbility(engine, entity, ability) {\n\t\tconsole.log(\"aoe: \" + entity);\n\n\t\tengine.sendEvent(event_successful_action, {'action': entity.actions.currentAction, 'entity': entity });\n\t}\n\n\thandleAOERangedAbility(engine, entity, ability) {\n\t\tconsole.log(\"aoe ranged: \" + entity);\n\n\t\tengine.sendEvent(event_successful_action, {'action': entity.actions.currentAction, 'entity': entity });\n\t}\n\n\thandleSkillshotAbility(engine, entity, ability) {\n\t\tconsole.log(\"skillshot: \" + entity);\n\n\t\tengine.sendEvent(event_successful_action, {'action': entity.actions.currentAction, 'entity': entity });\n\t}\n\n\thandleSmiteAbility(engine, entity, ability) {\n\t\tconsole.log(\"smite: \" + entity);\n\n\t\tengine.sendEvent(event_successful_action, {'action': entity.actions.currentAction, 'entity': entity });\n\t}\n\n}\n","class ActionSystem extends System {\n\n\tconstructor() {\n\t\tsuper([component_actions]);\n\t}\n\n\tinit(engine) {\n\t\tthis.hitstunTimer = 0;\n\t}\n\n\trun(engine) {\n\t\tif(this.hitstunTimer == 0) {\n\t\t\tfor(let entity of this.objects) {\n\n\t\t\t\tfor(let a in entity.actions.actions) {\n\t\t\t\t\tif(entity.actions.actions[a].currentCooldown > 0) {\n\t\t\t\t\t\tentity.actions.actions[a].currentCooldown--;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif(entity.actions.busy > 0) {\n\t\t\t\t\tentity.actions.busy--;\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\tthis.setCurrentAction(entity, engine);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\tthis.hitstunTimer--;\n\t\t}\n\t}\n\n\thandleEvent(engine, eventID, data) {\n\t\tswitch(eventID) {\n\t\t\tcase event_successful_action:\n\t\t\t\tthis.handleSuccessfulAction(engine, data.entity, data.action);\n\t\t\t\tbreak;\n\t\t\tcase event_failed_action:\n\t\t\t\tthis.handleFailedAction(engine, data.entity);\n\t\t\t\tbreak;\n\t\t\tcase event_hitstun:\n\t\t\t\tthis.hitstunTimer = data.ticks;\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tsetCurrentAction(entity, engine) {\n\t\tentity.actions.currentAction = entity.actions.nextAction;\n\t\tentity.actions.nextAction = action_none;\n\t}\n\n\tsetCooldowns(entity, action) {\n\t\tentity.actions.busy = entity.actions.actions[action].time;\n\t\tentity.actions.actions[action].currentCooldown = entity.actions.actions[action].cooldown;\n\t}\n\n\thandleSuccessfulAction(engine, entity, action) {\n\t\tthis.setCooldowns(entity, action);\n\n\t\tif(action_to_animation[action] !== undefined && entity.animation.animations[action_to_animation[action]] !== undefined) {\n\t\t\tentity.animation.animation = action_to_animation[action];\n\t\t\tengine.sendEvent(event_new_animation, entity);\n\t\t}\n\n\t\tentity.actions.lastActionFailed = false;\n\t\tentity.actions.lastAction = action;\n\t\tentity.actions.currentAction = action_none;\n\t}\n\n\thandleFailedAction(engine, entity) {\n\t\tthis.setCooldowns(entity, action_none);\n\n\t\t// entity.animation.animation = action_to_animation[entity.actions.currentAction];\n\t\t// engine.sendEvent(event_new_animation, entity);\n\n\t\tentity.actions.lastActionFailed = true;\n\t\tentity.actions.lastAction = entity.actions.currentAction;\n\t\tentity.actions.currentAction = action_none;\n\t}\n}\n","class AnimationSystem extends System {\n\n\tconstructor(config) {\n\t\tsuper([component_animation]);\n\t\tthis.config = config;\n\t}\n\n\tinit(engine) {\n\t\tthis.animationCounter = 0;\n\t\tthis.idleAnimationCounter = 0;\n\t}\n\n\trun(engine) {\n\t\t// for(let o of this.objects) {\n\t\t// \tif(o.animation.newAnimation) {\n\t\t// \t\tstartAnimation(o);\n\t\t// \t}\n\t\t// }\n\t\tif(this.animationCounter == this.config.ANIMATION_SPEED) {\n\t\t\tthis.animationCounter = 0;\n\t\t\tif(this.idleAnimationCounter == this.config.IDLE_ANIMATION_SLOW_FACTOR) {\n\t\t\t\tthis.idleAnimationCounter = 0;\n\t\t\t}\n\t\t\tfor(let o of this.objects) {\n\t\t\t\tif(o.animation.animation == animation_idle) {\n\t\t\t\t\tif(this.idleAnimationCounter == 0) {\n\t\t\t\t\t\to.animation.stage++;\n\t\t\t\t\t\tif(o.animation.stage == o.animation.animations[o.animation.animation].length) {\n\t\t\t\t\t\t\tthis.startIdleAnimation(o);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis.updateAnimation(o);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\to.animation.stage++;\n\t\t\t\t\tif(o.animation.stage == o.animation.animations[o.animation.animation].length) {\n\t\t\t\t\t\tthis.startIdleAnimation(o);\n\t\t\t\t\t}\n\t\t\t\t\tthis.updateAnimation(o);\n\t\t\t\t}\n\t\t\t\t// if((o.animation.nextAnimation == animation_idle && this.idleAnimationCounter == 0) || o.animation.nextAnimation != animation_idle) {\n\t\t\t\t// \tif(o.animation.stage == o.animation.animations[o.animation.animation].length) {\n\t\t\t\t// \t\tthis.startAnimation(o, action_none);\n\t\t\t\t// \t}\n\t\t\t\t// }\n\t\t\t}\n\t\t\tthis.idleAnimationCounter++;\n\t\t}\n\t\tthis.animationCounter++;\n\t}\n\n\thandleEvent(engine, eventID, data) {\n\t\tswitch(eventID) {\n\t\t\tcase event_new_animation:\n\t\t\t\tthis.startAnimation(data);\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tstartIdleAnimation(entity) {\n\t\tentity.animation.animation = animation_idle;\n\t\tentity.animation.stage = 0;\n\t\tthis.updateAnimation(entity);\n\t}\n\n\tupdateAnimation(entity) {\n\t\tentity.animation.offsetX = entity.animation.animations[entity.animation.animation][entity.animation.stage].ox;\n\t\tentity.animation.offsetY = entity.animation.animations[entity.animation.animation][entity.animation.stage].oy;\n\t\tentity.animation.sprite = entity.animation.animations[entity.animation.animation][entity.animation.stage].sprite;\n\t\t// if(entity.animation.offsetX == undefined) {entity.animation.offsetX = 0;}\n\t\t// if(entity.animation.offsetY == undefined) {entity.animation.offsetY = 0;}\n\t}\n\n\tstartAnimation(object) {\n\t\tobject.animation.stage = 0;\n\t\tthis.updateAnimation(object);\n\t}\n}\n","function AudioManager() {\n    const mm = new MusicManager();\n    let sounds = [];\n}\n","class CombatSystem extends System {\n\n\tconstructor() {\n\t\tsuper([component_combat]);\n\t}\n\n\tinit(engine) {\n\t\tthis.inCombat = false;\n\t\tthis.combatTimer = 0;\n\t\tthis.combatTimerMax = 30;\n\t}\n\n\trun(engine) {\n\t\tfor(let entity of this.objects) {\n\t\t\tswitch(entity.actions.currentAction) {\n\t\t\t\t// case action_melee_attack:\n\t\t\t\t// \tlet dir = this.determineAttackDirection(entity, this.objects);\n\t\t\t\t// \tif(dir != -1) {\n\t\t\t\t// \t\tentity.actions.currentAction = action_melee_attack + dir + 1;\n\t\t\t\t// \t\tentity.direction.direction = dir;\n\t\t\t\t// \t\tthis.meleeAttack(engine, entity, this.objects);\n\t\t\t\t// \t}\n\t\t\t\t// \tbreak;\n\t\t\t\t// case action_melee_attack_up: case action_melee_attack_right: case action_melee_attack_down: case action_melee_attack_left:\n\t\t\t\t// \tthis.meleeAttack(engine, entity, this.objects);\n\t\t\t\t// \tbreak;\n\t\t\t\t// case action_spin_attack:\n\t\t\t\t// \tthis.spinAttack(engine, entity, this.objects);\n\t\t\t\t// \tbreak;\n\t\t\t}\n\t\t}\n\n\t\tif(this.inCombat) {\n\t\t\tif(!this.checkInCombat(engine.getPlayer(), this.objects)) {\n\t\t\t\tthis.combatTimer--;\n\t\t\t\tif(this.combatTimer == 0) {\n\t\t\t\t\tthis.endCombat(engine);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthis.resetCombatTimer();\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\tif(this.checkInCombat(engine.getPlayer(), this.objects)) {\n\t\t\t\tthis.beginCombat(engine);\n\t\t\t}\n\t\t}\n\t}\n\n\thandleEvent(engine, eventID, data) { }\n\n\taddObject(object) {\n\t\tsuper.addObject(object);\n\t}\n\n\tresetCombatTimer() {\n\t\tthis.combatTimer = this.combatTimerMax;\n\t}\n\n\tbeginCombat(engine) {\n\t\tif(!this.inCombat) {\n\t\t\tengine.sendEvent(event_begin_combat);\n\t\t\tthis.resetCombatTimer();\n\t\t\tthis.inCombat = true;\n\t\t}\n\t}\n\n\tendCombat(engine) {\n\t\tif(this.inCombat) {\n\t\t\tengine.sendEvent(event_end_combat);\n\t\t\tthis.inCombat = false;\n\t\t}\n\t}\n\n\tcheckInCombat(player, objects) {\n\t\tfor(let o of objects) {\n\t\t\tif(o instanceof Mob && o.ai.noticedPlayer && o.display.visible) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\n\tdetermineAttackDirection(entity, objects) {\n\t\tfor(let o of objects) {\n\t\t\tlet dir = Utility.entityAdjacent(entity, o);\n\t\t\tif(dir !== -1) {\n\t\t\t\treturn dir;\n\t\t\t}\n\t\t}\n\t\treturn -1;\n\t}\n\n\tmeleeAttack(engine, entity, objects) {\n\t\tfor(let o of objects) {\n\t\t\tif(entity != o) {\n\t\t\t\tif(Utility.collision(Utility.getCollisionInFrontOf(entity), o.collision)) {\n\t\t\t\t\tlet healthLost = max(0, (entity.combat.meleeAttackPower * 1.5) - o.combat.meleeDefensePower);\n\t\t\t\t\tif(entity instanceof Player) {\n\t\t\t\t\t\tengine.sendEvent(event_player_melee_attack);\n\t\t\t\t\t}\n\t\t\t\t\tengine.sendEvent(event_entity_attacked, { 'attacker': entity, 'target': o, 'healthLost': healthLost });\n\t\t\t\t\tengine.sendEvent(event_successful_action, { 'action': entity.actions.currentAction, 'entity': entity });\n\t\t\t\t\tthis.beginCombat(engine);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tengine.sendEvent(event_failed_action, { 'action': entity.actions.currentAction, 'entity': entity });\n\t}\n\n\tspinAttack(engine, entity, objects) {\n\t\tlet targets = [];\n\t\tfor(let o of objects) {\n\t\t\tif(entity != o && this.entityAround(entity, o)) {\n\t\t\t\ttargets.push(o);\n\t\t\t}\n\t\t}\n\t\tif(targets.length > 0) {\n\t\t\tif(entity instanceof Player) {\n\t\t\t\tengine.sendEvent(event_player_spin_attack);\n\t\t\t}\n\t\t\tfor(let o of targets) {\n\t\t\t\tlet healthLost = max(0, entity.combat.meleeAttackPower - o.combat.meleeDefensePower);\n\t\t\t\tengine.sendEvent(event_entity_attacked, { 'attacker': entity, 'target': o, 'healthLost': healthLost });\n\t\t\t}\n\t\t\tengine.sendEvent(event_successful_action, { 'action': entity.actions.currentAction, 'entity': entity });\n\t\t\tthis.beginCombat(engine);\n\t\t}\n\t}\n\n\tentityAround(entity, otherEntity) {\n\t\treturn Utility.collision(new CollisionComponent(entity.position.x - 1, entity.position.y - 1, 3), otherEntity.collision);\n\t}\n\n\tstatic validMeleeAttack(engine, entity) {\n\t\tfor(let o of engine.getEntities()) {\n\t\t\tif(entity != o) {\n\t\t\t\tif(Utility.entityAdjacent(entity, o) != -1) {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n}\n","class DisplaySystem extends System {\n\n\tconstructor(config, images) {\n\t\tsuper([component_position, component_display]);\n\t\tthis.config = config;\n\t\tthis.textures = images;\n\t}\n\n\tinit(engine) {\n\t\tthis.camera = {\n\t\t\tdisplay: true,\n\t\t\tx: 0,\n\t\t\ty: 0,\n\t\t\tshakeOffsetX : 0,\n\t\t\tshakeOffsetY : 0,\n\t\t\tcombat: false,\n\t\t\tsprinting: false,\n\t\t\tzoom: this.config.CAMERA_DEFAULT_ZOOM\n\t\t};\n\n\t\tthis.cameraZoomTimer = undefined;\n\t\tthis.cameraShakeTimer = undefined;\n\t\tthis.cameraMoving = false;\n\n\t\tthis.lightOffset = 0;\n\t\tthis.lightOffsetScale = .02;\n\t\tthis.lightOffsetSpeed = 600;\n\n\t\tthis.centerX = floor(width / 2);\n\t\tthis.centerY = floor(height / 2);\n\n\t\tthis.gridSize = this.config.GRID_SIZE;\n\t\tthis.halfGridSize = this.gridSize / 2;\n\t}\n\n\trun(engine) {\n\t\tbackground(0);\n\t\tif(this.camera.display) {\n\t\t\tif(this.cameraMoving) {\n\t\t\t\tlet player = engine.getPlayer();\n\t\t\t\tif(player.animation.animation == animation_idle) { this.cameraMoving = false; }\n\t\t\t\tthis.centerCamera(this.camera, player);\n\t\t\t}\n\n\t\t\tcanvas.translate(this.centerX + this.camera.shakeOffsetX, this.centerY + this.camera.shakeOffsetY);\n\t\t\tcanvas.scale(this.camera.zoom, this.camera.zoom);\n\n\t\t\tthis.drawSquares(engine.getMap());\n\t\t\tthis.drawEntities(engine.getEntities());\n\t\t\tthis.drawLights(this.objects);\n\t\t\tthis.drawMobHealth(this.objects);\n\n\t\t\tcanvas.setTransform();\n\t\t}\n\n\t\t// let et = millis() - st;\n\t\t// console.log(\"Time for draw loop: \" + et);\n\n\n\t\t// canvas.translate(width/2, height/2);\n\t\t// canvas.rotate(45 * Math.PI / 180);\n\t\t// canvas.shadowBlur = 10;\n\t\t// canvas.shadowColor = 'black';\n\t\t// canvas.shadowOffsetX = 5;\n\t\t// canvas.setTransform();\n\t}\n\n\thandleEvent(engine, eventID, data) {\n\t\tswitch(eventID) {\n\t\t\tcase event_begin_level:\n\t\t\t\tthis.determineSquareTextures(engine.getMap());\n\t\t\t\tthis.cameraMoving = true;\n\t\t\t\tthis.camera.display = true;\n\t\t\t\tbreak;\n\t\t\tcase event_player_moved:\n\t\t\t\tthis.cameraMoving = true;\n\t\t\t\tthis.camera.display = true;\n\t\t\t\tbreak;\n\t\t\tcase event_up_level: case event_down_level:\n\t\t\t\tthis.camera.display = false;\n\t\t\t\tbreak;\n\t\t\tcase event_window_resized:\n\t\t\t\tthis.resize();\n\t\t\t\tbreak;\n\t\t\tcase event_begin_combat:\n\t\t\t\tthis.camera.combat = true;\n\t\t\t\tthis.decideCameraZoomState(this.camera);\n\t\t\t\tbreak;\n\t\t\tcase event_end_combat:\n\t\t\t\tthis.camera.combat = false;\n\t\t\t\tthis.decideCameraZoomState(this.camera);\n\t\t\t\tbreak;\n\t\t\tcase event_player_start_sprinting:\n\t\t\t\tthis.camera.sprinting = true;\n\t\t\t\tthis.decideCameraZoomState(this.camera);\n\t\t\t\tbreak;\n\t\t\tcase event_player_stop_sprinting:\n\t\t\t\tthis.camera.sprinting = false;\n\t\t\t\tthis.decideCameraZoomState(this.camera);\n\t\t\t\tbreak;\n\t\t\t\t// case event_player_melee_attack:\n\t\t\t\t// \tthis.shakeCamera(this.camera, this.config.CAMERA_SHAKE_MEDIUM_SMALL);\n\t\t\t\t// \tengine.sendEvent(event_hitstun, { \"ticks\": 4 });\n\t\t\t\t// \tbreak;\n\t\t\t\t// case event_player_spin_attack:\n\t\t\t\t// \tthis.shakeCamera(this.camera, this.config.CAMERA_SHAKE_SMALL);\n\t\t\t\t// \tengine.sendEvent(event_hitstun, { \"ticks\": 2 });\n\t\t\t\t// \tbreak;\n\t\t\t\t// case event_player_take_damage:\n\t\t\t\t// \tthis.shakeCamera(this.camera, this.config.CAMERA_SHAKE_MEDIUM);\n\t\t\t\t// \tengine.sendEvent(event_hitstun, { \"ticks\": 6 });\n\t\t\t\t// \tbreak;\n\t\t}\n\t}\n\n\tstatic texturesConnect(t1, t2) {\n\t\tif(t2 === undefined) {\n\t\t\treturn false;\n\t\t}\n\t\tif(t1 instanceof WallSquare) {\n\t\t\treturn (t2 instanceof WallSquare);\n\t\t}\n\t\telse if(t1 instanceof FloorSquare) {\n\t\t\treturn !(t2 instanceof WallSquare);\n\t\t}\n\t}\n\n\tstatic determineTextureType(square, texture, map) {\n\t\tlet TOP = false, RIGHT = false, BOTTOM = false, LEFT = false;\n\t\tlet numNeighbors = 0;\n\t\tif(square.position.y > 0) {\n\t\t\tTOP = DisplaySystem.texturesConnect(square, map[square.position.x][square.position.y - 1]);\n\t\t\tif(TOP) { numNeighbors++; }\n\t\t}\n\t\tif(square.position.x < map.length - 1) {\n\t\t\tRIGHT = DisplaySystem.texturesConnect(square, map[square.position.x + 1][square.position.y]);\n\t\t\tif(RIGHT) { numNeighbors++; }\n\t\t}\n\t\tif(square.position.y < map.length - 1) {\n\t\t\tBOTTOM = DisplaySystem.texturesConnect(square, map[square.position.x][square.position.y + 1]);\n\t\t\tif(BOTTOM) { numNeighbors++; }\n\t\t}\n\t\tif(square.position.x > 0) {\n\t\t\tLEFT = DisplaySystem.texturesConnect(square, map[square.position.x - 1][square.position.y]);\n\t\t\tif(LEFT) { numNeighbors++; }\n\t\t}\n\n\t\tswitch(numNeighbors) {\n\t\t\tcase 0:\n\t\t\t\ttexture.textureElements.push(new TextureElementComponent(texture_cross, 0, 0));\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tif(TOP) {\n\t\t\t\t\ttexture.textureElements.push(new TextureElementComponent(texture_U_top, 0, 0));\n\t\t\t\t}\n\t\t\t\telse if(RIGHT) {\n\t\t\t\t\ttexture.textureElements.push(new TextureElementComponent(texture_U_right, 0, 0));\n\t\t\t\t}\n\t\t\t\telse if(BOTTOM) {\n\t\t\t\t\ttexture.textureElements.push(new TextureElementComponent(texture_U_bottom, 0, 0));\n\t\t\t\t}\n\t\t\t\telse if(LEFT) {\n\t\t\t\t\ttexture.textureElements.push(new TextureElementComponent(texture_U_left, 0, 0));\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\t\tif(LEFT && RIGHT) {\n\t\t\t\t\ttexture.textureElements.push(new TextureElementComponent(texture_side_top, 0, 0));\n\t\t\t\t\ttexture.textureElements.push(new TextureElementComponent(texture_side_bottom, 0, 0));\n\t\t\t\t}\n\t\t\t\telse if(TOP && BOTTOM) {\n\t\t\t\t\ttexture.textureElements.push(new TextureElementComponent(texture_side_right, 0, 0));\n\t\t\t\t\ttexture.textureElements.push(new TextureElementComponent(texture_side_left, 0, 0));\n\t\t\t\t}\n\t\t\t\telse if(TOP && RIGHT) {\n\t\t\t\t\ttexture.textureElements.push(new TextureElementComponent(texture_in_corner_bottom_left, 0, 0));\n\t\t\t\t\ttexture.textureElements.push(new TextureElementComponent(texture_out_corner_top_right, 0, 0));\n\t\t\t\t}\n\t\t\t\telse if(BOTTOM && RIGHT) {\n\t\t\t\t\ttexture.textureElements.push(new TextureElementComponent(texture_in_corner_top_left, 0, 0));\n\t\t\t\t\ttexture.textureElements.push(new TextureElementComponent(texture_out_corner_bottom_right, 0, 0));\n\t\t\t\t}\n\t\t\t\telse if(BOTTOM && LEFT) {\n\t\t\t\t\ttexture.textureElements.push(new TextureElementComponent(texture_in_corner_top_right, 0, 0));\n\t\t\t\t\ttexture.textureElements.push(new TextureElementComponent(texture_out_corner_bottom_left, 0, 0));\n\t\t\t\t}\n\t\t\t\telse if(LEFT && TOP) {\n\t\t\t\t\ttexture.textureElements.push(new TextureElementComponent(texture_in_corner_bottom_right, 0, 0));\n\t\t\t\t\ttexture.textureElements.push(new TextureElementComponent(texture_out_corner_top_left, 0, 0));\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 3:\n\t\t\t\tif(!TOP) {\n\t\t\t\t\ttexture.textureElements.push(new TextureElementComponent(texture_out_corner_bottom_right, 0, 0));\n\t\t\t\t\ttexture.textureElements.push(new TextureElementComponent(texture_out_corner_bottom_left, 0, 0));\n\t\t\t\t\ttexture.textureElements.push(new TextureElementComponent(texture_side_top, 0, 0));\n\t\t\t\t}\n\t\t\t\telse if(!RIGHT) {\n\t\t\t\t\ttexture.textureElements.push(new TextureElementComponent(texture_out_corner_top_left, 0, 0));\n\t\t\t\t\ttexture.textureElements.push(new TextureElementComponent(texture_out_corner_bottom_left, 0, 0));\n\t\t\t\t\ttexture.textureElements.push(new TextureElementComponent(texture_side_right, 0, 0));\n\t\t\t\t}\n\t\t\t\telse if(!BOTTOM) {\n\t\t\t\t\ttexture.textureElements.push(new TextureElementComponent(texture_out_corner_top_right, 0, 0));\n\t\t\t\t\ttexture.textureElements.push(new TextureElementComponent(texture_out_corner_top_left, 0, 0));\n\t\t\t\t\ttexture.textureElements.push(new TextureElementComponent(texture_side_bottom, 0, 0));\n\t\t\t\t}\n\t\t\t\telse if(!LEFT) {\n\t\t\t\t\ttexture.textureElements.push(new TextureElementComponent(texture_out_corner_bottom_right, 0, 0));\n\t\t\t\t\ttexture.textureElements.push(new TextureElementComponent(texture_out_corner_top_right, 0, 0));\n\t\t\t\t\ttexture.textureElements.push(new TextureElementComponent(texture_side_left, 0, 0));\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 4:\n\t\t\t\ttexture.textureElements.push(new TextureElementComponent(texture_default, 0, 0));\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\ttexture.textureElements.push(new TextureElementComponent(texture_default, 0, 0));\n\t\t\t\tbreak;\n\t\t}\n\n\t\t// if(square.position.y > 0 && square.position.x < map.length - 1) {\n\t\t// \ttopright = texturesConnect(square, map[square.position.x + 1][square.position.y - 1]);\n\t\t// }\n\t\t// if(square.position.x < map.length - 1 && square.position.y < map.length - 1) {\n\t\t// \tbottomright = texturesConnect(square, map[square.position.x + 1][square.position.y + 1]);\n\t\t// }\n\t\t// if(square.position.y < map.length - 1 && square.position.x > 0) {\n\t\t// \tbottomleft = texturesConnect(square, map[square.position.x - 1][square.position.y + 1]);\n\t\t// }\n\t\t// if(square.position.x > 0 && square.position.y > 0) {\n\t\t// \ttopleft = texturesConnect(square, map[square.position.x - 1][square.position.y - 1]);\n\t\t// }\n\t}\n\n\tdetermineSquareTextures(map) {\n\t\tfor(let i = 0; i < map.length; i++) {\n\t\t\tfor(let j = 0; j < map.length; j++) {\n\t\t\t\tlet square = map[i][j];\n\t\t\t\tfor(let texture of square.textures) {\n\t\t\t\t\tswitch(texture.textureType) {\n\t\t\t\t\t\tcase texture_wall: case texture_floor:\n\t\t\t\t\t\t\tDisplaySystem.determineTextureType(square, texture, map);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\ttexture.textureElements.push(new TextureElementComponent(texture_default, 0, 0));\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tif(texture.textureElements.length == 1 && texture.textureElements[0].element == texture_default) {\n\t\t\t\t\t\tthis.setTextureAlt(texture);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tsetTextureAlt(texture) {\n\t\tif(this.textures[texture.textureType][texture_num_alts] > 0) {\n\t\t\tlet rand = random(texture_probability_distribution[this.textures[texture.textureType][texture_num_alts] + 1]);\n\t\t\tfor(let i = 0; i < this.textures[texture.textureType][texture_num_alts] + 1; i++) {\n\t\t\t\tif(rand < texture_probability_distribution[i]) {\n\t\t\t\t\ttexture.textureElements[0].element = texture_default + i;\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tdrawSquares(map) {\n\t\tfor(let r of map) {\n\t\t\tfor(let s of r) {\n\t\t\t\tif(s.display.discovered) {\n\t\t\t\t\tlet bounds = this.getDrawBounds(s);\n\t\t\t\t\tif(this.onScreen(bounds, this.camera.zoom)) {\n\t\t\t\t\t\tthis.drawTexture(s, bounds);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tdrawTexture(object, bounds) {\n\t\tlet x = bounds.x, y = bounds.y, w = bounds.w, h = bounds.h;\n\t\tfor(let texture of object.textures) {\n\t\t\tfor(let textureElement of texture.textureElements) {\n\t\t\t\tif(this.textures[texture.textureType][textureElement.element] == undefined) {\n\t\t\t\t\timage(this.textures[texture.textureType][texture_default], x + (this.gridSize * textureElement.xOff), y + (this.gridSize * textureElement.yOff), w, h);\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\timage(this.textures[texture.textureType][textureElement.element], x + (this.gridSize * textureElement.xOff), y + (this.gridSize * textureElement.yOff), w, h);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tdrawEntities(entities) {\n\t\tfor(let e of entities) {\n\t\t\tif(e.display.visible) {\n\t\t\t\tlet bounds = this.getDrawBounds(e);\n\t\t\t\tif(this.onScreen(bounds, this.camera.zoom)) {\n\t\t\t\t\tif(e.components.indexOf(component_animation) !== -1) {\n\t\t\t\t\t\tthis.drawAnimation(e, bounds);\n\t\t\t\t\t}\n\t\t\t\t\telse if(e.components.indexOf(component_texture) !== -1) {\n\t\t\t\t\t\tthis.drawAnimation(e, bounds);\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\t//========NEED TEXTURES========\n\t\t\t\t\t\tlet x = bounds.x, y = bounds.y, w = bounds.w, h = bounds.h;\n\t\t\t\t\t\tif(e instanceof Torch) {\n\t\t\t\t\t\t\tfill(255, 220, 130, .75);\n\t\t\t\t\t\t\tswitch(e.direction.direction) {\n\t\t\t\t\t\t\t\tcase direction_up:\n\t\t\t\t\t\t\t\t\tarc(x, y, w, Math.PI, 2 * Math.PI);\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\tcase direction_right:\n\t\t\t\t\t\t\t\t\tarc(x, y, h, Math.PI / 2, 1.5 * Math.PI, true);\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\tcase direction_down:\n\t\t\t\t\t\t\t\t\tarc(x, y, w, 0, Math.PI);\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\tcase direction_left:\n\t\t\t\t\t\t\t\t\tarc(x, y, h, Math.PI / 2, 1.5 * Math.PI);\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t// ellipse(x, y, w, h);\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\tfill(255, 100, 100);\n\t\t\t\t\t\t\trect(x, y, w, h);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tdrawAnimation(object, bounds) {\n\t\tlet x = bounds.x, y = bounds.y, w = bounds.w, h = bounds.h;\n\t\tx += this.gridSize * object.animation.offsetX;\n\t\ty += this.gridSize * object.animation.offsetY;\n\t\tlet s = object.animation.sprite;\n\t\tif(s == undefined) {\n\t\t\tfill(20);\n\t\t\trect(x + (this.gridSize / 8) - 2, y + (this.gridSize / 8) - 2, w - (this.gridSize / 4) + 4, h - (this.gridSize / 4) + 4);\n\t\t\tif(object instanceof Player) {\n\t\t\t\tfill(0, 200, 230);\n\t\t\t}\n\t\t\telse{\n\t\t\t\tfill(200, 20, 40);\n\t\t\t}\n\t\t\trect(x + (this.gridSize / 8), y + (this.gridSize / 8), w - (this.gridSize / 4), h - (this.gridSize / 4));\n\t\t}\n\t\telse{\n\t\t\timage(a, x, y, w, h);\n\t\t}\n\t}\n\n\tdrawLights(objects) {\n\t\tfor(let o of objects) {\n\t\t\tif(o.display.discovered && o.components.includes(component_light)) {\n\t\t\t\tthis.lightSquare(o);\n\t\t\t}\n\t\t}\n\t}\n\n\tlightSquare(o) {\n\t\tlet bounds = this.getDrawBounds(o);\n\t\tif(o.display.visible) {\n\t\t\tif(o instanceof WallSquare || o instanceof DoorSquare) {\n\t\t\t\tcanvas.fillStyle = light_level_to_light[2];\n\t\t\t\trect(bounds.x, bounds.y, bounds.w, bounds.h);\n\t\t\t\tcanvas.fillStyle = light_level_to_shadow[2];\n\t\t\t\trect(bounds.x, bounds.y, bounds.w, bounds.h);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tcanvas.fillStyle = light_level_to_light[o.light.level];\n\t\t\t\trect(bounds.x, bounds.y, bounds.w, bounds.h);\n\t\t\t\tcanvas.fillStyle = light_level_to_shadow[o.light.level];\n\t\t\t\trect(bounds.x, bounds.y, bounds.w, bounds.h);\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\tcanvas.fillStyle = light_level_to_light[0];\n\t\t\trect(bounds.x, bounds.y, bounds.w, bounds.h);\n\t\t\tcanvas.fillStyle = light_level_to_shadow[0];\n\t\t\trect(bounds.x, bounds.y, bounds.w, bounds.h);\n\t\t\tfill(0, 0, 0, .25);\n\t\t\trect(bounds.x, bounds.y, bounds.w, bounds.h);\n\t\t}\n\t}\n\n\tdrawMobHealth(objects) {\n\t\tconst HEALTH_BAR_OFFSET = 3;\n\t\tconst HEALTH_BAR_HEIGHT = 4;\n\t\tfor(let mob of objects) {\n\t\t\tif(mob instanceof Mob && mob.components.includes(component_health) && mob.display.visible) {\n\t\t\t\tlet bounds = this.getDrawBounds(mob);\n\t\t\t\tlet x = bounds.x;\n\t\t\t\tlet y = bounds.y;\n\t\t\t\t// let x = (this.gridSize * (this.camera.x - mob.position.x)) + this.camera.shakeOffsetX;\n\t\t\t\t// let y = (this.gridSize * (this.camera.y - mob.position.y)) + this.camera.shakeOffsetY;\n\t\t\t\tlet xoff = this.gridSize * mob.animation.offsetX;\n\t\t\t\tlet yoff = this.gridSize * mob.animation.offsetY;\n\t\t\t\tlet healthBarWidth = mob.display.width * this.gridSize - (this.gridSize / 4);\n\t\t\t\tfill(40,0,0);\n\t\t\t\trect(xoff + x + (this.gridSize / 8), yoff + y - HEALTH_BAR_OFFSET, healthBarWidth, HEALTH_BAR_HEIGHT);\n\t\t\t\thealthBarWidth = healthBarWidth * HealthSystem.getHealthPercent(mob);\n\t\t\t\tfill(50, 220, 120);\n\t\t\t\trect(xoff + x + (this.gridSize / 8), yoff + y - HEALTH_BAR_OFFSET, healthBarWidth, HEALTH_BAR_HEIGHT);\n\t\t\t}\n\t\t}\n\t}\n\n\tgetDrawBounds(object) {\n\t\treturn {\n\t\t\t'x': this.gridSize * (object.position.x + object.display.offsetX - this.camera.x),\n\t\t\t'y': this.gridSize * (object.position.y + object.display.offsetY - this.camera.y),\n\t\t\t'w': object.display.width * this.gridSize,\n\t\t\t'h': object.display.height * this.gridSize\n\t\t};\n\t}\n\n\tonScreen(bounds, scale) {\n\t\tconst border = max(bounds.w, bounds.h) + 10;\n\t\tconst t = -(height / scale / 2) - border;\n\t\tconst r = (width / scale / 2) + border;\n\t\tconst b = (height / scale / 2) + border;\n\t\tconst l = -(width / scale / 2) - border;\n\t\treturn bounds.y > t && bounds.x + bounds.w < r && bounds.y + bounds.h < b && bounds.x > l;\n\t}\n\n\tcenterCamera(camera, player) {\n\t\tif(player.animation.animation == animation_idle) {\n\t\t\tcamera.x = player.position.x;\n\t\t\tcamera.y = player.position.y;\n\t\t}\n\t\telse {\n\t\t\tcamera.x = player.position.x + player.animation.offsetX;\n\t\t\tcamera.y = player.position.y + player.animation.offsetY;\n\t\t\t// camera.y = player.position.y + player.animation.animations[offsetY;\n\t\t}\n\t\t//if(entity.position.x > camera.x) {\n\t\t//\tcamera.x = floor(camera.x * 40 + 1) / 40;\n\t\t//\tcameraMoveTimer = setTimeout(function() {moveCamera(camera, entity, direction)}, this.config.CAMERA_MOVE_SPEED);\n\t\t//}\n\t\t//else{\n\t\t//\tclearTimeout(cameraMoveTimer);\n\t\t//}\n\t}\n\n\tdecideCameraZoomState(camera) {\n\t\tif(camera.combat) {\n\t\t\tif(camera.sprinting) {\n\t\t\t\tthis.changeZoom(camera, this.config.CAMERA_ZOOM_STEPS_SLOW, this.config.CAMERA_COMBAT_ZOOM);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthis.changeZoom(camera, this.config.CAMERA_ZOOM_STEPS_MEDIUM, this.config.CAMERA_COMBAT_ZOOM);\n\t\t\t}\n\t\t}\n\t\telse if(camera.sprinting) {\n\t\t\tthis.changeZoom(camera, this.config.CAMERA_ZOOM_STEPS_MEDIUM, this.config.CAMERA_SPRINT_ZOOM);\n\t\t}\n\t\telse {\n\t\t\tthis.changeZoom(camera, this.config.CAMERA_ZOOM_STEPS_MEDIUM, this.config.CAMERA_DEFAULT_ZOOM);\n\t\t}\n\t}\n\n\tchangeZoom(camera, steps, zoom) {\n\t\tif(camera.zoom != zoom) {\n\t\t\tclearTimeout(this.cameraZoomTimer);\n\t\t\tthis.recursiveZoom(camera, this.config.CAMERA_ZOOM_SPEED, zoom, (zoom - camera.zoom) / steps);\n\t\t}\n\t}\n\n\trecursiveZoom(camera, speed, zoom, dif) {\n\t\tlet self = this;\n\t\tif(dif <= 0 && zoom - camera.zoom >= 0) {\n\t\t\tcamera.zoom = zoom;\n\t\t\treturn;\n\t\t}\n\t\telse if(dif > 0 && zoom - camera.zoom <= 0) {\n\t\t\tcamera.zoom = zoom;\n\t\t\treturn;\n\t\t}\n\t\telse {\n\t\t\tcamera.zoom += dif;\n\t\t\tthis.cameraZoomTimer = setTimeout(function() { self.recursiveZoom(camera, speed, zoom, dif); }, speed);\n\t\t}\n\t}\n\n\tshakeCamera(camera, shakeAmount) {\n\t\tlet self = this;\n\t\tclearTimeout(this.cameraShakeTimer);\n\t\tif(shakeAmount > 0) {\n\t\t\tcamera.shakeOffestX = ((shakeAmount % 2 == 0) ? -1 : 1) * (randomInt(0, shakeAmount * this.config.CAMERA_SHAKE_MULTIPLIER) + this.config.CAMERA_SHAKE_CONSTANT);\n\t\t\tcamera.shakeOffsetY = random(-1, 1) * this.config.CAMERA_SHAKE_CONSTANT / 2 * shakeAmount;\n\t\t\tthis.cameraShakeTimer = setTimeout(function() { self.shakeCamera(camera, shakeAmount - 1); }, this.config.CAMERA_SHAKE_SPEED);\n\t\t}\n\t\telse{\n\t\t\tcamera.shakeOffsetX = 0;\n\t\t\tcamera.shakeOffsetY = 0;\n\t\t\tthis.cameraShakeTimer = undefined;\n\t\t}\n\t}\n\n\tresize() {\n\t\tlet w = document.documentElement.clientWidth;\n\t\tlet h = document.documentElement.clientHeight;\n\t\tresizeCanvas(w, h);\n\t\twidth = w;\n\t\theight = h;\n\t\tthis.centerX = floor(w / 2);\n\t\tthis.centerY = floor(h / 2);\n\t}\n}\n","class EntitySystem extends System {\n\n\tconstructor(config, player_data, entity_data, boss_data) {\n\t\tsuper([component_actions]);\n\n\t\tthis.config = config;\n\t\tthis.playerData = player_data;\n\t\tthis.entityData = entity_data;\n\t\tthis.bossData = boss_data;\n\t}\n\n\thandleEvent(engine, eventID, data) {\n\t\tswitch(eventID) {\n\t\t\tcase event_spawn_enemy_close:\n\t\t\t\tthis.generateEnemy(engine, engine.getPlayer().position.x - randomInt(-4, 4), engine.getPlayer().position.y - randomInt(2, 4), engine.getDepth(), this.entityData[random(Object.keys(this.entityData))]);\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tgeneratePlayer(engine) {\n\t\tlet playerClass = class_warrior;\n\t\tlet config = this.playerData[playerClass]\n\t\tlet animations = Utility.convertAnimationsFromConfig(config.animations);\n\t\tengine.addObject(new Player(-1, -1, config, playerClass, config.actions, animations));\n\t\tengine.sendEvent(event_player_generated);\n\t}\n\n\tgenerateEntities(engine, level, depth) {\n\t\tlet config, entityPosition;\n\t\tlet numEntities = floor(depth / 3) + 10;\n\t\tlet entities = [];\n\n\t\twhile(numEntities > 0) {\n\t\t\tconfig = this.entityData[random(Object.keys(this.entityData))];\n\t\t\tentityPosition = this.findSafeSpawnLocation(config.size, entities[depth], engine.getPlayer(), level.map.map);\n\t\t\tif(entityPosition != undefined) {\n\t\t\t\tthis.generateEnemy(engine, entityPosition.x, entityPosition.y, depth, config);\n\t\t\t}\n\t\t\tnumEntities--;\n\t\t}\n\t}\n\n\tgenerateEnemy(engine, x, y, depth, config) {\n\t\tlet animations = Utility.convertAnimationsFromConfig(config.animations);\n\t\tif(this.safeSpawnLocation(x, y, config.size, engine.getEntities(), engine.getMap())) {\n\t\t\tlet mob = new Mob(x, y, depth, config, config.actions, animations);\n\t\t\tengine.addObject(mob);\n\t\t}\n\t}\n\n\tfindSafeSpawnLocation(size, entities, player, map) {\n\t\tlet validSquares = [];\n\t\tfor(let i = 0; i < map.length; i++) {\n\t\t\tfor(let j = 0; j < map[0].length; j++) {\n\t\t\t\tif((abs(player.position.x - i) + abs(player.position.y - j)) > this.config.SAFE_DISTANCE_FROM_PLAYER && this.safeSpawnLocation(i, j, size, entities, map)) {\n\t\t\t\t\tvalidSquares.push(map[i][j].position);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn random(validSquares);\n\t}\n\n\tsafeSpawnLocation(x, y, size, entities, map) {\n\t\tfor(let i = x; i < x + size; i++) {\n\t\t\tfor(let j = y; j < y + size; j++) {\n\t\t\t\tif(map[i][j].components.includes(component_collision)) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tlet col = new CollisionComponent(x, y, size);\n\t\tif(entities !== undefined) {\n\t\t\tfor(let e of entities) {\n\t\t\t\tif(Utility.collision(col, e.collision)) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn true;\n\t}\n\n\tgenerateBosses(engine, entities, levels, bossData, depth, player) {\n\t\tlet config, entityPosition;\n\t\tlet numBosses = 1;\n\t\tentities.push([]);\n\n\t\twhile(numBosses > 0) {\n\t\t\tconfig = bossData[random(Object.keys(bossData))];\n\t\t\tentityPosition = this.findSafeSpawnLocation(config.size, entities[depth], player, levels[depth].map.map);\n\t\t\tif(entityPosition != undefined) {\n\t\t\t\tthis.generateEnemy(engine, entityPosition.x, entityPosition.y, depth, config);\n\t\t\t}\n\t\t\tnumEntities--;\n\t\t}\n\t}\n\n\tupdateEntities(engine) {\n\t\t// for(let e of this.entities[engine.getDepth()]) {\n\t\t// \tengine.addObject(e);\n\t\t// }\n\t\t// engine.sendEvent(event_entities_loaded, 0, 1);\n\t}\n}\n","class HealthSystem extends System {\n\n\tconstructor(config) {\n\t\tsuper([component_health]);\n\t\tthis.config = config;\n\t}\n\n\tinit(engine) {\n\t\tthis.healthRegenCounter = 0;\n\t\tthis.healthRegen = true;\n\t}\n\n\trun(engine) {\n\t\tif(this.healthRegen) {\n\t\t\tif(this.healthRegenCounter % this.config.HEALTH_REGEN_TIMER == 0) {\n\t\t\t\tfor(let o of this.objects) {\n\t\t\t\t\tif(o.health.health < o.health.maxHealth) {\n\t\t\t\t\t\to.health.health+=5;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis.healthRegenCounter = 1;\n\t\t\t}\n\t\t\tthis.healthRegenCounter++;\n\t\t}\n\t}\n\n\thandleEvent(engine, eventID, data) {\n\t\tswitch(eventID) {\n\t\t\tcase event_entity_attacked:\n\t\t\t\tthis.applyDamage(engine, data.target, data.healthLost);\n\t\t\t\tif(data.target instanceof Player) {\n\t\t\t\t\tengine.sendEvent(event_player_take_damage);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase event_begin_combat:\n\t\t\t\tthis.healthRegen = false;\n\t\t\t\tbreak;\n\t\t\tcase event_end_combat:\n\t\t\t\tthis.healthRegen = true;\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tstatic getHealthPercent(entity){\n\t\treturn entity.health.health / entity.health.maxHealth;\n\t}\n\n\tstatic getCurrentHeartAmount(entity){\n\t\treturn floor(entity.health.health / 10);\n\t}\n\n\tstatic getMaxHeartAmount(entity){\n\t\treturn floor(entity.health.maxHealth / 10);\n\t}\n\n\tapplyDamage(engine, object, healthLost) {\n\t\tobject.health.health -= healthLost;\n\t\tthis.checkDead(engine, object);\n\t}\n\n\tcheckDead(engine, object) {\n\t\tif(object.health.health <= 0) {\n\t\t\tengine.removeObject(object);\n\t\t\tif(object instanceof Player) {\n\t\t\t\tengine.sendEvent(event_game_over);\n\t\t\t}\n\t\t}\n\t}\n}\n\n","class InputSystem extends System {\n\n\tconstructor() {\n\t\tsuper([]);\n\t}\n\n\tinit(engine) {\n\t\tthis.mobSpawnCooldown = 0;\n\t\tthis.inputs = [];\n\n\t\tlet self = this;\n\t\tdocument.addEventListener(\"keydown\", function (e) {\n\t\t\tself.keyDown(e);\n\t\t});\n\n\t\tdocument.addEventListener(\"keyup\", function (e) {\n\t\t\tself.keyUp(e);\n\t\t});\n\t}\n\n\trun(engine) {\n\t\tif(keys.includes('n') && this.mobSpawnCooldown <= 0) {\n\t\t\tthis.mobSpawnCooldown = 10;\n\t\t\tengine.sendEvent(event_spawn_enemy_close, engine.getPlayer());\n\t\t}\n\n\t\tif(this.mobSpawnCooldown > 0) {\n\t\t\tthis.mobSpawnCooldown--;\n\t\t}\n\n\t\tthis.setPlayerAction(engine, this.inputs);\n\t}\n\n\taddObject(object) { }\n\n\tkeyDown(event) {\n\t\tif(!this.inputs.includes(event.keyCode)) {\n\t\t\tthis.inputs.unshift(event.keyCode);\n\t\t}\n\t}\n\n\tkeyUp(event) {\n\t\tif(this.inputs.includes(event.keyCode)) {\n\t\t\tthis.inputs.splice(this.inputs.indexOf(event.keyCode), 1);\n\t\t}\n\t}\n\n\tsetPlayerAction(engine, inputs) {\n\t\tlet player = engine.getPlayer();\n\t\tif(inputs.length > 0) {\n\t\t\tlet highestPriority = 0;\n\t\t\tlet playerAction = action_none;\n\t\t\tfor(let key of inputs) {\n\t\t\t\tlet action = keyCode_to_action[key];\n\t\t\t\tlet priority = action_to_priority[action];\n\t\t\t\tpriority = this.fixPriority(engine, player, action, priority);\n\t\t\t\tif(priority > highestPriority && player.actions.actions[action].currentCooldown == 0) {\n\t\t\t\t\tplayerAction = action;\n\t\t\t\t\thighestPriority = priority;\n\t\t\t\t}\n\t\t\t}\n\t\t\tplayer.actions.nextAction = playerAction;\n\t\t}\n\t\telse {\n\t\t\tplayer.actions.nextAction = action_none;\n\t\t}\n\t}\n\n\tfixPriority(engine, player, action, priority) {\n\t\tif(player.actions.lastAction == action) {\n\t\t\tif(player.actions.lastActionFailed) {\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\telse {\n\t\t\t\treturn priority - .1;\n\t\t\t}\n\t\t}\n\t\treturn priority;\n\t}\n\n\n\tactionEqualsLastAction(player, a) {\n\t\treturn k;\n\t}\n}\n","class LevelSystem extends System {\n\n\tconstructor(config, room_pool, stair_room_pool) {\n\t\tsuper([]);\n\t\tthis.config = config;\n\t\tthis.roomPool = room_pool;\n\t\tthis.stairRoomPool = stair_room_pool;\n\t}\n\n\thandleEvent(engine, eventID, data) {\n\t\tswitch(eventID) {\n\t\t\t// case event_entities_loaded:\n\t\t\t// \tif(LOADING_SCREEN) {\n\t\t\t// \t\tengine.sendEvent(event_begin_level, this.levels[engine.getDepth()], 60);\n\t\t\t// \t}\n\t\t\t// \telse {\n\t\t\t// \t\tengine.sendEvent(event_begin_level, this.levels[engine.getDepth()], 1);\n\t\t\t// \t}\n\t\t\t// \tbreak;\n\t\t}\n\t}\n\n\tgenerateLevel(engine, depth) {\n\t\tlet level = generateLevel(this.config, depth, this.roomPool, this.stairRoomPool);\n\t\tengine.addObject(level);\n\t\treturn level;\n\t}\n\n}\n","class LightSystem extends System {\n\n\tconstructor(config) {\n\t\tsuper([component_light_emitter]);\n\t\tthis.config = config;\n\t}\n\n\trun(engine) { }\n\n\thandleEvent(engine, eventID, data) {\n\t\tswitch (eventID) {\n\t\t\tcase event_spawn_enemy_close:\n\t\t\t\tthis.light(engine.getMap());\n\t\t\t\tbreak;\n\t\t\tcase event_player_moved:\n\t\t\t\tsetTimeout(function() {\n\t\t\t\t\tthis.light(engine.getMap());\n\t\t\t\t}.bind(this), 50);\n\t\t\t\tbreak;\n\t\t\tcase event_begin_level:\n\t\t\t\tthis.light(engine.getMap());\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tgenerateTorches(engine, level, rooms) {\n\t\tfor(let room of rooms) {\n\t\t\tif(room.width >= 5 && room.height >= 5) {\n\t\t\t\tlet torchChance = this.config.ROOM_TORCH_CHANCE;\n\t\t\t\tlet fullWalls = [];\n\t\t\t\twhile(random() < torchChance && fullWalls.length < 3) {\n\t\t\t\t\tlet dir = randomInt(4);\n\t\t\t\t\twhile(fullWalls.includes(dir)) {\n\t\t\t\t\t\tdir = randomInt(4);\n\t\t\t\t\t}\n\t\t\t\t\tfullWalls.push(dir);\n\t\t\t\t\tlet x = 0, y = 0;\n\t\t\t\t\tswitch(dir) {\n\t\t\t\t\t\tcase direction_up:\n\t\t\t\t\t\t\tx = room.left + randomInt(2, room.width - 2);\n\t\t\t\t\t\t\ty = room.top;\n\t\t\t\t\t\t\tdir = direction_down;\n\t\t\t\t\t\t\tif(level[x][room.top - 1] instanceof DoorSquare) { continue; }\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase direction_right:\n\t\t\t\t\t\t\tx = room.right - 1;\n\t\t\t\t\t\t\ty = room.top + randomInt(2, room.height - 2);\n\t\t\t\t\t\t\tdir = direction_left;\n\t\t\t\t\t\t\tif(level[room.right][y] instanceof DoorSquare) { continue; }\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase direction_down:\n\t\t\t\t\t\t\tx = room.left + randomInt(2, room.width - 2);\n\t\t\t\t\t\t\ty = room.bottom - 1;\n\t\t\t\t\t\t\tdir = direction_up;\n\t\t\t\t\t\t\tif(level[x][room.bottom] instanceof DoorSquare) { continue; }\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase direction_left:\n\t\t\t\t\t\t\tx = room.left;\n\t\t\t\t\t\t\ty = room.top + randomInt(2, room.height - 2);\n\t\t\t\t\t\t\tdir = direction_right;\n\t\t\t\t\t\t\tif(level[room.left - 1][y] instanceof DoorSquare) { continue; }\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\n\t\t\t\t\tengine.addObject(new Torch(x, y, dir, engine.getDepth()));\n\t\t\t\t\ttorchChance -= this.config.CHANCE_ADDITIONAL_TORCH;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tlight(map) {\n\t\tfor(let r of map) {\n\t\t\tfor(let s of r) {\n\t\t\t\ts.light.level = 0;\n\t\t\t}\n\t\t}\n\t\tfor(let l of this.objects) {\n\t\t\tthis.setLightLevel(map[l.position.x][l.position.y], l.lightEmitter.level);\n\t\t\tfor(let octant = 0; octant < 8; octant++) {\n\t\t\t\tthis.lightTriangle(map, octant, l.position.x, l.position.y, l.lightEmitter.level);\n\t\t\t}\n\t\t}\n\t}\n\n\tsetLightLevel(object, range, x, y) {\n\t\tlet l = (x === undefined) ? range : range - x - floor(y * .4);\n\t\tif(object.light.level < l) {\n\t\t\tobject.light.level = l;\n\t\t}\n\t}\n\n\tlightTriangle(map, octant, sx, sy, range) {\n\t\tlet x = 1;\n\t\tlet shadows = [];\n\t\tlet squaresVisible = true;\n\n\t\twhile (x <= range && squaresVisible) {\n\t\t\tsquaresVisible = false;\n\t\t\tlet y = 0;\n\t\t\tlet curslope = 0;\n\t\t\twhile(curslope <= 1) {\n\t\t\t\tif(!VisionSystem.inShadow(x, y, shadows)) {\n\t\t\t\t\tsquaresVisible = true;\n\t\t\t\t\tlet cur = VisionSystem.getTranslatedSquare(map, octant, x, y, sx, sy);\n\t\t\t\t\tif(cur === undefined) { break; }\n\t\t\t\t\tthis.setLightLevel(cur, range, x, y);\n\t\t\t\t\tif(cur.display.opaque) {\n\t\t\t\t\t\tlet firstBlocked = this.getFirstBlockedLight(map, octant, x, y, sx, sy, shadows, range);\n\t\t\t\t\t\tlet lastBlocked = this.getBlockedLight(map, octant, x, y, sx, sy, shadows, range);\n\t\t\t\t\t\tlet shadowStart = VisionSystem.slope(firstBlocked.x, firstBlocked.y, BOTTOM_RIGHT);\n\t\t\t\t\t\tlet shadowEnd = VisionSystem.slope(lastBlocked.x, lastBlocked.y, TOP_LEFT);\n\t\t\t\t\t\tshadows.push([shadowStart, shadowEnd]);\n\t\t\t\t\t}\n\t\t\t\t\telse{\n\t\t\t\t\t\tlet above = VisionSystem.getTranslatedSquare(map, octant, x, y + 1, sx, sy);\n\t\t\t\t\t\tif(above !== undefined ) {\n\t\t\t\t\t\t\t// above.display.discovered = this.config.DISCOVERED_MAX;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\ty++;\n\t\t\t\tcurslope = VisionSystem.slope(x, y, CENTER_SQUARE);\n\t\t\t}\n\t\t\tx++;\n\t\t}\n\t}\n\n\tgetFirstBlockedLight(map, octant, x, y, sx, sy, shadows, range) {\n\t\tlet firstBlocked = {x:x, y:y};\n\n\t\tlet currentBlocked = VisionSystem.getTranslatedSquare(map, octant, x, y, sx, sy);\n\n\t\twhile(currentBlocked !== undefined && currentBlocked.display.opaque && VisionSystem.slope(x, y, CENTER_SQUARE) > 0) {\n\t\t\tfirstBlocked = {x:x, y:y};\n\t\t\tif(!VisionSystem.inShadow(x, y, shadows)) {\n\t\t\t\tthis.setLightLevel(currentBlocked, range, x, y);\n\t\t\t}\n\n\t\t\ty--;\n\t\t\tcurrentBlocked = VisionSystem.getTranslatedSquare(map, octant, x, y, sx, sy);\n\t\t}\n\t\treturn firstBlocked;\n\t}\n\n\tgetBlockedLight(map, octant, x, y, sx, sy, shadows, range) {\n\t\tlet lastBlocked = {x:x, y:y};\n\n\t\tlet currentBlocked = VisionSystem.getTranslatedSquare(map, octant, x, y, sx, sy);\n\n\t\twhile(currentBlocked !== undefined && currentBlocked.display.opaque && VisionSystem.slope(x, y, BOTTOM_RIGHT) < 1) {\n\t\t\tlastBlocked = {x:x, y:y};\n\t\t\tif(!VisionSystem.inShadow(x, y, shadows)) {\n\t\t\t\tthis.setLightLevel(currentBlocked, range, x, y);\n\t\t\t}\n\n\t\t\ty++;\n\t\t\tcurrentBlocked = VisionSystem.getTranslatedSquare(map, octant, x, y, sx, sy);\n\t\t}\n\t\treturn lastBlocked;\n\t}\n}\n","class MovementSystem extends System {\n\n\tconstructor() {\n\t\tsuper([component_position, component_collision, component_actions]);\n\t}\n\n\tinit() {\n\t\tthis.movementFrozen = true;\n\t}\n\n\trun(engine) {\n\t\tif(!this.movementFrozen) {\n\t\t\tfor(let entity of this.objects) {\n\t\t\t\tswitch(entity.actions.currentAction) {\n\t\t\t\t\tcase action_move_up: case action_move_right: case action_move_down: case action_move_left:\n\t\t\t\t\t\tthis.moveFromAction(engine, entity, this.objects);\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\thandleEvent(engine, eventID, data) {\n\t\tswitch(eventID) {\n\t\t\tcase event_level_loaded:\n\t\t\t\tlet player = engine.getPlayer();\n\t\t\t\tif(player.depth.depth <= engine.getDepth()) {\n\t\t\t\t\tthis.fixPlayerPosition(player, data.stairUp);\n\t\t\t\t}\n\t\t\t\telse if(player.depth.depth > engine.getDepth()) {\n\t\t\t\t\tthis.fixPlayerPosition(player, data.stairDown);\n\t\t\t\t}\n\t\t\t\tplayer.depth.depth = engine.getDepth();\n\t\t\t\tbreak;\n\t\t\tcase event_up_level: case event_down_level:\n\t\t\t\tthis.movementFrozen = true;\n\t\t\t\tbreak;\n\t\t\tcase event_begin_level:\n\t\t\t\tthis.movementFrozen = false;\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tfixPlayerPosition(player, stair) {\n\t\tplayer.position.x = stair.x;\n\t\tplayer.position.y = stair.y;\n\t\tplayer.collision.top = stair.y;\n\t\tplayer.collision.right = stair.x + player.collision.width;\n\t\tplayer.collision.bottom = stair.y + player.collision.height;\n\t\tplayer.collision.left = stair.x;\n\t}\n\n\tmove(engine, entity, objects, destination) {\n\t\tif(destination != undefined && MovementSystem.validMove(engine, entity, destination)) {\n\t\t\tentity.direction.direction = action_to_direction[entity.actions.currentAction];\n\t\t\tentity.position.x = destination.x;\n\t\t\tentity.position.y = destination.y;\n\n\t\t\tentity.collision.top = destination.y;\n\t\t\tentity.collision.right = destination.x + entity.collision.width;\n\t\t\tentity.collision.bottom = destination.y + entity.collision.height;\n\t\t\tentity.collision.left = destination.x;\n\n\t\t\tengine.sendEvent(event_successful_action, {'action': entity.actions.currentAction, 'entity': entity });\n\t\t\treturn true;\n\t\t}\n\t\telse {\n\t\t\tentity.actions.lastAction = entity.actions.currentAction;\n\t\t\tentity.actions.currentAction = action_none;\n\t\t\treturn false;\n\t\t}\n\t}\n\n\tmoveFromAction(engine, entity, objects) {\n\t\tlet destination = MovementSystem.getDestination(entity, entity.actions.currentAction);\n\t\tif(this.move(engine, entity, objects, destination)) {\n\t\t\tif(entity instanceof Player) {\n\t\t\t\tthis.playerWalkEvents(engine, entity);\n\t\t\t}\n\t\t\telse if(entity instanceof Mob) {\n\t\t\t\tengine.sendEvent(event_entity_moved);\n\t\t\t}\n\t\t}\n\n\t}\n\n\tplayerWalkEvents(engine, player) {\n\t\tlet square = engine.getMap()[player.position.x][player.position.y];\n\t\tif(square instanceof StairUpSquare && engine.getDepth() > 0) {\n\t\t\tengine.sendEvent(event_up_level);\n\t\t}\n\t\telse if(square instanceof StairDownSquare) {\n\t\t\tengine.sendEvent(event_down_level);\n\t\t}\n\t\telse {\n\t\t\tif(square instanceof DoorSquare) {\n\t\t\t\tsquare.open();\n\t\t\t}\n\t\t\tengine.sendEvent(event_player_moved);\n\t\t}\n\t}\n\n\tstatic getDestination(entity, movement) {\n\t\tswitch (movement) {\n\t\t\tcase action_move_up:\n\t\t\t\treturn new PositionComponent(entity.position.x, entity.position.y - 1);\n\t\t\tcase action_move_right:\n\t\t\t\treturn new PositionComponent(entity.position.x + 1, entity.position.y);\n\t\t\tcase action_move_down:\n\t\t\t\treturn new PositionComponent(entity.position.x, entity.position.y + 1);\n\t\t\tcase action_move_left:\n\t\t\t\treturn new PositionComponent(entity.position.x - 1, entity.position.y);\n\t\t\tdefault:\n\t\t\t\tconsole.log('No direction');\n\t\t\t\treturn undefined;\n\t\t}\n\t}\n\n\tstatic validMove(engine, entity, destination) {\n\t\tlet validMove = true;\n\t\tfor(let i = destination.x; i < destination.x + entity.collision.width; i++) {\n\t\t\tfor(let j = destination.y; j < destination.y + entity.collision.height; j++) {\n\t\t\t\tif(!Utility.walkable(i, j, engine.getMap(), entity, engine.getEntities())) {\n\t\t\t\t\tvalidMove = false;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn validMove;\n\t}\n}\n","function MusicManager() {\n\n\tlet music = MUSIC;\n\tMUSIC = null;\n\tlet currentLoop = music[0];\n\n\tlet loop = function () {\n\t\tcurrentLoop.ended = function () {\n\t\t\tcurrentLoop = playSound(music[randomInt(music.length)]);\n\t\t\tloop();\n\t\t};\n\t};\n\n\tlet init = (function () {\n\t\t// currentLoop = playSound(currentLoop);\n\t\t// loop();\n\t})();\n}\n","class SprintSystem extends System {\n\n\tconstructor(config) {\n\t\tsuper([component_sprint]);\n\t\tthis.config = config;\n\t}\n\n\tinit(engine) {\n\t\tfor(let entity of this.objects) {\n\t\t\tthis.resetSprintCounter(entity);\n\t\t}\n\t}\n\n\trun(engine) {\n\t\t// let currentTime = millis();\n\t\tfor(let entity of this.objects) {\n\t\t\tif(entity.sprint.sprinting) {\n\t\t\t\tif(this.sprintTimerExpired(entity, this.config.SPRINT_RESET_TIME_SPRINTING)) {\n\t\t\t\t\tthis.stopSprinting(engine, entity);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse {\n\t\t\t\tif(this.sprintTimerExpired(entity, this.config.SPRINT_RESET_TIME_WALKING)) {\n\t\t\t\t\tthis.resetSprintCounter(entity);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\thandleEvent(engine, eventID, data) {\n\t\tswitch(eventID) {\n\t\t\tcase event_successful_action:\n\t\t\t\tif(data.entity.components.includes(component_sprint)) {\n\t\t\t\t\tif(Utility.isMovementAction(data.action)) {\n\t\t\t\t\t\tif(data.entity.sprint.sprinting) {\n\t\t\t\t\t\t\tthis.handleSprinting(engine, data.entity);\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\tthis.decrementSprintCounter(engine, data.entity, data.action);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tif(data.entity.sprint.sprinting) {\n\t\t\t\t\t\t\tthis.stopSprinting(engine, data.entity);\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\tthis.resetSprintCounter(data.entity);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase event_up_level: case event_down_level:\n\t\t\t\tthis.stopAllSprinting(engine);\n\t\t\t\tbreak;\n\n\t\t}\n\t}\n\n\thandleSprinting(engine, entity) {\n\t\tif(this.sprintTimerExpired(entity, this.config.SPRINT_RESET_TIME_SPRINTING)) {\n\t\t\tthis.stopSprinting(engine, entity);\n\t\t}\n\t\telse {\n\t\t\tif(entity.actions.busy > entity.sprint.sprintSpeed) {\n\t\t\t\tentity.actions.busy = entity.sprint.sprintSpeed;\n\t\t\t}\n\t\t\tfor(let a in entity.actions.actions) {\n\t\t\t\tif(entity.actions.actions[a].currentCooldown > entity.sprint.sprintSpeed) {\n\t\t\t\t\tentity.actions.actions[a].currentCooldown = entity.sprint.sprintSpeed + 1;\n\t\t\t\t}\n\t\t\t}\n\t\t\tentity.sprint.lastMoveTime = millis();\n\t\t}\n\t}\n\n\tstartSprinting(engine, entity) {\n\t\tif(entity instanceof Player) {\n\t\t\tengine.sendEvent(event_player_start_sprinting);\n\t\t}\n\t\tentity.sprint.sprinting = true;\n\t\tthis.resetSprintCounter(entity);\n\t}\n\n\tstopSprinting(engine, entity) {\n\t\tif(entity instanceof Player) {\n\t\t\tengine.sendEvent(event_player_stop_sprinting);\n\t\t}\n\t\tentity.sprint.sprinting = false;\n\t\tthis.resetSprintCounter(entity);\n\t}\n\n\tdecrementSprintCounter(engine, entity) {\n\t\tif(entity.sprint.sprinting) {\n\t\t\tentity.sprint.lastMoveTime = millis();\n\t\t}\n\t\telse if(entity.sprint.sprintCounter > 0) {\n\t\t\tif(this.sprintTimerExpired(entity, this.config.SPRINT_RESET_TIME_WALKING)) {\n\t\t\t\tthis.resetSprintCounter(entity);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tentity.sprint.sprintCounter--;\n\t\t\t\tentity.sprint.lastMoveTime = millis();\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\tthis.startSprinting(engine, entity);\n\t\t}\n\t}\n\n\tresetSprintCounter(entity) {\n\t\tentity.sprint.sprintCounter = entity.sprint.movesBeforeSprinting;\n\t\tentity.sprint.lastMoveTime = millis();\n\t}\n\n\tsprintTimerExpired(entity, time) {\n\t\treturn (millis() - entity.sprint.lastMoveTime > time);\n\t}\n\n\tstopAllSprinting(engine) {\n\t\tfor(let entity of this.objects) {\n\t\t\tthis.stopSprinting(engine, entity);\n\t\t}\n\t}\n}\n","class UISystem extends System {\n\n\tconstructor(config, images) {\n\t\tsuper([]);\n\t\tthis.config = config;\n\t\tthis.images = images;\n\t}\n\n\tinit(engine) {\n\t\tthis.gameCanvas = document.getElementById('game');\n\t\tthis.titleScreen = document.getElementById('titleScreen');\n\t\tthis.helpScreen = document.getElementById('helpScreen');\n\t\tthis.levelChangeScreen = document.getElementById('levelChangeScreen');\n\t\tthis.levelChangeText = document.getElementById('levelChangeText');\n\t\tthis.gameOverScreen = document.getElementById('gameOverScreen');\n\n\t\tthis.resetScreen(this.titleScreen);\n\t\tthis.resetScreen(this.helpScreen);\n\t\tthis.resetScreen(this.levelChangeScreen);\n\t\tthis.resetScreen(this.gameOverScreen);\n\n\t\tthis.drawHearts = false;\n\t\tthis.heartCanvas = document.getElementById('heartCanvas').getContext('2d');\n\t\tdocument.getElementById('heartCanvas').style.left = \"\" + this.config.HEART_OFFSET + \"px\";\n\t\tdocument.getElementById('heartCanvas').style.top = \"\" + this.config.HEART_OFFSET + \"px\";\n\t}\n\n\trun(engine) {\n\t\tthis.drawPlayerHealth(this.heartCanvas, engine.getPlayer());\n\t}\n\n\thandleEvent(engine, eventID, data) {\n\t\tswitch(eventID) {\n\t\t\tcase event_new_game:\n\t\t\t\tthis.showLevelChangeScreen(engine);\n\t\t\t\tbreak;\n\t\t\tcase event_title_screen:\n\t\t\t\tthis.showTitleScreen(engine);\n\t\t\t\tbreak;\n\t\t\tcase event_down_level:\n\t\t\t\tthis.showLevelChangeScreen(engine);\n\t\t\t\tbreak;\n\t\t\tcase event_up_level:\n\t\t\t\tthis.showLevelChangeScreen(engine);\n\t\t\t\tbreak;\n\t\t\tcase event_begin_level:\n\t\t\t\tthis.hideLevelChangeScreen(engine);\n\t\t\t\tbreak;\n\t\t\tcase event_player_generated:\n\t\t\t\tthis.fixHeartCanvasSize(engine.getPlayer());\n\t\t\t\tbreak;\n\t\t\tcase event_game_over:\n\t\t\t\tthis.showGameOverScreen(engine);\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\taddObject(object) {\n\t\tsuper.addObject(object);\n\t}\n\n\tshowTitleScreen(engine) {\n\t\tthis.fadeScreenIn(this.titleScreen, this.config.TITLE_FADE_IN_TIME);\n\n\t\tlet self = this;\n\t\tdocument.getElementById('playButton').addEventListener('click', function() {\n\t\t\tself.fadeScreenOut(self.titleScreen, self.config.TITLE_FADE_OUT_TIME);\n\t\t\tengine.sendEvent(event_new_game);\n\t\t});\n\n\t\tdocument.getElementById('helpButton').addEventListener('click', function() {\n\t\t\tself.blurScreen(self.titleScreen, self.config.TITLE_BLUR_AMOUNT, self.config.TITLE_FADE_OUT_TIME);\n\t\t\tself.fadeScreenIn(self.helpScreen, self.config.TITLE_FADE_IN_TIME);\n\t\t\tdocument.getElementById('returnToTitleScreenButton').addEventListener('click', function() {\n\t\t\t\tself.unblurScreen(self.titleScreen, self.config.TITLE_FADE_IN_TIME);\n\t\t\t\tself.fadeScreenOut(self.helpScreen, self.config.TITLE_FADE_OUT_TIME);\n\t\t\t});\n\t\t});\n\t}\n\n\tshowLevelChangeScreen(engine) {\n\t\tthis.levelChangeText.innerHTML = 'Entering Level ' + (engine.getDepth() + 1);\n\t\tthis.fadeScreenIn(this.levelChangeScreen, this.config.LEVEL_CHANGE_FADE_IN_TIME);\n\t\tthis.drawHearts = false;\n\t}\n\n\thideLevelChangeScreen(engine) {\n\t\tthis.fadeScreenOut(this.levelChangeScreen, this.config.LEVEL_CHANGE_FADE_OUT_TIME);\n\t\tthis.drawHearts = true;\n\t}\n\n\tshowGameOverScreen(engine) {\n\t\tthis.fadeScreenIn(this.gameOverScreen, this.config.GAME_OVER_FADE_IN_TIME);\n\t\tthis.blurScreen(this.gameCanvas, this.config.GAME_BLUR_AMOUNT, this.config.GAME_OVER_FADE_IN_TIME);\n\t\tthis.hideHearts();\n\n\t\tlet self = this;\n\t\tdocument.getElementById('playAgainButton').addEventListener('click', function() {\n\t\t\tself.fadeScreenOut(self.gameOverScreen, self.config.GAME_OVER_FADE_OUT_TIME);\n\t\t\tself.unblurScreen(self.gameCanvas, self.config.GAME_OVER_FADE_OUT_TIME);\n\t\t\tengine.sendEvent(event_reset_game);\n\t\t\tengine.sendEvent(event_new_game, undefined, 20);\n\t\t});\n\t}\n\n\tfadeScreenIn(screen, milliseconds) {\n\t\tscreen.style.transitionDuration = milliseconds + 'ms';\n\t\tscreen.style.opacity = '1';\n\t\tscreen.style.visibility = 'visible';\n\t}\n\n\tfadeScreenOut(screen, milliseconds) {\n\t\tscreen.style.transitionDuration = milliseconds + 'ms';\n\t\tscreen.style.opacity = '0';\n\t\tsetTimeout(function() {\n\t\t\tscreen.style.visibility = 'hidden';\n\t\t}, milliseconds);\n\t}\n\n\tblurScreen(screen, blurAmount, milliseconds) {\n\t\tscreen.style.transitionDuration = milliseconds + 'ms';\n\t\tscreen.style.filter = 'blur(' + blurAmount + 'px)';\n\t}\n\n\tunblurScreen(screen, milliseconds) {\n\t\tscreen.style.transitionDuration = milliseconds + 'ms';\n\t\tscreen.style.filter = 'blur(0)';\n\t}\n\n\tresetScreen(screen) {\n\t\tscreen.style.opacity = '0';\n\t\tscreen.style.visibility = 'hidden';\n\t}\n\n\thideHearts() {\n\t\tthis.heartCanvas.clearRect(0, 0, heartCanvas.width, heartCanvas.height);\n\t\tthis.drawHearts = false;\n\t}\n\n\tdrawPlayerHealth(heartCanvas, player) {\n\t\tif(this.drawHearts) {\n\t\t\tlet x = 0, y = 0;\n\t\t\tfor(let i = 1; i <= HealthSystem.getMaxHeartAmount(player); i++) {\n\t\t\t\tif(i <= HealthSystem.getCurrentHeartAmount(player)) {\n\t\t\t\t\theartCanvas.drawImage(this.images[ui_heart], (x * this.config.HEART_SIZE) + (x * this.config.HEART_SPACING), (y * this.config.HEART_SIZE), this.config.HEART_SIZE, this.config.HEART_SIZE);\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\theartCanvas.drawImage(this.images[ui_empty_heart], (x * this.config.HEART_SIZE) + (x * this.config.HEART_SPACING), (y * this.config.HEART_SIZE), this.config.HEART_SIZE, this.config.HEART_SIZE);\n\t\t\t\t}\n\t\t\t\tx++;\n\t\t\t\tif(i % this.config.HEARTS_PER_ROW == 0) {\n\t\t\t\t\ty++;\n\t\t\t\t\tx = 0;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tfixHeartCanvasSize(player) {\n\t\tlet heartCanvas = document.getElementById('heartCanvas');\n\t\tlet heartAmount = HealthSystem.getMaxHeartAmount(player);\n\t\tlet w = (this.config.HEART_SPACING + this.config.HEART_SIZE) * this.config.HEARTS_PER_ROW;\n\t\tlet h = (this.config.HEART_SPACING + this.config.HEART_SIZE) * ceil(heartAmount / this.config.HEARTS_PER_ROW);\n\t\theartCanvas.width = w;\n\t\theartCanvas.height = h;\n\t}\n}\n","class VisionSystem extends System {\n\n\tconstructor(config) {\n\t\tsuper([component_display, component_position]);\n\t\tthis.config = config;\n\t}\n\n\tinit(engine) { }\n\n\trun(engine) { }\n\n\thandleEvent(engine, eventID, data) {\n\t\tswitch (eventID) {\n\t\t\tcase event_player_moved: case event_entity_moved: case event_begin_level: case event_spawn_enemy_close:\n\t\t\t\tthis.vision(engine.getMap(), engine.getPlayer());\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\t// addObject(object) {\n\t// }\n\n\tvision(map, player) {\n\t\tfor(let r of map) {\n\t\t\tfor(let s of r) {\n\t\t\t\ts.display.visible = false;\n\t\t\t}\n\t\t}\n\t\tplayer.display.visible = true;\n\t\tmap[player.position.x][player.position.y].display.visible = true;\n\t\tmap[player.position.x][player.position.y].display.discovered = true;\n\t\tfor(let octant = 0; octant < 8; octant++) {\n\t\t\tthis.playerSightTriangle(map, octant, player.position.x, player.position.y, this.config.PLAYER_VISION_RANGE);\n\t\t}\n\t\tfor(let e of this.objects) {\n\t\t\tif(map[e.position.x][e.position.y].display.visible) {\n\t\t\t\te.display.visible = true;\n\t\t\t\te.display.discovered = true;\n\t\t\t}\n\t\t\telse {\n\t\t\t\te.display.visible = false;\n\t\t\t}\n\t\t}\n\t}\n\n\tplayerSightTriangle(map, octant, sx, sy, range) {\n\t\tlet x = 1;\n\t\tlet shadows = [];\n\t\tlet squaresVisible = true;\n\n\t\twhile (x <= range && squaresVisible) {\n\t\t\tsquaresVisible = false;\n\t\t\tlet y = 0;\n\t\t\tlet curslope = 0;\n\t\t\twhile(curslope <= 1) {\n\t\t\t\tif(!VisionSystem.inShadow(x, y, shadows)) {\n\t\t\t\t\tsquaresVisible = true;\n\t\t\t\t\tlet cur = VisionSystem.getTranslatedSquare(map, octant, x, y, sx, sy);\n\t\t\t\t\tif(cur === undefined) { break; }\n\t\t\t\t\tcur.display.visible = true;\n\t\t\t\t\tcur.display.discovered = true;\n\t\t\t\t\tif(cur.display.opaque) {\n\t\t\t\t\t\tlet firstBlocked = this.getFirstBlocked(map, octant, x, y, sx, sy, shadows);\n\t\t\t\t\t\tlet lastBlocked = this.getBlocked(map, octant, x, y, sx, sy, shadows);\n\t\t\t\t\t\tlet shadowStart = VisionSystem.slope(firstBlocked.x, firstBlocked.y, BOTTOM_RIGHT);\n\t\t\t\t\t\tlet shadowEnd = VisionSystem.slope(lastBlocked.x, lastBlocked.y, TOP_LEFT);\n\t\t\t\t\t\tshadows.push([shadowStart, shadowEnd]);\n\t\t\t\t\t}\n\t\t\t\t\telse{\n\t\t\t\t\t\tlet above = VisionSystem.getTranslatedSquare(map, octant, x, y + 1, sx, sy);\n\t\t\t\t\t\tif(above !== undefined ) { above.display.discovered = true; }\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\ty++;\n\t\t\t\tcurslope = VisionSystem.slope(x, y, CENTER_SQUARE);\n\t\t\t}\n\t\t\tx++;\n\t\t}\n\t}\n\n\tgetFirstBlocked(map, octant, x, y, sx, sy, shadows) {\n\t\tlet firstBlocked = {x:x, y:y};\n\n\t\tlet currentBlocked = VisionSystem.getTranslatedSquare(map, octant, x, y, sx, sy);\n\n\t\twhile(currentBlocked !== undefined && currentBlocked.display.opaque && VisionSystem.slope(x, y, CENTER_SQUARE) > 0) {\n\t\t\tfirstBlocked = {x:x, y:y};\n\t\t\tif(!VisionSystem.inShadow(x, y, shadows)) {\n\t\t\t\tcurrentBlocked.display.visible = true;\n\t\t\t\tcurrentBlocked.display.discovered = true;\n\t\t\t}\n\n\t\t\ty--;\n\t\t\tcurrentBlocked = VisionSystem.getTranslatedSquare(map, octant, x, y, sx, sy);\n\t\t}\n\t\treturn firstBlocked;\n\t}\n\n\tgetBlocked(map, octant, x, y, sx, sy, shadows) {\n\t\tlet lastBlocked = {x:x, y:y};\n\n\t\tlet currentBlocked = VisionSystem.getTranslatedSquare(map, octant, x, y, sx, sy);\n\n\t\twhile(currentBlocked !== undefined && currentBlocked.display.opaque && VisionSystem.slope(x, y, BOTTOM_RIGHT) < 1) {\n\t\t\tlastBlocked = {x:x, y:y};\n\t\t\tif(!VisionSystem.inShadow(x, y, shadows)) {\n\t\t\t\tcurrentBlocked.display.visible = true;\n\t\t\t\tcurrentBlocked.display.discovered = true;\n\t\t\t}\n\n\t\t\ty++;\n\t\t\tcurrentBlocked = VisionSystem.getTranslatedSquare(map, octant, x, y, sx, sy);\n\t\t}\n\t\treturn lastBlocked;\n\t}\n\n\tstatic slope(x, y, CORNER) {\n\t\tswitch(CORNER) {\n\t\t\tcase CENTER_SQUARE:\n\t\t\t\treturn y/x;\n\t\t\tcase TOP_LEFT:\n\t\t\t\tif(x == 0) {\n\t\t\t\t\treturn 1;\n\t\t\t\t}\n\t\t\t\treturn (y + .5)/(x - .5);\n\t\t\tcase BOTTOM_RIGHT:\n\t\t\t\treturn max(0, (y - .5)/(x + .5));\n\t\t\tcase UPPER_BOUND:\n\t\t\t\treturn (y + PERM)/(x - PERM);\n\t\t\tcase LOWER_BOUND:\n\t\t\t\treturn (y - PERM)/(x + PERM);\n\t\t}\n\t\treturn 1;\n\t}\n\n\tstatic inShadow(x, y, shadows) {\n\t\tlet BR = VisionSystem.slope(x, y, BOTTOM_RIGHT), TL = VisionSystem.slope(x, y, TOP_LEFT);\n\t\tfor(let s of shadows) {\n\t\t\tif( BR >= s[0] && TL <= s[1]) return true;\n\t\t\telse if( BR >= s[0] && BR <= s[1] && TL >= s[1]) { BR = s[1]; }\n\t\t\telse if( BR <= s[0] && TL >= s[0] && TL <= s[1]) { TL = s[0]; }\n\t\t}\n\t\treturn false;\n\t}\n\n\tstatic startSquare(x, slopeStart) {\n\t\tif(slopeStart == 0) return 0;\n\t\treturn ceil(x * slopeStart);\n\t}\n\n\tstatic getTranslatedSquare(map, octant, x, y, sx, sy) {\n\t\tlet uc = VisionSystem.translate(octant, x, y);\n\t\tlet fx = sx + uc[0];\n\t\tlet fy = sy - uc[1];\n\t\tif(Utility.positionInBounds(new PositionComponent(fx, fy), map.length)) {\n\t\t\treturn map[fx][fy];\n\t\t}\n\t\treturn undefined;\n\t}\n\n\tstatic translate(octant, x, y) {\n\t\treturn[x * xxcomp[octant] + y * xycomp[octant], x * yxcomp[octant] + y * yycomp[octant]];\n\t}\n\n\tstatic isOpaque(square) {\n\t\treturn square.display.opaque;\n\t}\n\n\tstatic lineOfSight(engine, p1, p2) {\n\t\tconst LOS_PERM = .5;\n\t\tlet map = engine.getMap();\n\t\tif(p1 == p2) {\n\t\t\treturn true;\n\t\t}\n\t\telse if(p1.y == p2.y) {\n\t\t\tlet start = (p1.x < p2.x) ? p1 : p2;\n\t\t\tlet end = (start == p1) ? p2 : p1;\n\t\t\tlet curSquare = map[start.x][start.y];\n\t\t\tfor(let x = start.x; x <= end.x; x++) {\n\t\t\t\tif(VisionSystem.isOpaque(map[x][start.y])) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\telse if(p1.x == p2.x) {\n\t\t\tlet start = (p1.y < p2.y) ? p1 : p2;\n\t\t\tlet end = (start == p1) ? p2 : p1;\n\t\t\tlet curSquare = map[start.x][start.y];\n\t\t\tfor(let y = start.y; y <= end.y; y++) {\n\t\t\t\tif(VisionSystem.isOpaque(map[start.x][y])) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\tlet start, end, x, y, slope, curSquare, direction;\n\t\t\tlet difX = abs(p1.x - p2.x);\n\t\t\tlet difY = abs(p1.y - p2.y);\n\n\t\t\tif(difX <= difY) {\n\t\t\t\tstart = (p1.x <= p2.x) ? p1 : p2;\n\t\t\t\tend = (start == p1) ? p2 : p1;\n\t\t\t\tslope = abs(end.x - start.x) / abs(end.y - start.y);\n\t\t\t\tdirection = (start.y < end.y) ? 1 : -1;\n\t\t\t\tx = start.x;\n\t\t\t\ty = start.y;\n\n\t\t\t\tlet error = 0;\n\n\t\t\t\twhile(x <= end.x) {\n\t\t\t\t\tif(VisionSystem.isOpaque(map[x][y])) {\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t\tif(y == end.y) {\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\ty += direction;\n\t\t\t\t\terror += slope;\n\t\t\t\t\tif(error > .5) {\n\t\t\t\t\t\tx++;\n\t\t\t\t\t\terror -= 1;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\telse {\n\t\t\t\tstart = (p1.y <= p2.y) ? p1 : p2;\n\t\t\t\tend = (start == p1) ? p2 : p1;\n\t\t\t\tslope = abs(end.y - start.y) / abs(end.x - start.x);\n\t\t\t\tdirection = (start.x < end.x) ? 1 : -1;\n\t\t\t\tx = start.x;\n\t\t\t\ty = start.y;\n\n\t\t\t\tlet error = 0;\n\n\t\t\t\twhile(y <= end.y) {\n\t\t\t\t\tif(VisionSystem.isOpaque(map[x][y])) {\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t\tif(x == end.x) {\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tx += direction;\n\t\t\t\t\terror += slope;\n\t\t\t\t\tif(error > .5) {\n\t\t\t\t\t\ty++;\n\t\t\t\t\t\terror -= 1;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn true;\n\t}\n}\n","function Level(map, rooms, stairUp, stairDown, depth, torches) {\n\tthis.components = [component_map, component_stair, component_depth];\n\tthis.map = new MapComponent(map);\n\tthis.rooms = rooms;\n\tthis.stairUp = new PositionComponent(stairUp.x, stairUp.y);\n\tthis.stairDown = new PositionComponent(stairDown.x, stairDown.y);\n\tthis.depth = new DepthComponent(depth);\n\tthis.torches = torches;\n}\n","class Square {\n\tconstructor (x, y, textures, solid, opaque) {\n\t\tthis.components = [component_position, component_display, component_texture, component_light];\n\t\tthis.position = new PositionComponent(x, y);\n\t\tthis.display = new DisplayComponent(1, 1, opaque);\n\t\tif(solid) {\n\t\t\tthis.components.push(component_collision);\n\t\t\tthis.collision = new CollisionComponent(x, y, 1, 1);\n\t\t}\n\t\tthis.textures = textures;\n\t\tthis.light = new LightComponent();\n\t}\n}\n\nclass BlankSquare extends Square {\n\tconstructor(x, y) {\n\t\tsuper(x, y, [], physical_solid, display_transparent);\n\t}\n}\n\nclass WallSquare extends Square {\n\tconstructor(x, y) {\n\t\tlet textures = [new TextureComponent(texture_wall)];\n\t\tsuper(x, y, textures, physical_solid, display_opaque);\n\t}\n}\n\nclass FloorSquare extends Square {\n\tconstructor(x, y) {\n\t\tlet textures = [new TextureComponent(texture_floor)];\n\t\tsuper(x, y, textures, physical_non_solid, display_transparent);\n\t}\n}\n\nclass DoorSquare extends WallSquare {\n\tconstructor(x, y) {\n\t\tsuper(x, y, [], physical_solid, display_opaque);\n\t\tlet textures = [\n\t\t\tnew TextureComponent(texture_floor),\n\t\t\tnew TextureComponent(texture_door_closed)\n\t\t];\n\t\tthis.textures = textures;\n\t\tthis.opened = false;\n\t}\n\n\topen() {\n\t\tthis.components.splice(this.components.indexOf(component_collision), 1);\n\t\tthis.opened = true;\n\t\t// this.collision = undefined;\n\t\t// this.collision.solid = false;\n\t\tthis.display.opaque = false;\n\t\tthis.textures[1].textureType = texture_door_open;\n\t}\n}\n\nclass LootSquare extends Square {\n\tconstructor(x, y) {\n\t\tlet textures = [\n\t\t\tnew TextureComponent(texture_floor),\n\t\t\tnew TextureComponent(texture_loot_closed)\n\t\t];\n\t\tsuper(x, y, textures, physical_solid, display_transparent);\n\t\tthis.opened = false;\n\t}\n\n\topen() {\n\t\tthis.opened = true;\n\t\tthis.textures[1].textureType = texture_loot_open;\n\t}\n}\n\nclass StairUpSquare extends FloorSquare {\n\tconstructor(x, y) {\n\t\tsuper(x, y, [], physical_solid, display_transparent);\n\t\tlet textures = [\n\t\t\tnew TextureComponent(texture_floor),\n\t\t\tnew TextureComponent(texture_stair_up)\n\t\t];\n\t\tthis.textures = textures;\n\t}\n}\n\nclass StairDownSquare extends FloorSquare {\n\tconstructor(x, y) {\n\t\tsuper(x, y, [], physical_solid, display_transparent);\n\t\tlet textures = [\n\t\t\tnew TextureComponent(texture_floor),\n\t\t\tnew TextureComponent(texture_stair_down)\n\t\t];\n\t\tthis.textures = textures;\n\t}\n}\n","Torch.prototype = Object.create(Entity.prototype);\nfunction Torch(x, y, direction, depth) {\n\tEntity.call(this, x, y, depth, .25, display_opaque, physical_non_solid, null);\n\n\tthis.components.push(component_light_emitter, component_direction);\n\tthis.direction = new DirectionComponent(direction);\n\n\tswitch(direction) {\n\t\tcase direction_up:\n\t\t\tthis.display.offsetX = .5;\n\t\t\tthis.display.offsetY = 1;\n\t\t\tbreak;\n\t\tcase direction_right:\n\t\t\tthis.display.offsetX = 0;\n\t\t\tthis.display.offsetY = .5;\n\t\t\tbreak;\n\t\tcase direction_down:\n\t\t\tthis.display.offsetX = .5;\n\t\t\tthis.display.offsetY = 0;\n\t\t\tbreak;\n\t\tcase direction_left:\n\t\t\tthis.display.offsetX = 1;\n\t\t\tthis.display.offsetY = .5;\n\t\t\tbreak;\n\t}\n\n\tthis.lightEmitter = new LightEmitterComponent(light_level_torch);\n}\n"]}